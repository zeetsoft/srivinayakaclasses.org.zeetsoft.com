"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["65259"],{461093:function(e,t,r){r.d(t,{hw:function(){return u},r9:function(){return o},sh:function(){return a}});var n=r(147227),i=r(657043),o=function(e,t){return t?"100%":e?n.Qi:n.$A},a=function(e){return e?"100%":"95%"},u=function(e){return{message:(0,i.Z)(e,"message"),api_error_code:(0,i.Z)(e,"api_error_code"),error_code:(0,i.Z)(e,"error_code"),code:(0,i.Z)(e,"code"),httpStatus:(0,i.Z)(e,"httpStatus")}}},147227:function(e,t,r){r.d(t,{$A:function(){return a},J7:function(){return n},MB:function(){return l},NJ:function(){return m},PF:function(){return y},Qi:function(){return u},_f:function(){return o},a2:function(){return g},aN:function(){return i},aS:function(){return v},br:function(){return w},f$:function(){return x},jI:function(){return s},n7:function(){return c},qm:function(){return d},rd:function(){return h},ts:function(){return p},vB:function(){return _},vF:function(){return P},x1:function(){return f},yg:function(){return b}});var n="#f0f0eb",i="#c957bd",o="100",a="469px",u="900px",c=600,s={__style:{backgroundColor:"#E9E4FF"}},l="520px",p="180px",f=2,d="@",m=2,v=function(e){return{"Thinking about the question":e._('Thinking about the question', 'concierge.components.chat.thinking.steps.text', 'thinking steps text'),Finish:e._('Finish', 'concierge.components.chat.finish.steps.text', 'finish steps text'),"Generating the response":e._('Generating the response', 'concierge.components.chat.generating.steps.text', 'generating steps text'),"Classifying the question":e._('Classifying the question', 'concierge.components.chat.classifying.steps.text', 'classifying steps text'),"Fetching the data tables":e._('Fetching the data tables', 'concierge.components.chat.fetching.steps.text', 'fetching steps text'),"Generating the query":e._('Generating the query', 'concierge.components.chat.query.steps.text', 'query steps text'),"Picking up the best query":e._('Picking up the best query', 'concierge.components.chat.best.query.steps.text', 'best query steps text'),"Validating the query":e._('Validating the query', 'concierge.components.chat.validating.steps.text', 'validating steps text'),"Correcting the query":e._('Correcting the query', 'concierge.components.chat.correcting.steps.text', 'correcting steps text'),"Using SQL":e._('Using SQL', 'concierge.components.chat.sql.steps.text', 'sql steps text'),"Executing the query":e._('Executing the query', 'concierge.components.chat.executing.steps.text', 'executing steps text'),"The query execution is finished":e._('The query execution is finished', 'concierge.components.chat.query.finished.steps.text', 'query finished steps text'),Error:e._('Error', 'concierge.components.chat.error.steps.text', 'error steps text')}},h=["helix-users","helix-dev"],g="#pinnacle-feedback",y="https://pinterest.enterprise.slack.com/archives/C08K7TVLWJC",_="https://i.pinimg.com/originals/32/78/fb/3278fb42c068009b300151775abf22cd.png",b="https://i.pinimg.com/originals/0e/73/84/0e738478d913ac3c7d699e74918e3d9a.png",w="https://i.pinimg.com/originals/56/36/d3/5636d36bfe20b378b6a946ffc2b8dcee.png",x="https://i.pinimg.com/originals/7a/c0/dd/7ac0ddee9dcf249927b5e6a9d9363418.png",P={CUSTOMIZED_COMPONENT_BASE64_IMAGE:"customized_component_base64_image"}},903760:function(e,t,r){r.d(t,{D:function(){return l},q:function(){return p}});var n=r(586659),i=r(963489),o=r(378888),a=r(382718);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var c=(0,n.createContext)(!1),s=function(){var e,t,r=(0,i.TH)();return(null==(e=r.state)?void 0:e.isAppFactoryOAuth)||(null!=(t=(0,o.mB)(r.search).next)?t:"").startsWith("/app-factory-oauth/")};function l(e){var t,r=e.children,i=s(),o=function(e){if(Array.isArray(e))return e}(t=(0,n.useState)(i))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,u=[],c=!0,s=!1;try{for(o=(r=r.call(e)).next;!(c=(n=o.call(r)).done)&&(u.push(n.value),2!==u.length);c=!0);}catch(e){s=!0,i=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw i}}return u}}(t,2)||function(e,t){if(e){if("string"==typeof e)return u(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=o[0],p=o[1];return(0,n.useEffect)(function(){i&&p(!0)},[i]),(0,a.jsx)(c,{value:l,children:r})}function p(){return(0,n.useContext)(c)}},671003:function(e,t,r){r.d(t,{Z:function(){return Y}});var n=r(963489),i=r(78730),o=r(346955),a=r(20256),u=r(667835),c=r(15667),s=r(647709),l=r(382718),p=function(e){var t;return null!=(t=({"ar-SA":"tall","bn-IN":"tall","hi-IN":"tall","te-IN":"tall","ko-KR":"ck","zh-CN":"ck","zh-TW":"ck",ja:"ja","th-TH":"th","vi-VN":"vi"})[e])?t:"default"};function f(e){var t=e.children,r=(0,u.vs)(),n=(0,s.HG)(),i=p((0,c.B)().locale);return(0,l.jsx)(a.Ag,{colorScheme:r&&!n?"dark":"light",children:(0,l.jsx)(a.Ho,{languageMode:i,children:t})})}function d(e){var t=e.children,r=(0,s.ml)();return(0,l.jsx)(a.Q_,{deviceType:r?"mobile":"desktop",children:t})}var m=r(586659);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function y(e,t,r){var n;return(n=function(e,t){if("object"!=v(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=v(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==v(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=[];function b(e){var t=e.children,r=(0,c.B)();(0,m.useMemo)(function(){return{web_gestalt_calico:{anyEnabled:!0,group:"enabled"}}},[]);var n=_.reduce(function(e,t){return g(g({},e),{},y({},t,r.experimentsClient.checkExperiment(t)))},{});return(0,l.jsx)(a.II,{value:n,children:t})}var w=r(816358),x=r(611282),P=r(104659);function E(e){var t,r,n,i,o=e.children,u=(t=(0,P.G)().setAppFocusState,r=(0,m.useCallback)(function(){w.Z.pause(),t(!1)},[t]),n=(0,m.useCallback)(function(){w.Z.resume(),t(!0)},[t]),i=(0,m.useMemo)(function(){return{onOpen:r,onClose:n}},[r,n]),{linkHandlers:(0,m.useMemo)(function(){return{onNavigation:function(e){var t=e.href,r=e.target;return(0,x.Z)({href:t,target:r})}}},[]),sheetMobileHandlers:i}),c=u.sheetMobileHandlers,s=u.linkHandlers;return(0,l.jsx)(a.uu,{linkHandlers:s,sheetMobileHandlers:c,children:o})}var k=r(390843),T=r(35814),S=r(903760),j=r(675973),I=r(368177),O=r(901360),D=r(650533),A=r(529547),C=r(622481),N=r(282803),R=r(392824),Z=r(735201),L=r(524447),B=r(293169),z=function(){var e;return null!=(e=window.performance)&&e.now?window.performance.now():null},M=function(e){return["/advertiser/"].reduce(function(t,r){return e.includes(r)||t},!1)};function U(e){var t,r=e.children,n=e.immutableLocation,i=e.routerHistoryAction,o=e.staticContext,a=(0,m.useRef)(null),u=(0,m.useRef)(null),c=(0,m.useRef)(n),s=(0,m.useRef)(!0),p=(0,D.$B)(),f=p.path,d=p.params,v=(0,m.useRef)(f),h=(0,m.useRef)(d),g=(0,A.Z)(o.deviceType);if(s.current&&(0,Z.ZP)(!0,null==(t=o.serverData)?void 0:t.trace_id),(0,m.useEffect)(function(){v.current=f},[f]),(0,m.useEffect)(function(){h.current=d},[d]),(0,m.useEffect)(function(){(0,L.UQ)(),s.current=!1},[]),M(n.pathname)?c.current.pathname!==n.pathname:c.current!==n){c.current=n,u.current=z();var y=u.current;if(!s.current){var _=!a.current;(0,O.A9)("routeStart",{tags:{action:i}}),(0,B.Eg)(_),(0,L.Ux)(_),(0,L.on)(),(0,R.tl)(),(0,Z._T)(),(0,Z.ZP)(!1);var b=(0,B.LH)().defaultBufferSize;y&&((0,O.A9)("routeStart.defaultBufferSize",{count:b}),a.current={time:y,action:i})}}return(0,l.jsx)(N.Z,{value:g?o:null,children:(0,l.jsx)(C.Z,{value:a.current,children:r})})}var F=r(939672),q=r(30880),H=r(754545),V=r(956077),W=r(603316);function G(e){var t=e.children,r=e.immutableLocation,n=e.routerHistoryAction,i=(0,m.useRef)(!0),o=(0,m.useRef)(!1),a=(0,m.useRef)(!1),u=(0,m.useRef)(r),c=performance.now(),s=(0,j.Z)().checkExperiment("web_pwt_validate_suspense").group;return s&&(0,W.nP)("pwt_logger_v4_render",{sampleRate:1,tags:{experimentGroup:s}}),o.current=o.current||M(r.pathname)?u.current.pathname!==r.pathname:u.current!==r,o.current&&!a.current&&((0,H.yh)("routeChange"),a.current=!0,(0,F.N0)(),s&&(0,W.nP)("pwt_logger_v4_route_change_reset",{sampleRate:1,tags:{experimentGroup:s}})),(0,m.useLayoutEffect)(function(){if((M(r.pathname)?u.current.pathname!==r.pathname:u.current!==r)||i.current){u.current=r;var e=i.current?0:c;(0,H.ep)(n,e,i.current),(0,V.Nx)("NavigationCompletev4"),i.current=!1,o.current=!1,a.current=!1,s&&(0,W.nP)("pwt_logger_v4_navigation_complete",{sampleRate:1,tags:{experimentGroup:s}})}},[i,n,r,c,o]),t}function Q(e){var t=e.children,r=e.immutableLocation,n=e.routerHistoryAction;return(0,q.Z)()?(0,l.jsx)(F.mW,{children:(0,l.jsx)(G,{immutableLocation:r,routerHistoryAction:n,children:t})}):t}var J=r(791948);function $(e){var t=e.children,r=e.traceLoggerData,i=(0,c.B)(),o=(0,n.ur)(),a=(0,n.TH)(),u=(0,j.Z)().checkExperiment("web_pwt_validate_suspense").group,s=(0,I.Z)({requestContext:i,traceLoggerData:r});return(0,O.iF)(o),"enabled_switch_v4_v3"===u?(0,l.jsx)(Q,{immutableLocation:a,routerHistoryAction:o,children:(0,l.jsx)(U,{immutableLocation:a,routerHistoryAction:o,staticContext:s,children:t})}):(0,l.jsx)(U,{immutableLocation:a,routerHistoryAction:o,staticContext:s,children:(0,l.jsx)(Q,{immutableLocation:a,routerHistoryAction:o,children:t})})}function Y(e){var t=e.children,r=e.context,n=e.otaData,a=e.inContextTranslation,u=e.requestContext,c=e.resourceCreator,s=e.traceLoggerData,p=(0,j.Z)().checkExperiment("web_pwt_validate_suspense").anyEnabled,m=(0,l.jsx)(d,{children:(0,l.jsx)(b,{children:(0,l.jsx)(f,{children:(0,l.jsx)(k.nK,{children:(0,l.jsx)(P.g,{children:(0,l.jsx)(E,{children:(0,l.jsx)(o.Ih,{children:(0,l.jsx)(S.D,{children:(0,l.jsx)(J.UZ,{resourceCreator:c,children:t})})})})})})})})});return(0,l.jsx)(i.E,{value:r,children:p?(0,l.jsx)($,{traceLoggerData:s,children:(0,l.jsx)(T.Z,{enableInContextTranslation:a,locale:u.locale,otaData:n,children:m})}):(0,l.jsx)(T.Z,{enableInContextTranslation:a,locale:u.locale,otaData:n,children:(0,l.jsx)($,{traceLoggerData:s,children:m})})})}},672431:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r){var i;return(i=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(i)?i:i+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{ES:function(){return l},I3:function(){return s},TY:function(){return p},YX:function(){return u},aD:function(){return c}});var o,a,u=1e4,c=300,s=[9,3],l=(i(o={},13,"VIEW"),i(o,4703,"TIMED_PAIR_END"),i(o,82,"PIN_SAVE_TO_DEVICE"),i(o,8948,"PIN_CLICK"),o),p=(i(a={},9,"LOGIN"),i(a,3,"PIN"),i(a,186,"OFF_PINTEREST"),i(a,11,"BROWSER"),a)},83896:function(e,t,r){r.d(t,{li:function(){return G},Ch:function(){return U},nc:function(){return J},a:function(){return $},ZP:function(){return Y},cA:function(){return W}});var n,i,o,a=r(672410),u=r(898582),c=r(575108),s=r(461093),l=r(296086),p=r(672431);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var v="exponential";function h(e,t){var r=Math.max(e,0),n=Math.max(t,r);return Math.floor(r+Math.random()*(n-r+1))}var g=function(){var e;function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(this instanceof t))throw TypeError("Cannot call a class as a function");d(this,"strategy",v),d(this,"attempts",0),this.strategy=null!=(e=r.strategy)?e:v}return e=[{key:"changeStrategy",value:function(e){this.strategy=e,this.attempts=0}},{key:"next",value:function(){var e=function(e,t){if(e===v){var r=1e4*Math.pow(2,t);return h(Math.min(r,9e5),Math.min(Math.floor(1.5*r),9e5))}var n=Math.max(6e5-6e4*t,0);return Math.max(Math.min(h(n,n*(1+.5*Math.pow(.6,t))),9e5),6e4)}(this.strategy,this.attempts);return this.attempts+=1,e}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),y=["element","eventData","component","objectId","view","viewParameter","viewData","durationNs","pairId","clientTrackingParams"],_=r(973160),b=r(346955),w=r(810288),x=r(991384),P=r(2420),E=r(734215),k=r(664450),T=r(603316),S=["object_id_str"],j=["cache_created_time","isImpression"];function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function D(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,i)}function A(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){D(o,n,i,a,u,"next",e)}function u(e){D(o,n,i,a,u,"throw",e)}a(void 0)})}}function C(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return R(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach(function(t){B(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function B(e,t,r){var n;return(n=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==I(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var z=new Set([6945,170,3700]),M=new Set([3700]),U=(B(n={},3829,"articleImpressions"),B(n,18,"pinImpressions"),B(n,3700,"boardImpressions"),B(n,3803,"searchImpressions"),B(n,170,"storyImpression"),B(n,3704,"userImpressions"),n),F=[4700,4701,4702,4703,7042,7043],q=function(e){return(0,w.Z)(JSON.stringify(e))},H=function(e){return z.has(e)};function V(){var e=new Date;i?i&&i.getUTCDate()!==e.getUTCDate()&&(i=e,(0,l.Z)()):i=e}var W=function(e){var t=e.event_type,r=F.includes(t),n=(0,b.BE)();return!!r||13===t||!!n},G=function(e,t){var r=e.event_type,n=F.includes(r),i=(0,b.BE)();return n?e:13===r&&e.view_type?(null==t||t({viewType:e.view_type,viewParameter:e.view_parameter,viewData:null!=i&&i.viewData?(0,x.Z)(i.viewData,e.view_data):e.view_data}),e):!i||e.view_type&&e.view_parameter?e:L(L({},e),{},{view_type:i.viewType||e.view_type,view_parameter:i.viewParameter,view_data:e.view_data?(0,x.Z)(e.view_data,i.viewData):i.viewData})},Q=function(e){var t={};return null!=e&&e.storyPinProductEventData&&(t=L(L({},t),{},{storyPinProductEventData:e.storyPinProductEventData})),t},J=function(e,t){var r,n,i=e.component,o=e.element,a=e.object_id_str,u=e.view_type,c=e.event_type,s=e.appState;return null!=(r=((null==(n=e.event_data)?void 0:n[t])||[]).map(function(r){return L(L(L(L(L(L({auxData:e.aux_data},i?{component:i}:{}),{},{eventData:r},c?{eventType:c}:{}),u?{viewType:u}:{}),{},{viewData:e.view_data,viewParameter:e.view_parameter},a?{objectIdStr:a}:null),{},{impressionType:t},Q(e.event_data)),{},{appState:s},o?{element:o}:{})}))?r:[]},$=function(e,t){return L(L(L(L({},e.component?{component:e.component}:{}),e.object_id_str?{objectIdStr:e.object_id_str}:null),e.view_type?{viewType:e.view_type}:{}),{},{eventType:e.event_type,auxData:e.aux_data,impressionType:t,viewData:e.view_data,viewParameter:e.view_parameter,eventData:e.event_data})};function Y(e){var t=[],r=[],n=0,i=!1,l=!1;function f(){return[].concat(C(t),C(r.reduce(function(e,t){var r=e.find(function(e){return e.view_type===t.viewType&&e.view_parameter===t.viewParameter&&e.event_type===t.eventType&&e.object_id_str===t.objectIdStr&&(0,E.Z)(e.view_data,t.viewData)});if(r&&!H(t.eventType))t.impressionType in r.event_data?r.event_data[t.impressionType].push(t.eventData):r.event_data[t.impressionType]=[t.eventData];else{var n,i=t.storyPinProductEventData?{storyPinProductEventData:t.storyPinProductEventData}:{},o={appState:t.appState,aux_data:t.auxData||{},clientUUID:(0,a.Z)(),component:t.component,event_data:L(L({},i),{},B({},t.impressionType,!H(n=t.eventType)||H(n)&&M.has(n)?[t.eventData]:L(L({},t.eventData),(t.eventData||{})[t.impressionType]))),event_type:t.eventType,object_id_str:t.objectIdStr||void 0,time:(0,_.ZP)(),view_data:t.viewData,view_parameter:t.viewParameter,view_type:t.viewType,element:t.element};e.push(o)}return e},[])))}function d(e){var t,r,n=e.error,i=e.isError,o=e.isDroppedEvent,a=e.isImpression,c=e.isEventSkipped,s=(0,u.Z)(),l=(null==s?void 0:s.userAgent)||{},p=!(l.isMobile||l.isTablet),f={error_message:null!=(t=null==n?void 0:n.message)?t:"unknown",appType:p?"WEB_DENZEL":"WEB_MOBILE",country:null!=(r=null==s?void 0:s.country)?r:"unknown",browserName:l.browserName,osName:l.osName,browserType:l.browserType,browserVersion:l.browserVersion,isError:i,isImpression:a,isEventSkipped:c};(0,T.nP)("".concat("webapp.metrics.contextLog.indexdb.").concat(o?"dropped":i?"errors":c?"skipped":"success"),{tags:f})}function m(){return h.apply(this,arguments)}function h(){return(h=A(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null==(t=o)?void 0:t.clear();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),d({isError:!0,error:{message:"Error while clearing cache",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(r=e.t0.stack)?r:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 8:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}function b(){t=[],r=[],n=0}function w(){return(w=A(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=L(L({},t),{},{cache_created_time:(0,_.ZP)(),isImpression:!1,aux_data:L(L({},t.aux_data),{},{is_context_cached:!0})}),e.next=4,null==(r=o)?void 0:r.setItem((0,a.Z)(),n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),d({isError:!0,error:{message:"Transaction could not be added",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(i=e.t0.stack)?i:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 9:case"end":return e.stop()}},e,null,[[0,6]])}))).apply(this,arguments)}function x(){return(x=A(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=L(L({},t),{},{cache_created_time:(0,_.ZP)(),isImpression:!0,auxData:L(L({},t.auxData),{},{is_impression_cached:!0})}),e.next=4,null==(r=o)?void 0:r.setItem((0,a.Z)(),n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),d({isError:!0,isImpression:!0,error:{message:"Transaction could not be added",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(i=e.t0.stack)?i:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 9:case"end":return e.stop()}},e,null,[[0,6]])}))).apply(this,arguments)}function I(){return D.apply(this,arguments)}function D(){return(D=A(regeneratorRuntime.mark(function t(){var r,n,o,a,d,h,y;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=f(),n=0,o=1e3,a=new g,r.length){t.next=6;break}return t.abrupt("return");case 6:d=(0,_.ZP)(),h=c.Z.create("ApiCResource",{events:r,report_time:d}),(y=function(){var e=A(regeneratorRuntime.mark(function e(){var t,c,p,f,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d=(0,_.ZP)(),e.next=4,h.callCreate({async:!0,showError:!1});case 4:m(),e.next=24;break;case 7:if(e.prev=7,e.t0=e.catch(0),c=!(null!=(t=(0,s.hw)(e.t0))&&t.api_error_code)||[P.dO,P.cZ,P.i1].includes(t.api_error_code),p=(null==t?void 0:t.api_error_code)===P.QY||(null==t?void 0:t.httpStatus)===400,!function(e){var t,r=e.retryAttempts,n=e.error,i=e.events,o=(0,u.Z)(),a=(null==o?void 0:o.userAgent)||{},c=!(a.isMobile||a.isTablet),s=L(L({},n),{},{retryAttempts:r,appType:c?"WEB_DENZEL":"WEB_MOBILE",country:null!=(t=null==o?void 0:o.country)?t:"unknown",browserName:a.browserName,eventSize:i.length,osName:a.osName,browserType:a.browserType,browserVersion:a.browserVersion});(0,T.nP)("metrics_quality_web_retry_error_log",{tags:s})}({retryAttempts:n,error:t,events:r}),!i){e.next=23;break}if(!p){e.next=17;break}return m(),e.abrupt("return");case 17:c||null!=t&&t.httpStatus&&t.httpStatus>=500?a.changeStrategy("coolDown"):a.changeStrategy(v),f=a.next(),n+=1,setTimeout(y,f),e.next=24;break;case 23:c&&n<5?(g=o,n+=1,o*=2,setTimeout(y,g)):l||m();case 24:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}())(),function(t,r){if(e){var n,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=N(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}(t);try{for(i.s();!(n=i.n()).done;){var o,a,u,c=n.value;(0,_.Q9)(c)&&(0,T.LY)("webapp.contextLogger.fastFlushEvents.latency",(r-c.time||0)/1e6,{sampleRate:1,tags:{event_type:p.ES[c.event_type],view_type:c.view_type?p.TY[c.view_type]:"unknown",cached:null!=(o=(null==(a=c.aux_data)?void 0:a.is_timed_pair_cached)||(null==(u=c.aux_data)?void 0:u.is_context_cached))?o:"false"}})}}catch(e){i.e(e)}finally{i.f()}}}(r,d),b(),V();case 13:case"end":return t.stop()}},t)}))).apply(this,arguments)}function R(){return(R=A(regeneratorRuntime.mark(function e(){var n,i,a,u,c,s,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(e){return(0,_.ZP)()-e<15e9},a=function(e){return(0,_.ZP)()-e<6e10},i=function(e){return(0,_.ZP)()-e>6048e11},n=function(e){return(0,_.ZP)()-e>864e11},c=l?u:a,s=l?i:n,e.prev=6,e.next=9,null==(p=o)?void 0:p.getAllItem();case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0=[];case 12:e.t0.forEach(function(e){var n=e.value,i=n.cache_created_time,o=n.isImpression,a=O(n,j);s(i)?d({isDroppedEvent:!0,isError:!1}):c(i)?d({isEventSkipped:!0}):o?(r.push(a),d({isImpression:!0,isError:!1})):(t.push(a),d({isError:!1}))}),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(6),d({isError:!0,error:{message:"Error while syncing cached events",details:e.t1 instanceof Error?e.t1.message:"Unknown error",stack_trace:e.t1 instanceof Error&&null!=(f=e.t1.stack)?f:"No stack trace available",errorName:e.t1 instanceof Error?e.t1.name:"N/A"}});case 19:return e.prev=19,l||(I(),m()),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[6,16,19,22]])}))).apply(this,arguments)}return{flushContextEvents:I,getContextEvents:f,logContextEvent:function(e){var r,i=e.object_id_str,o=O(e,S),u=(0,_.ZP)(),c=L(L({aux_data:{},event_data:{},view_data:{}},o),{},{time:u,clientUUID:(0,a.Z)()},i?{object_id_str:i}:null),s=(r=c.aux_data)?(r.element,r.eventData,r.component,r.objectId,r.view,r.viewParameter,r.viewData,r.durationNs,r.pairId,r.clientTrackingParams,function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(r,y)):r;c=L(L({},c),{},{aux_data:s}),n+q(c)>20480&&I(),t.push(c),n+=q(c),V(),function(e){w.apply(this,arguments)}(c)},logImpression:function(e){n+q(e)>20480&&I(),r.push(e),n+=q(e),function(e){x.apply(this,arguments)}(e)},resetEventsBuffer:b,syncCachedEndEvents:function(){return R.apply(this,arguments)},_getIndexDBInstance:function(){return o},_setDecreaseSkipCachedEventsExperimentState:function(e){l=e},initiateIndexDBCache:function(){var e;null!=(e=window)&&e.indexedDB&&(o=o||new k.Z(window.indexedDB,"ContextLoggingDB","ContextLoggingTable"))},_setRetryV2ExperimentState:function(e){i=e}}}},973160:function(e,t,r){r.d(t,{Q9:function(){return o},sR:function(){return i}});var n=r(672431),i=function(){var e,t;return"undefined"!==document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}},o=function(e){switch(e.event_type){case 13:return!!e.view_type&&n.I3.includes(e.view_type);case 4703:if(3===e.view_type&&85===e.component&&(e.duration_ns||0)>=1e10||186===e.view_type||11===e.view_type)return!0;return!1;case 82:case 8948:return!0;default:return!1}};t.ZP=function(){return 1e6*Date.now()}},622481:function(e,t,r){t.Z=(0,r(586659).createContext)(null)},282803:function(e,t,r){t.Z=(0,r(586659).createContext)(null)},664450:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,i)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function u(e){i(a,n,o,u,c,"next",e)}function c(e){i(a,n,o,u,c,"throw",e)}u(void 0)})}}function a(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{Z:function(){return u}});var u=function(){var e,t,r,n,i,u,c,s,l;function p(e){var t,r,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"myDatabase",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"myStore";if(!(this instanceof p))throw TypeError("Cannot call a class as a function");t="cache",r=new Map,(t=a(t))in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.dbName=i,this.storeName=u,this.dbPromise=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.initializeDB(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}},t,null,[[0,6]])}))()}return l=[{key:"initializeDB",value:(e=o(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){try{var i=t.open(r.dbName,1);i.onerror=function(){n(Error("IndexedDB initialization error: "+i.error))},i.onupgradeneeded=function(){var e=i.result;e.objectStoreNames.contains(r.storeName)||e.createObjectStore(r.storeName,{keyPath:"key"})},i.onsuccess=function(){e(i.result)}}catch(e){n(Error("IndexedDB initialization error: "+e))}}));case 1:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})},{key:"reopenDatabaseIfClosed",value:(t=o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbPromise;case 2:if(!((t=e.sent)&&!t.close)){e.next=5;break}return e.abrupt("return",t);case 5:return this.dbPromise=this.initializeDB(window.indexedDB),e.abrupt("return",this.dbPromise);case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getObjectStore",value:(r=o(regeneratorRuntime.mark(function e(){var t,r,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"readwrite",e.next=3,this.reopenDatabaseIfClosed();case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",r.transaction(this.storeName,t).objectStore(this.storeName));case 7:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getItem",value:(n=o(regeneratorRuntime.mark(function e(t){var r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cache.has(t)){e.next=2;break}return e.abrupt("return",null!=(r=this.cache.get(t))?r:null);case 2:return e.next=4,this.getObjectStore();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",new Promise(function(e,r){var o=n.get(t);o.onerror=function(){return r(o.error)},o.onsuccess=function(){var r,n=(null==(r=o.result)?void 0:r.value)||null;null!==n&&i.cache.set(t,n),e(n)}}));case 8:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getAllItem",value:(i=o(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",new Promise(function(e,n){var i=t.getAll();i.onerror=function(){return n(i.error)},i.onsuccess=function(){var t;null==(t=i.result)||t.forEach(function(e){r.cache.set(e.key,e.value)}),e(i.result)}}));case 6:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"setItem",value:(u=o(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.set(t,r),e.next=3,this.getObjectStore();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",new Promise(function(e,i){var o=n.put({key:t,value:r});o.onerror=function(){i(o.error)},o.onsuccess=function(){e(null)}}));case 7:case"end":return e.stop()}},e,this)})),function(e,t){return u.apply(this,arguments)})},{key:"removeItem",value:(c=o(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.delete(t),e.next=3,this.getObjectStore();case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",new Promise(function(e,n){var i=r.delete(t);i.onerror=function(){return n(i.error)},i.onsuccess=function(){return e(null)}}));case 7:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"clear",value:(s=o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.clear(),e.next=3,this.getObjectStore();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",new Promise(function(e,r){var n=t.clear();n.onerror=function(){return r(n.error)},n.onsuccess=function(){return e(null)}}));case 7:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}(p.prototype,l),Object.defineProperty(p,"prototype",{writable:!1}),p}()},121793:function(e,t,r){r.d(t,{w:function(){return x}});var n,i=r(898582),o=r(973160),a=r(664450),u=r(732888),c=r(510928),s=r(603316);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,i)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){p(o,n,i,a,u,"next",e)}function u(e){p(o,n,i,a,u,"throw",e)}a(void 0)})}}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function v(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=l(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}var g=null,y="ACTIVE",_="PAUSED",b=function(){return window&&window.performance&&window.performance.now?"(Time: ".concat((window.performance.now()/1e3).toFixed(3),"s)"):""},w=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}};function x(e){var t,r=e.contextLogger;if(n||(n=null!=(t=window)&&t.indexedDB?new a.Z(window.indexedDB,"EventLoggingDB","TimeSpent"):null),g)return g;var l=new Map,p=(0,c.Z)()&&(0,c.Z)().debug_timespent,d=[],x=p?console:{error:function(){},log:function(){},group:function(){},groupEnd:function(){}};return console.group||(x.group=function(){var e;return(e=console).log.apply(e,arguments)},x.groupEnd=function(){}),g=new(function(){var e;function t(){var e,a,c,h,g=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");v(this,"appTimedPair",null),v(this,"clickthroughProperties",null),v(this,"historyStackContext",null),v(this,"offsiteTimedPair",null),v(this,"offsiteTimedPairForegroundId",null),v(this,"pins",Object.freeze({})),v(this,"addEventListeners",function(){var e=(0,o.sR)(),t=e.hidden,r=e.visibilityChange;r&&document.addEventListener(r,function(e){document[t]?g.unregisterApp(void 0,e):g.registerApp()},!1),window.addEventListener("focus",g.registerApp),window.addEventListener("blur",function(e){return g.unregisterApp(void 0,e)});var n=w(function(e){return g.unregisterApp(void 0,e)});window.addEventListener("beforeunload",n),window.addEventListener("pagehide",n);var i=navigator&&navigator.userAgent.toLowerCase();i&&i.includes("macintosh")&&i.includes("chrome")&&window.addEventListener("popstate",function(){document.hasFocus()||document[t]||(0,s.nP)("chrome_mac_back_forward_button",{sampleRate:1})})}),v(this,"storeClickthroughProperties",function(e){g.clickthroughProperties&&(0,s.nP)("webapp.metrics.clickthroughs.overwritten",{sampleRate:1,tags:{previousView:g.clickthroughProperties.view_type,previousViewParameter:g.clickthroughProperties.view_parameter,nextView:e.view_type,nextViewParameter:e.view_parameter}}),g.clickthroughProperties=m({time:(0,o.ZP)()},e)}),v(this,"clearClickthroughProperties",function(){g.clickthroughProperties=null,g.offsiteTimedPair=null,g.offsiteTimedPairForegroundId=null}),v(this,"registerApp",function(){x.group("App Foreground",b()),null==g.appTimedPair?(g.appTimedPair=new u.Z,g.appTimedPair.start(),g._unpauseAllComponents(),g._endOffsiteTimedPair(),null!==g.appTimedPair&&void 0!==g.appTimedPair&&r.logContextEvent({event_type:4700,pair_id:g.appTimedPair.uuid})):x.error("TimedPair already exists for app."),x.groupEnd()}),v(this,"logIndexDbStatLog",function(e){var t,r,n,o,a,u=e.error,c=e.isError,l=e.isDroppedEvent,p=(0,i.Z)(),f=(null==p?void 0:p.userAgent)||{},d=!(f.isMobile||f.isTablet),m={error_message:null!=(t=null==u?void 0:u.message)?t:"unknown",appType:d?"WEB_DENZEL":"WEB_MOBILE",country:null!=(r=null==p?void 0:p.country)?r:"unknown",browserName:f.browserName,osName:f.osName,browserType:f.browserType,browserVersion:f.browserVersion,isError:c,errorName:null!=(n=null==u?void 0:u.errorName)?n:"unknown",errorDetails:null!=(o=null==u?void 0:u.details)?o:"unknown",errorStackTrace:null!=(a=null==u?void 0:u.stack_trace)?a:"unknown"};(0,s.nP)("".concat("webapp.metrics.timespent.indexdb.").concat(l?"dropped":c?"errors":"success"),{tags:m})}),v(this,"unregisterApp",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;x.group("App Background",b());var n=g.appTimedPair;if(null!=n){g._pauseAllComponents();var i=n.end();g._startOffsiteTimedPair(),r.logContextEvent({event_type:4701,duration_ns:i,pair_id:n.uuid}),g.appTimedPair=null}else x.error("No TimedPair found for app.");var o=["beforeunload","pagehide"],a=o.includes((null==t?void 0:t.type)||""),u=o.includes((null==t?void 0:t.pauseReason)||"");(a||u)&&g._endOffsiteTimedPair(),e||r.flushContextEvents(),x.groupEnd()}),v(this,"_activateComponent",function(e){x.group("Activating component",b()),p&&x.log(e.getContext());var t=e.getTimedPair();if(t){t.start();var n=e.getLoggerContext(),i=n.view,o=n.viewParameter,a=n.component,u=n.element,c=n.objectId,s=n.clientTrackingParams;r.logContextEvent({event_type:4702,view_type:i,view_parameter:o,component:a,element:u,object_id_str:c,view_data:e.props.viewData,pair_id:t.uuid,clientTrackingParams:s,aux_data:m({time_spent_foreground_pairid:g.appTimedPair&&g.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId()},e.props.auxData)})}x.groupEnd()}),v(this,"_deactivateComponent",function(e){x.group("Deactivating component",b()),p&&x.log(e.getContext());var t=e.getTimedPair();if(t){var n=t.view,i=t.viewParameter,o=t.component,a=t.element,u=t.objectId,c=t.clientTrackingParams,s=t.end();r.logContextEvent({event_type:4703,view_type:n,view_parameter:i,component:o,element:a,object_id_str:u,view_data:e.props.viewData,duration_ns:s,pair_id:t.uuid,clientTrackingParams:c,aux_data:m({time_spent_foreground_pairid:g.appTimedPair&&g.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId()},e.props.auxData)})}x.groupEnd()}),v(this,"_startOffsiteTimedPair",function(){var e,t,n=g.clickthroughProperties;n&&(g.offsiteTimedPair=new u.Z({view:186,viewParameter:n.view_parameter,objectId:n.object_id_str}),g.offsiteTimedPair.start(),g.offsiteTimedPairForegroundId=g.appTimedPair?g.appTimedPair.uuid:null,n=m(m({},n),{},{aux_data:m(m({},n.aux_data),{},{time_to_offsite:void 0!==n.time&&null!==n.time&&"number"==typeof n.time?(0,o.ZP)()-n.time:void 0})}),r.logContextEvent(m(m({},n),{},{event_type:4702,view_type:186,pair_id:g.offsiteTimedPair?g.offsiteTimedPair.uuid:null,aux_data:m(m({},n.aux_data),{},{time_spent_foreground_pairid:g.offsiteTimedPairForegroundId})})),g._addOffSitePairToIndexDB({offsiteTimedPairUUID:null==(e=g.offsiteTimedPair)?void 0:e.uuid,clickthroughProperties:n,timeCreated:null==(t=g.offsiteTimedPair)?void 0:t.startTime,offsiteTimedPairForegroundId:g.offsiteTimedPairForegroundId}))}),v(this,"_endOffsiteTimedPair",function(){var e=g.offsiteTimedPair,t=g.clickthroughProperties;if(e&&t){var n,i=e.end();r.logContextEvent(m(m({},t),{},{event_type:4703,view_type:186,pair_id:g.offsiteTimedPair?g.offsiteTimedPair.uuid:null,aux_data:m(m({},t.aux_data),{},{time_spent_foreground_pairid:g.offsiteTimedPairForegroundId}),duration_ns:i})),g._removeOffSitePairByIdFromIndexDB(null==(n=g.offsiteTimedPair)?void 0:n.uuid),g._syncCachedTimedPairEndEvents(),g._onOffsiteEnd(),g.clearClickthroughProperties()}else g._syncCachedTimedPairEndEvents()}),v(this,"_addOffSitePairToIndexDB",(e=f(regeneratorRuntime.mark(function e(t){var r,i,o,a,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.offsiteTimedPairUUID,i=t.clickthroughProperties,o=t.timeCreated,a=t.offsiteTimedPairForegroundId,e.prev=1,e.next=4,null==(u=n)?void 0:u.setItem(r,{clickthroughProperties:m({},i),timeCreated:o,offsiteTimedPairForegroundId:a});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),g.logIndexDbStatLog({isError:!0,error:{message:"Transaction could not be added",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(c=e.t0.stack)?c:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 9:case"end":return e.stop()}},e,null,[[1,6]])})),function(t){return e.apply(this,arguments)})),v(this,"_addAppTimerToIndexDB",(a=f(regeneratorRuntime.mark(function e(t){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.foregroundAppTimerUUID,i=t.timeCreated,e.prev=1,e.next=4,null==(o=n)?void 0:o.setItem(r,{timeCreated:i});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),g.logIndexDbStatLog({isError:!0,error:{message:"Transaction could not be added",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(a=e.t0.stack)?a:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 9:case"end":return e.stop()}},e,null,[[1,6]])})),function(e){return a.apply(this,arguments)})),v(this,"_removeAppTimerFromIndexDB",(c=f(regeneratorRuntime.mark(function e(t){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.foregroundAppTimerUUID,e.prev=1,r){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,null==(i=n)?void 0:i.removeItem(r);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),g.logIndexDbStatLog({isError:!0,error:{message:"Transaction could not be removed",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(o=e.t0.stack)?o:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 11:case"end":return e.stop()}},e,null,[[1,8]])})),function(e){return c.apply(this,arguments)})),v(this,"_removeOffSitePairByIdFromIndexDB",(h=f(regeneratorRuntime.mark(function e(t){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,null==(r=n)?void 0:r.removeItem(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g.logIndexDbStatLog({isError:!0,error:{message:"Transaction could not be removed",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(i=e.t0.stack)?i:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(e){return h.apply(this,arguments)})),v(this,"_syncCachedTimedPairEndEvents",f(regeneratorRuntime.mark(function e(){var t,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(e){return(0,u.h)()-e>864e11},e.prev=1,e.next=4,null==(i=n)?void 0:i.getAllItem();case 4:return(e.sent||[]).forEach(function(){var e=f(regeneratorRuntime.mark(function e(n){var i,o,a,c,s,l,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=n.key,a=(o=n.value).clickthroughProperties,c=o.timeCreated,s=o.offsiteTimedPairForegroundId,l=(0,u.h)(),p=c?l-c:null,c&&t(c)?g.logIndexDbStatLog({isDroppedEvent:!0,isError:!1}):(r.logContextEvent(m(m({},a),{},{event_type:4703,view_type:186,pair_id:i||null,aux_data:m(m({},null==a?void 0:a.aux_data),{},{time_spent_foreground_pairid:s,is_timed_pair_cached:!0}),duration_ns:p})),g.logIndexDbStatLog({isError:!1}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=8,null==(o=n)?void 0:o.clear();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),g.logIndexDbStatLog({isError:!0,error:{message:"Error while syncing cached events",details:e.t0 instanceof Error?e.t0.message:"Unknown error",stack_trace:e.t0 instanceof Error&&null!=(a=e.t0.stack)?a:"No stack trace available",errorName:e.t0 instanceof Error?e.t0.name:"N/A"}});case 13:case"end":return e.stop()}},e,null,[[1,10]])}))),v(this,"_onOffsiteEnd",function(){x.group("Trigger onOffsiteEndCallbacks"),d.forEach(function(e){return e({appTimedPair:g.appTimedPair,clickthroughProperties:g.clickthroughProperties,offsiteTimedPair:g.offsiteTimedPair,offsiteTimedPairForegroundId:g.offsiteTimedPairForegroundId})}),x.groupEnd()}),v(this,"_pauseAllComponents",function(){x.group("Pause all components"),l.forEach(function(e,t,r){e===y&&g._deactivateComponent(t),r.set(t,_)}),x.groupEnd()}),v(this,"_unpauseAllComponents",function(){x.group("Unpause all components"),l.forEach(function(e,t){var r=new u.Z(t.getLoggerContext());t.setTimedPair(r,function(){l.set(t,y),g._activateComponent(t)})}),x.groupEnd()})}return e=[{key:"setHistoryStackContext",value:function(e){this.historyStackContext=e}},{key:"setPins",value:function(e){this.pins=e}},{key:"startOffsiteRightClickTimedPair",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._startOffsiteTimedPair(),e||r.flushContextEvents()}},{key:"registerComponent",value:function(e){null===this.appTimedPair?l.set(e,_):(l.set(e,y),this._activateComponent(e))}},{key:"unregisterComponent",value:function(e){l.get(e)===y&&(this._deactivateComponent(e),e.setTimedPair(new u.Z(e.getLoggerContext()))),l.delete(e)}},{key:"size",value:function(){return l.size}},{key:"onOffsiteEnd",value:function(e){d.push(e)}},{key:"removeOnOffsiteEnd",value:function(e){var t=d.indexOf(e);t>-1&&d.splice(t,1)}},{key:"_getIndexDBInstance",value:function(){return n}},{key:"_getContextLogger",value:function(){return r}},{key:"_clearTimeSpentManager",value:function(){g=null}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}())}}}]);
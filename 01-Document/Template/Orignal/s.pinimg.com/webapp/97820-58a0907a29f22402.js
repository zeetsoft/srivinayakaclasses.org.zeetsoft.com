"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["97820"],{853894:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ActivityAvatar_user",selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null}],type:"User",abstractKey:null};r.hash="abf151ba4d389a02e4541aa5f969d468",t.default=r},297209:function(e,t,n){n.r(t);var r,o,i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AggregatedCommentListUnified_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:o=[r={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"highlightedAggregatedComments",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null}],type:"Pin",abstractKey:null};i.hash="ba6cb3d83648d5a9f07e044db4a9cf58",t.default=i},197141:function(e,t,n){var r;void 0===r&&(r=n.g),t.Z={setTimeout:function(e,t){return r.setTimeout(e,t)},clearTimeout:function(e){return r.clearTimeout(e)},setInterval:function(e,t){return r.setInterval(e,t)},clearInterval:function(e){return r.clearInterval(e)}}},840611:function(e,t,n){n.d(t,{Z:function(){return u}}),n(492996);var r,o=n(20256),i=n(744862),l=n(821342),a=n(28427),s=n(382718),c=(void 0!==r||(r=n(853894)).hash&&"abf151ba4d389a02e4541aa5f969d468"!==r.hash&&console.error("The definition of 'ActivityAvatar_user' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function u(e){var t,n=e.userKey,r=e.size,u=e.hasOutline,d=(0,a.Z)(c,n),f=(0,l.Z)(),p=f.isAuth?null==f?void 0:f.avatar_color_index:void 0;if(!d)return null;var h=d.firstName,m=d.imageMediumUrl,y=null!=(t=d.username)?t:"";return(0,s.jsx)(o.Tg,{href:"/".concat(y,"/"),rounding:"circle",children:(0,s.jsx)(i.qE,{color:p,name:h||y||"",outline:u,size:void 0===r?"md":r,src:null!=m?m:""})})}},442672:function(e,t,n){var r=n(586659),o=n(20256),i=n(937392),l=n(19585),a=n(32937),s=n(790427),c=n(382718);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.Z=function(e){var t,n=e.handleBlockUser,d=void 0===n?null:n,f=e.handleClickReport,p=void 0===f?null:f,h=e.handleDelete,m=void 0===h?null:h,y=e.handleOnEdit,g=void 0===y?null:y,_=e.handleRemoveMention,b=void 0===_?null:_,v=e.handleHighlight,x=e.handleRemoveHighlight,j=e.showHighlightEducator,P=e.iconColor,w=e.small,O=(0,l.ZP)(),C=function(e){if(Array.isArray(e))return e}(t=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return u(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),S=C[0],A=C[1],I=(0,r.useRef)(null),T=function(e){var t=null==e?void 0:e.event;null!=t&&t.preventDefault&&(t.preventDefault(),t.stopPropagation()),A(!S)};if(!(d||p||m||g||b||v))return null;var k={highlight:O._('Highlight', 'Highlight a community post or comment', 'Highlight a community post or comment'),remove:O._('Remove highlight', 'Remove highlight for a community post or comment', 'Remove highlight for a community post or comment'),edit:O._('Edit', 'Edit a community post or comment', 'Edit a community post or comment'),delete:O._('Delete', 'Delete a community post or comment', 'Delete a community post or comment'),report:O._('Report this content', 'Report a community post or comment', 'Report a community post or comment'),removeMention:O._('Remove @mention', 'closeup.activityItem.removeMention', 'Button that allows user to remove their @mention in a comment on a pin'),blockUser:O._('Block user', 'closeup.activityItem.blockUser', 'Block comment author')};return(0,c.jsxs)(o.kC,{alignItems:"end",direction:"column",justifyContent:"start",children:[(0,c.jsx)(o.xu,{"data-test-id":"flyout-toggle",children:(0,c.jsx)(o.hU,{ref:I,accessibilityExpanded:S,accessibilityHaspopup:!0,accessibilityLabel:O._('more options', 'accessible label for button to see more options on report content', 'accessible label for button to see more options on report content'),icon:"ellipsis",iconColor:P||"gray",onClick:T,size:w?"sm":"md"})}),j&&(0,c.jsx)(o.mh,{zIndex:s.lI,children:(0,c.jsx)(a.Z,{children:(0,c.jsx)(i.Qp,{anchor:I.current,experienceIds:[503461],idealDirection:"down",placementId:12,positionRelativeToAnchor:!1,showCaret:!0,textAlign:"center"})})}),S&&(0,c.jsxs)(o.Lt,{anchor:I.current,disableMobileUI:!0,id:"dropdown-flyout",idealDirection:"down",onDismiss:T,children:[v&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-highlight",onSelect:function(){v(),T()},option:{label:k.highlight,value:k.highlight}}),x&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-removeHighlight",onSelect:function(){x(),T()},option:{label:k.remove,value:k.remove}}),g&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-edit",onSelect:function(){return g()},option:{label:k.edit,value:k.edit}}),m&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-delete",onSelect:function(){return m()},option:{label:k.delete,value:k.delete}}),p&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-report",onSelect:function(){return p()},option:{label:k.report,value:k.report}}),b&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-removeMention",onSelect:function(){b(),T()},option:{label:k.removeMention,value:k.removeMention}}),d&&(0,c.jsx)(o.Lt.Item,{dataTestId:"dropdown-item-blockUser",onSelect:function(){return d()},option:{label:k.blockUser,value:k.blockUser}})]})]})}},128677:function(e,t,n){var r=n(586659),o=n(20256),i=n(93035),l=n(234295),a=n(162321),s=n(19585),c=n(382718);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var b=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");d.prototype=Object.create(e&&e.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),Object.defineProperty(d,"prototype",{writable:!1}),e&&p(d,e);var t,n,s=(t=m(),function(){var e,n=y(d);return e=t?Reflect.construct(n,arguments,y(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function d(){var e;if(!(this instanceof d))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return g(h(e=s.call.apply(s,[this].concat(n))),"state",{truncate:!!e.props.text&&e.props.text.length>(e.props.maxCharLength||i.lr)+e.revealText.length}),g(h(e),"showFullText",function(){return e.setState({truncate:!1})}),e}return n=[{key:"revealText",get:function(){return this.props.inUnifiedComments?this.props.i18n._('... More', 'click to see more of a long post', 'click to see more of a long post'):this.props.i18n._('... See more', 'click to see more of a long post', 'click to see more of a long post')}},{key:"render",value:function(){var e=this.props,t=e.allowReveal,n=e.maxCharLength,s=e.size,u=e.tags,d=e.taggedUsers,f=e.text,p=this.state.truncate,h=p?f.substring(0,n||i.lr).trim():f;return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(a.Z,{shouldShowFirstNameOnly:!0,taggedUsers:d,tags:u,text:h}),p&&!t&&(0,c.jsx)(o.xv,{inline:!0,overflow:"normal",weight:"bold",children:this.revealText}),p&&t&&(0,c.jsx)(l.Z,{color:"default",handleClick:this.showFullText,size:s,text:this.revealText})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}(d.prototype,n),Object.defineProperty(d,"prototype",{writable:!1}),d}(r.PureComponent);g(b,"defaultProps",{allowReveal:!1,size:"200",tags:[],taggedUsers:[],text:""}),t.Z=function(e){var t=(0,s.ZP)();return(0,c.jsx)(b,f(f({},e),{},{i18n:t}))}},234295:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(20256),o=n(382718);function i(e){var t=e.color,n=e.handleClick,i=e.size,l=e.text;return(0,o.jsx)(r.xu,{display:"inlineBlock",children:(0,o.jsx)(r.iP,{onTap:n,rounding:"pill",children:(0,o.jsx)(r.xv,{color:void 0===t?"subtle":t,size:void 0===i?"100":i,weight:"bold",children:l})})})}},93035:function(e,t,n){n.d(t,{A7:function(){return o},YD:function(){return i},lr:function(){return r}});var r=170,o=function(e,t,n){var r=new Date(e);return 60>Math.floor((new Date().getTime()-r.getTime())/1e3)?t._('now', 'timestamp for a comment or post that was created within the last minute', 'timestamp for a comment or post that was created within the last minute'):n(e,!0)},i=function(e){var t=e.first_name||e.full_name||e.username;return t&&t.length>60?t.substring(0,60).trim().concat("..."):t}},58915:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(581722),o=n(575108),i=n(296691),l=n(105433),a=n(611134),s=n(189976),c=n(800300),u=n(696323);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e,t,n,r,o,i,l){try{var a=e[i](l),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function h(){var e,t,n=(0,r.I0)(),h=(0,l.nf)(),m=h.aggregatedCommentDeleted,y=h.updateCommentCount;return e=regeneratorRuntime.mark(function e(t){var r,l,p,h,g,_,b,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.aggregatedCommentId,l=t.aggregatedPinId,p=t.feedType,h=t.orbacSubjectId,g=t.parentId,_=t.type,b=t.updateParentCommentCount,v=t.pinId,e.next=3,o.Z.create("AggregatedCommentResource",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({commentId:r},h?{orbacSubjectId:h}:{})).callDelete({showError:!1});case 3:g&&(n((0,s.EX)({feedId:l||g,feedType:p||u.Z.AGGREGATED_COMMENTS,itemIds:[r],itemType:"aggregatedcomment"})),m(g,r),b&&(_||0===_)&&(_===i.Rv.TOP&&v?n((0,c.R)(v,-1)):_===i.Rv.REPLY_TO_AGGREGATED?y(g,-1):n((0,a.L8)(g,-1))));case 4:case"end":return e.stop()}},e)}),t=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function l(e){p(i,r,o,l,a,"next",e)}function a(e){p(i,r,o,l,a,"throw",e)}l(void 0)})},function(e){return t.apply(this,arguments)}}},599599:function(e,t,n){n.d(t,{Z:function(){return e$}});var r=n(586659),o=n(20256),i=n(452149),l=n(581722),a=n(994345),s=n(197980),c=n(980787),u=n(282025),d=n(575108),f=n(513846),p=n(18468),h=n(19585),m=n(369416),y=n(538688),g=n(382718);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(P=function(){return!!e})()}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,n){return(t=C(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}var S="\n.uploadProgressBar {\n  background-color: ".concat(p.$rz,";\n  border-radius: 8px;\n  height: 16px;\n  opacity: 1;\n  position: absolute;\n  transition: opacity 85ms ease-in, width 85ms ease-in;\n  z-index: 10;\n\n  &.transition {\n    opacity: 0;\n    transition: opacity 85ms ease-in, width 85ms ease-in;\n  }\n}\n"),A=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&x(l,e);var t,n,i=(t=P(),function(){var e,n=w(l);return e=t?Reflect.construct(n,arguments,w(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==_(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return j(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return O(j(e=i.call.apply(i,[this].concat(n))),"_videoContainerRef",null),O(j(e),"removeVideoTag",function(){e._videoContainerRef&&e._videoContainerRef.childNodes[0]&&e._videoContainerRef.removeChild(e._videoContainerRef.childNodes[0])}),O(j(e),"clear",function(t){t.event.stopPropagation(),e.removeVideoTag(),e.props.handleRemoveClick()}),e}return n=[{key:"isPin",get:function(){var e=this.props,t=e.display,n=e.imagePreviewSrc,r=e.videoUrls;return"pin"===t&&(!!n||!!r)}},{key:"renderProgressBar",value:function(){var e=this.props.progress;return(0,g.jsx)("div",{className:100===e||0===e?"uploadProgressBar transition":"uploadProgressBar",style:{width:"".concat(e,"%")}})}},{key:"renderDropZone",value:function(){return(0,g.jsxs)(o.xu,{children:[(0,g.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:(0,g.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:(0,g.jsx)(o.JO,{accessibilityLabel:this.props.i18n._('Add a Photo', 'Add a photo as part of a form', 'Add a photo as part of a form'),color:"default",icon:"camera",size:32})})}),(0,g.jsx)(o.xu,{marginTop:2,paddingX:12,children:(0,g.jsx)(o.xv,{align:"center",color:"default",weight:"bold",children:this.props.i18n._('Drag and drop or click to upload', 'Label on drag/drop area for uploading a pin', 'Label on drag/drop area for uploading a pin')})})]})}},{key:"renderImage",value:function(){var e=this.props,t=e.height,n=e.imagePreviewSrc,r=e.width,i=this.props.i18n._('Your Upload', 'Image a pinner just uploaded to a form', 'Image a pinner just uploaded to a form');return this.isPin?(0,g.jsx)(o.Ee,{alt:i,src:n}):(0,g.jsx)(o.xu,{height:t,width:r,children:(0,g.jsx)(o.Ee,{alt:i,color:"white",naturalHeight:t,naturalWidth:r,src:n})})}},{key:"renderResetButton",value:function(){return(0,g.jsx)(o.xu,{left:!0,margin:2,position:"absolute",top:!0,children:(0,g.jsx)(o.hU,{accessibilityLabel:this.props.i18n._('Remove Photo', 'Remove photo from a form', 'Remove photo from a form'),bgColor:"lightGray",icon:"clear",iconColor:"darkGray",onClick:this.clear,size:"sm"})})}},{key:"renderContent",value:function(){var e=this.props,t=e.height,n=e.imagePreviewSrc,i=e.isHovering,l=e.isVideo,a=e.isVideoComplete,s=e.isOver,c=e.thumbnail,u=e.videoUrls,d=e.allowReset,f=e.width,p=u?(0,g.jsx)("video",{autoPlay:!0,controls:!0,height:this.isPin?"auto":t,loop:!0,poster:c||"",width:f,children:Object.keys(u).map(function(e){return(0,g.jsx)("source",{src:u[e],type:"hls"===e?"m3u8":"video/mp4"},e)})}):null;return(0,g.jsxs)(r.Fragment,{children:[(0,g.jsx)(o.zd,{height:"100%",rounding:2,children:(0,g.jsxs)(o.xu,{alignItems:"center",color:s?"secondary":"default",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[!n&&!l&&this.renderDropZone(),l&&!u&&(0,g.jsxs)(o.xu,{children:[a&&(0,g.jsx)(o.xv,{align:"center",weight:"bold",children:this.props.i18n._('Processing Video', 'Loading message shown while user video is uploading', 'Loading message shown while user video is uploading')}),(0,g.jsx)(o.xu,{paddingY:4,children:(0,g.jsx)(o.xH,{accessibilityLabel:this.props.i18n._('Video uploading', 'Loading spinner while video uploads', 'Loading spinner while video uploads'),show:!0})})]}),p,n&&this.renderImage()]})}),(n||u)&&(void 0===d||d)&&i&&this.renderResetButton()]})}},{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.height,r=e.imagePreviewSrc,i=e.onClick,l=e.videoUrls,a=e.width,s=e.hoverHandlers,c=s.onMouseOver,u=s.onMouseLeave,d=this.isPin?"auto":n,f=(0,g.jsxs)(o.xu,{position:"relative",children:[(0,g.jsx)(m.Z,{unsafeCSS:S}),this.renderProgressBar(),r||l?(0,g.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",outline:"none"}},height:d,marginEnd:"auto",marginStart:"auto",padding:0,width:a,children:(0,g.jsx)(o.iP,{fullWidth:!1,mouseCursor:r?"default":"pointer",onMouseEnter:c,onMouseLeave:u,children:this.renderContent()})}):(0,g.jsx)(o.iP,{onMouseEnter:c,onMouseLeave:u,onTap:i,children:(0,g.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",cursor:r?"default":"pointer",outline:"none"}},height:d,marginEnd:"auto",marginStart:"auto",padding:0,width:a,children:this.renderContent()})})]});return t((0,g.jsx)("div",{children:f}))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component),I=(0,f.DropTarget)(function(e){return e.accepts},{drop:function(e,t){e.onDrop&&e.onDrop(e,t)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}})(function(e){var t=(0,h.ZP)(),n=(0,y.Z)(),r=n.isHovering,o=n.hoverHandlers;return(0,g.jsx)(A,v(v({},e),{},{hoverHandlers:o,i18n:t,isHovering:r}))}),T=n(686319),k=n(15667);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){B(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n,r,o,i,l){try{var a=e[i](l),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function R(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function l(e){M(i,r,o,l,a,"next",e)}function a(e){M(i,r,o,l,a,"throw",e)}l(void 0)})}}function L(e,t){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function U(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Z=function(){return!!e})()}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=D(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}var N=["video/quicktime","video/mp4"],V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1200x";return e&&"https://i.pinimg.com/".concat(t,"/").concat(e.substring(0,2),"/").concat(e.substring(2,4),"/").concat(e.substring(4,6),"/").concat(e,".jpg")||""},W=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&L(l,e);var t,n,r,i=(t=Z(),function(){var e,n=H(l);return e=t?Reflect.construct(n,arguments,H(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return U(e)}(this,e)});function l(){var e,t;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return B(U(e=i.call.apply(i,[this].concat(r))),"state",{imagePreviewSrc:e.props.existingImageSrc||"",isVideo:!1,isVideoComplete:!1,thumbnail:null,videoUrls:null,errorFlyout:null,progress:0}),B(U(e),"mounted",!1),B(U(e),"containerRef",null),B(U(e),"fileInputRef",null),B(U(e),"xhr",null),B(U(e),"CHECK_VIDEO_TIMEOUT",null),B(U(e),"ERROR_MESSAGE",e.props.i18n._('Unable to upload video. Please try again later.', 'Error shown when we can\'t accept video uploads', 'Error shown when we can\'t accept video uploads')),B(U(e),"handleFileDrop",function(t,n){if(n&&(!e.xhr||4===e.xhr.readyState)){var r=n.getItem().files[0];e.handleFile(r)}}),B(U(e),"handleFile",function(t){var n=e.props.onImageUploadStart;t.size>2e9?e.showError(e.props.i18n._('The video is too large. The maximum size is 2 GB.', 'Error if a user tries to upload a video that is too large', 'Error if a user tries to upload a video that is too large')):(e.props.allowVideo&&N.includes(t.type)&&e.setState({isVideo:!0}),e.loadMedia(t),n&&n())}),B(U(e),"showError",function(t){var n=(0,g.jsx)(o.J2,{anchor:e.containerRef,idealDirection:e.props.idealErrorDirection,onDismiss:function(){return e.setState({errorFlyout:null})},shouldFocus:!1,size:"sm",children:(0,g.jsx)(o.xu,{padding:3,children:(0,g.jsx)(o.qb,{title:t,type:"problem"})})});e.removePreview(n)}),B(U(e),"openFileDialog",function(){e.state.imagePreviewSrc||e.state.isVideo||(e.props.logContextEvent({event_type:101,component:192,element:1156}),e.fileInputRef&&e.fileInputRef.click())}),B(U(e),"openFile",function(t){var n=t.target.files[0];e.handleFile(n)}),B(U(e),"removePreview",function(t){e.setState({imagePreviewSrc:"",progress:0,isVideo:!1,isVideoComplete:!1,videoUrls:null,errorFlyout:t}),e.fileInputRef&&(e.fileInputRef.value=""),e.xhr&&e.xhr.abort&&(e.xhr.abort(),e.xhr=null),e.CHECK_VIDEO_TIMEOUT&&clearTimeout(e.CHECK_VIDEO_TIMEOUT),e.props.onReset&&e.props.onReset()}),B(U(e),"checkForMedia",(t=R(regeneratorRuntime.mark(function t(n){var r,o,i,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.Z.create("VIPResource",{upload_ids:[n]}).callGet();case 2:(r=t.sent).resource_response&&r.resource_response.data&&r.resource_response.data[n]?(i=(o=r.resource_response.data[n]).status,l=o.signature,"processing"===i||"registered"===i?e.CHECK_VIDEO_TIMEOUT=setTimeout(function(){return e.checkForMedia(n)},1e3):"succeeded"===i?e.handleMediaUploadSuccess(l,n):e.showError(e.ERROR_MESSAGE)):e.showError(e.ERROR_MESSAGE);case 4:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)})),B(U(e),"loadMedia",function(t){var n=e.state.isVideo;d.Z.create("VIPResource",{type:n?"video":"triedit-image"}).callCreate().then(function(n){var r,o=null!=(r=n.resource_response.data)?r:{},i=o.upload_id,l=o.upload_url,a=o.upload_parameters;e.uploadMedia(t,i,l,a)},function(){e.showError(e.ERROR_MESSAGE)})}),B(U(e),"uploadMedia",function(t,n,r,o){var i=e.state.isVideo,l=new XMLHttpRequest;l.open("POST",r,!0),l.onload=function(){var t;(t=l.status)>=200&&t<400?e.setState({errorFlyout:null,isVideoComplete:i}):e.showError(e.props.i18n._('Something went wrong. Please try again later.', 'Error if video fails to upload', 'Error if video fails to upload')),e.checkForMedia(n)},l.upload.onprogress=function(t){var n=Math.round(99*t.loaded/t.total);e.setState({progress:n})};var a=new FormData;for(var s in o)a.append(s,o[s]);a.append("file",t),l.send(a),e.xhr=l}),e}return r=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"handleMediaUploadSuccess",value:(n=R(regeneratorRuntime.mark(function e(t,n){var r,o,i,l,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.state.isVideo,i=(o=this.props).width,l=o.height,!r){e.next=12;break}if(this.props.isAuthenticated){e.next=6;break}return this.showError(this.ERROR_MESSAGE),e.abrupt("return");case 6:return e.next=8,(0,T.Z)({url:"/v3/videos/urls/",data:{signatures:[t]}});case 8:a=e.sent,this.handleVideoUploadSuccess(a,t,n),e.next=15;break;case 12:s=V(t),this.setState({imagePreviewSrc:s,progress:100}),this.props.onImageUploadFinished({image:{url:s,width:i,height:l}});case 15:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"handleVideoUploadSuccess",value:function(e,t,n){var r=this;if(this.mounted){var o=e.resource_response.data,i="https://i.pinimg.com/".concat(o[t].metadata.thumbnail),l=o[t].urls;this.setState({videoUrls:l,thumbnail:i,progress:100});var a=new XMLHttpRequest;a.onload=function(){var e=new FileReader;e.readAsDataURL(a.response),e.onloadend=function(){var t;r.props.onImageUploadFinished({video:{uploadId:n,imageBase64:null!=(t=e.result)?t:""}})}},a.open("GET",i),a.responseType="blob",a.send()}}},{key:"render",value:function(){var e=this,t=u.NativeTypes.FILE,n=this.state,r=n.errorFlyout,i=n.imagePreviewSrc,l=n.isVideo,a=n.isVideoComplete,s=n.progress,c=n.thumbnail,d=n.videoUrls,f=this.props,p=f.allowReset,h=f.allowVideo,m=f.display,y=f.height,_=f.width;return(0,g.jsxs)(o.xu,{ref:function(t){e.containerRef=t},children:[(0,g.jsx)(o.xu,{display:"visuallyHidden",children:(0,g.jsx)("input",{ref:function(t){e.fileInputRef=t},accept:h?"image/*,video/mp4,video/quicktime":"image/*","data-gestalt-valid-html":"TextField",onChange:this.openFile,type:"file"})}),(0,g.jsx)(I,{accepts:[t],allowReset:p,display:m,handleRemoveClick:this.removePreview,height:y,imagePreviewSrc:i,isVideo:l,isVideoComplete:a,onClick:this.openFileDialog,onDrop:this.handleFileDrop,progress:s,thumbnail:c,videoUrls:d,width:_}),r]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}(l.prototype,r),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component);B(W,"defaultProps",{onImageUploadStart:function(){}});var G=function(e){var t=(0,c.u)().logContextEvent,n=(0,k.B)().isAuthenticated,r=(0,h.ZP)();return(0,g.jsx)(W,E(E({},e),{},{i18n:r,isAuthenticated:n,logContextEvent:t}))},X=n(788272),K=n(475498),Y=n(87853),q=n(611134),J=n(867215);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(t){ei(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e,t){return(et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(er=function(){return!!e})()}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ei(e,t,n){return(t=el(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function el(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var ea=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/,es=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&et(i,e);var t,n,r=(t=er(),function(){var e,n=eo(i);return e=t?Reflect.construct(n,arguments,eo(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return en(e)}(this,e)});function i(e){if(!(this instanceof i))throw TypeError("Cannot call a class as a function");ei(en(t=r.call(this,e)),"setTextAreaRef",function(e){t._textAreaRef=e}),ei(en(t),"handleTextInputChange",function(e){var n=e.value;t.setState({notes:n.substring(0,1e3)}),n.length>1e3?t.forceUpdate():t.handleHashtagTypeahead(n)}),ei(en(t),"handleHashtagTypeahead",function(e){var n=ea.exec(e),r=n?n[0]:"";!t.state.inTypeahead&&r?t.setState({inTypeahead:!0,typeaheadValue:r}):t.state.inTypeahead&&(r?t.setState({typeaheadValue:r}):t.setState({inTypeahead:!1,typeaheadValue:""}))}),ei(en(t),"addHashtag",function(e){t.setState(function(t){return{inTypeahead:!1,notes:t.notes.replace(ea,e),typeaheadValue:""}})}),ei(en(t),"uploadImageAndCreateDidIt",function(){(0,T.Z)({url:"/v3/did_it/image/upload/",method:"PUT",data:{image_url:t.state.imageUrlToSend}}).then(function(e){var n=e.resource_response.data.image_signature;return t.createUpdateDidIt(n)}).catch(function(){return t.createUpdateDidIt()})}),ei(en(t),"handleImageReset",function(){return t.setState({imageUrlToSend:null})}),ei(en(t),"handleFinishImageUpload",function(e){e.image&&t.setState({imageUrlToSend:e.image.url})}),ei(en(t),"handleDoneClick",function(){var e=t.props,n=e.pinId;(0,e.logContextEvent)({event_type:101,view_type:101,component:192,element:1112,object_id_str:n}),t.setState({submitted:!0}),t.handleDoneSubmission()}),ei(en(t),"handleDoneSubmission",function(){var e=t.state.imageUrlToSend,n=t.props.pinActivity;if(e){if(!n||e!==n.oldImageUrl)return t.uploadImageAndCreateDidIt();else if(n.imageSignatures&&n.imageSignatures.length>0)return t.createUpdateDidIt(n.imageSignatures[0])}return t.createUpdateDidIt()}),ei(en(t),"handleCancel",function(){var e=t.props.onDoneStateChanged;e&&e(!1)}),ei(en(t),"handleDeleteConfirmation",function(e){var n=t.props,r=n.aggregatedPinDataId,o=n.deleteUserDidItData,i=n.isDoneByMe,l=n.loggedInUser.username,a=n.onDoneStateChanged,s=n.pinId,c=n.logContextEvent;t.setState({showDeleteModal:!1}),e&&(c({event_type:101,view_type:101,component:192,element:1264,object_id_str:s}),o({aggregatedPinDataId:r,pinId:s,username:l,id:e,isOwnedByMe:!0}),a&&a(i))}),ei(en(t),"handleShowDeleteModal",function(){return t.setState({showDeleteModal:!0})});var t,n=e.pinActivity;return t.state={id:(null==n?void 0:n.id)||null,imageUrlToSend:(null==n?void 0:n.oldImageUrl)||null,inTypeahead:!1,notes:(null==n?void 0:n.notes)||"",showDeleteModal:!1,submitted:!1,typeaheadValue:""},t}return n=[{key:"createUpdateDidIt",value:function(e){var t=this,n=this.props,r=n.aggregatedPinDataId,o=n.createUserDidItData,i=n.isDoneByMe,l=n.loggedInUser.username,a=n.onDoneStateChanged,s=n.pinId,c=n.toastManagerContext,u=n.updateUserDidItData,d=this.state,f=d.id,p=d.notes;p&&(i?f&&u({id:f,pinId:s,details:p,image_signatures:e?[e]:[]}):o({aggregatedPinDataId:r,username:l,details:p,image_signatures:e?[e]:[],pin_id:s}),a&&a(!i),-1===window.location.href.indexOf(l+"/tried")&&c.showToast(function(e){var n=e.hideToast;return(0,g.jsx)(K.Z,{duration:3e3,href:"/".concat(l,"/tried/"),onHide:n,text:t.props.i18n._('Nice work! Pins you\'ve tried live on your profile', 'Congratulations after trying a pin', 'Congratulations after trying a pin')})}))}},{key:"render",value:function(){var e=this.state,t=e.imageUrlToSend,n=e.notes,r=e.showDeleteModal,i=e.submitted,l=this.props,a=l.isDoneByMe,c=l.pinActivity,u=!!t&&(c||{}).oldImageUrl!==t,d=!!t,f=c&&c.notes!==n,p=!!n&&""!==n.trim();return(0,g.jsxs)(o.xu,{children:[(0,g.jsx)(o.xu,{marginTop:4,paddingX:12,children:(0,g.jsx)(o.xu,{column:12,children:(0,g.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"padding-top 0.2s ease"}},paddingY:10*!t,children:(0,g.jsx)(o.xu,{alignItems:"center",color:"transparent",column:12,display:"flex",justifyContent:"center",marginBottom:2,rounding:2,children:(0,g.jsx)(G,{display:"image",existingImageSrc:t,height:366,idealErrorDirection:"up",onImageUploadFinished:this.handleFinishImageUpload,onReset:this.handleImageReset,width:366})})})})}),(0,g.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"opacity 0.2s ease",transitionDelay:"0.2s",visibility:t?"visible":"hidden"}},height:t?"auto":0,opacity:+!!t,children:(0,g.jsxs)(o.xu,{margin:3,marginEnd:"auto",marginStart:"auto",width:366,children:[(0,g.jsx)(o.xu,{ref:this.setTextAreaRef,children:(0,g.jsx)(o.Kx,{id:"trynotes",onChange:this.handleTextInputChange,placeholder:this.props.i18n._('Add a note or tip', 'Tip input for tried it', 'Tip input for tried it'),value:n})}),this.state.inTypeahead&&this._textAreaRef?(0,g.jsx)(J.Z,{addHashtag:this.addHashtag,anchor:this._textAreaRef,idealDirection:"up",query:this.state.typeaheadValue}):null,n.length>900&&(0,g.jsx)(o.xu,{paddingY:1,children:(0,g.jsxs)(o.xv,{align:"end",size:"200",children:[" ",n.length,"/",1e3," "]})})]})}),(0,g.jsxs)(o.kC,{alignItems:"stretch",justifyContent:"end",children:[r&&(0,g.jsx)(s.Z,{didItData:c,onDeleteConfirmation:this.handleDeleteConfirmation}),i?(0,g.jsx)(o.xu,{marginEnd:2,children:(0,g.jsx)(o.xH,{accessibilityLabel:this.props.i18n._('submit', 'accessible label for loading spinner on submit button', 'accessible label for loading spinner on submit button'),show:!0})}):null,(0,g.jsxs)(o.xu,{display:"flex",marginBottom:3,marginEnd:4,children:[a?(0,g.jsx)(o.xu,{marginEnd:1,children:(0,g.jsx)(o.zx,{onClick:this.handleShowDeleteModal,size:"md",text:this.props.i18n._('Delete', 'delete button in modal for tried-it info', 'delete button in modal for tried-it info')})}):(0,g.jsx)(o.xu,{marginEnd:1,children:(0,g.jsx)(o.zx,{onClick:this.handleCancel,size:"md",text:this.props.i18n._('Cancel', 'cancel button in modal for tried-it info', 'cancel button in modal for tried-it info')})}),(0,g.jsx)(o.xu,{children:(0,g.jsx)(o.zx,{color:"red",disabled:!d||!p||!f&&!u,onClick:this.handleDoneClick,size:"md",text:this.props.i18n._('Done', 'done button in modal for tried-it info', 'done button in modal for tried-it info')})})]})]})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,el(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.PureComponent),ec=(0,X.Z)(function(e){var t=(0,c.u)().logContextEvent,n=(0,h.ZP)(),r=(0,l.I0)(),o=(0,a.bindActionCreators)(q.DD,r),i=(0,a.bindActionCreators)(q.lg,r),s=(0,a.bindActionCreators)(q.IU,r);return(0,g.jsx)(es,ee(ee({},e),{},{createUserDidItData:o,deleteUserDidItData:i,i18n:n,logContextEvent:t,toastManagerContext:(0,Y.dI)(),updateUserDidItData:s}))}),eu=n(886981),ed=["onDoneStateChanged","pinActivityResource","pinTitle","userDidItDataId"];function ef(e){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ep(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ep(Object(n),!0).forEach(function(t){eb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ep(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function em(e,t){return(em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ey(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eg=function(){return!!e})()}function e_(e){return(e_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eb(e,t,n){return(t=ev(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ev(e){var t=function(e,t){if("object"!=ef(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ef(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ef(t)?t:t+""}var ex=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&em(l,e);var t,n,r=(t=eg(),function(){var e,n=e_(l);return e=t?Reflect.construct(n,arguments,e_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==ef(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return ey(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return eb(ey(e=r.call.apply(r,[this].concat(n))),"onDoneStateChanged",function(t){var n=e.props,r=n.onDoneStateChanged,o=n.pinActivityResource;r&&r(t),t&&o&&o.refresh&&o.refresh()}),e}return n=[{key:"render",value:function(){var e=this.props,t=(e.onDoneStateChanged,e.pinActivityResource),n=(e.pinTitle,e.userDidItDataId,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ed));return!t||t&&t.isLoaded?(0,g.jsx)(o.xu,{rounding:2,children:(0,g.jsx)(ec,eh({onDoneStateChanged:this.onDoneStateChanged,pinActivity:function(e){if(!e)return null;var t=e.details,n=e.images,r=e.image_signatures;return{id:e.id,imageSignatures:r,notes:t,oldImageUrl:n[0]["200x"].url}}(t&&t.data)},n))}):(0,g.jsx)(i.Z,{})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ev(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component);function ej(e){var t=(0,eu.Z)({name:"DidItActivityResource",options:{user_did_it_data_id:e.userDidItDataId,username:"me"},noCache:!0});return(0,g.jsx)(ex,eh(eh({},e),{},{pinActivityResource:t}))}function eP(e){return e.isDoneByMe?(0,g.jsx)(ej,eh({},e)):(0,g.jsx)(ex,eh({},e))}var ew=n(982166),eO=n(665827);function eC(e){return(eC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eS(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=eC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eC(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eC(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eI=function(e){if(!e)return null;var t=e.richMetadata.title;return t?eA(eA({},e),{},{title:t}):null},eT=n(176465),ek=n(417245);function eD(e){return(eD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ez(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ez(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=eM(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ez(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eM(e){var t=function(e,t){if("object"!=eD(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eD(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eD(t)?t:t+""}function eR(e,t){return(eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eL=function(){return!!e})()}function eU(e){return(eU=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eZ=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&eR(l,e);var t,n,r=(t=eL(),function(){var e,n=eU(l);return e=t?Reflect.construct(n,arguments,eU(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==eD(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,e)});function l(){if(!(this instanceof l))throw TypeError("Cannot call a class as a function");return r.apply(this,arguments)}return n=[{key:"render",value:function(){var e=this.props,t=e.aggregatedPinDataId,n=e.isDoneByMe,r=e.loggedInUser,l=e.onDoneStateChanged,a=e.onHide,s=e.pinId,c=e.pinResource,u=e.pinTitle,d=e.userDidItDataId;if(!c.isLoaded)return(0,g.jsx)(i.Z,{});var f=(eI((0,eO.Z)((0,eT.Z)({pin:c.data})))||{}).title,p=u||f?(0,ek.Z)(this.props.i18n._('Add a photo of {{pinTitle}}', 'Adding photo of a pin', 'Adding photo of a pin'),{pinTitle:u||f||""}):this.props.i18n._('Add a photo', 'Adding a photo', 'Adding a photo');return(0,g.jsx)(ew.ZP,{accessibilityModalLabel:p,heading:p,onDismiss:a,size:500,children:(0,g.jsx)(o.xu,{color:"default",display:"flex",justifyContent:"center",rounding:2,children:(0,g.jsx)(eP,{aggregatedPinDataId:t,isDoneByMe:n,loggedInUser:r,onDoneStateChanged:l,pinId:s,pinTitle:u||f,userDidItDataId:d})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eM(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.PureComponent);function eH(e){var t=(0,h.ZP)(),n=(0,eu.Z)({name:"PinResource",options:{field_set_key:"detailed",id:e.pinId}});return(0,g.jsx)(eZ,eE(eE({},e),{},{i18n:t,pinResource:n}))}var eB=n(679422);function eF(e){return(eF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eN(Object(n),!0).forEach(function(t){eY(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eW(e,t){return(eW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eG(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eX=function(){return!!e})()}function eK(e){return(eK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eY(e,t,n){return(t=eq(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eq(e){var t=function(e,t){if("object"!=eF(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eF(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eF(t)?t:t+""}var eJ=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&eW(i,e);var t,n,o=(t=eX(),function(){var e,n=eK(i);return e=t?Reflect.construct(n,arguments,eK(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==eF(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eG(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return eY(eG(e=o.call.apply(o,[this].concat(n))),"state",{showModal:!1}),eY(eG(e),"onTriedItButtonClick",function(t){var n=e.props,r=n.requireAuth,o=n.logContextEvent;if(t&&t.stopPropagation(),r)return void r();e.handleModalStateChange(!0),o({event_type:101,view_type:101,component:e.props.thriftComponentType,element:1141,object_id_str:e.props.pinId,aux_data:{is_create:!e.props.isDoneByMe}})}),eY(eG(e),"handleHideModal",function(){e.handleModalStateChange(!1),e.props.logContextEvent({event_type:101,view_type:101,component:192,element:75,object_id_str:e.props.pinId})}),eY(eG(e),"onModalDoneStateChanged",function(t){e.handleModalStateChange(!1,t)}),eY(eG(e),"handleModalStateChange",function(t,n){var r=e.props,o=r.onDoneStateChanged,i=r.onToggleModal;e.setState({showModal:t},function(){!t&&o&&o("boolean"==typeof n&&n),i&&i(t)})}),e}return n=[{key:"render",value:function(){var e=this.props,t=e.aggregatedPinDataId,n=e.isDoneByMe,o=e.loggedInUser,i=e.pinId,l=e.pinTitle,a=e.userDidItDataId;return(0,g.jsxs)(r.Fragment,{children:[this.props.children({onTriedItButtonClick:this.onTriedItButtonClick}),this.state.showModal?(0,g.jsx)(eH,{aggregatedPinDataId:void 0===t?"":t,isDoneByMe:void 0!==n&&n,loggedInUser:void 0===o?{id:"",username:""}:o,onDoneStateChanged:this.onModalDoneStateChanged,onHide:this.handleHideModal,pinId:void 0===i?"":i,pinTitle:null!=l?l:"",userDidItDataId:a}):null]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eq(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.PureComponent);function e$(e){var t=(0,c.u)().logContextEvent,n=(0,eB.Z)();return(0,g.jsx)(eJ,eV(eV({},e),{},{logContextEvent:t,requireAuth:n}))}},197980:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(20256),o=n(982166),i=n(19585),l=n(382718);function a(e){var t=e.onDeleteConfirmation,n=e.didItData,a=(0,i.ZP)(),s=n&&n.id,c=a._('Are you sure?', 'Confirmation dialog for deleting data', 'Confirmation dialog for deleting data');return(0,l.jsx)(o.ZP,{accessibilityModalLabel:a._('Are you sure you want to delete the did it photo?', 'Label for a modal showing to confirm deleting a did it photo', 'Label for a modal showing to confirm deleting a did it photo'),footer:(0,l.jsxs)(r.xu,{display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,l.jsx)(r.xu,{padding:1,children:(0,l.jsx)(r.zx,{fullWidth:!0,onClick:function(){return t(null)},size:"lg",text:a._('Cancel', 'Cancel the deleting data in a modal form', 'Cancel the deleting data in a modal form')})}),(0,l.jsx)(r.xu,{padding:1,children:(0,l.jsx)(r.zx,{color:"red",dataTestId:"delete-did-it-button",fullWidth:!0,onClick:function(){t(s)},size:"lg",text:a._('Delete', 'Confirmation of deleting data', 'Confirmation of deleting data')})})]}),heading:c,onDismiss:function(){return t(null)},role:"alertdialog",size:"sm",children:(0,l.jsx)(r.xu,{paddingX:4,paddingY:2,children:(0,l.jsx)(r.xv,{children:a._('This will remove this photo', 'Confirmation dialog for deleting data', 'Confirmation dialog for deleting data')})})})}},452149:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(20256),o=n(19585),i=n(382718);function l(){var e=(0,o.ZP)();return(0,i.jsx)(r.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{outline:"none"}},display:"flex",height:155,justifyContent:"center",rounding:2,width:300,children:(0,i.jsx)(r.xH,{accessibilityLabel:e._('Tried it', ' - ', ' -- '),show:!0})})}},298258:function(e,t,n){n.d(t,{Z:function(){return ta}});var r,o=n(586659),i=n(581722),l=n(994345),a=n(20256),s=n(940280),c=n(382718),u="__SafeLinkFlag__",d=function(e){var t=e.html,n=e.onClick||null,r=[],o=(t=(t=t||"").replace(/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>)]+/gi,function(e){return r.push({url:"/search/pins/?q=".concat(encodeURIComponent(e),"&rs=").concat(s.i.HASHTAG_CLOSEUP),text:e}),u})).replace(/<a[\s]+href=['"]([^'"<>]+)['"][^>]*>([^<]*)<\/a>/gi,function(e,t,n){return r.push({url:t,text:n}),u});return(0,c.jsx)(a.xu,{"data-test-id":"safe-link",children:o.split(new RegExp("(".concat(u,")"))).filter(function(e){return e.length>0}).map(function(e,t){var o=e;if(e===u&&r.length){var i=r.shift(),l=i.url,s=i.text;o=(0,c.jsx)(a.rU,{display:"inlineBlock",href:l,onClick:n||void 0,underline:"hover",children:s})}return(0,c.jsx)(a.xv,{color:"shopping",inline:!0,weight:"bold",children:o},t)})})};n(492996);var f=n(963489),p=n(840611),h=n(982166),m=function(e){var t=e.accessibilityModalLabel,n=e.cancelButtonText,r=e.confirmButtonText,o=e.detail,i=e.heading,l=e.onConfirm,s=e.onDismiss;return(0,c.jsx)(h.ZP,{accessibilityModalLabel:t,heading:i,onDismiss:s,size:"md",children:(0,c.jsxs)(a.xu,{children:[(0,c.jsx)(a.xu,{padding:4,children:(0,c.jsx)(a.xv,{children:o})}),(0,c.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"end",children:[(0,c.jsx)(a.xu,{margin:2,children:(0,c.jsx)(a.xu,{"data-test-id":"confirm-modal-cancel",children:(0,c.jsx)(a.zx,{fullWidth:!0,onClick:s,text:n})})}),(0,c.jsx)(a.xu,{margin:2,children:(0,c.jsx)(a.xu,{"data-test-id":"confirm-modal-confirm",children:(0,c.jsx)(a.zx,{color:"red",fullWidth:!0,onClick:function(){l(),s()},text:r})})})]})]})})},y=n(19585),g=n(369416);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var b=(0,o.forwardRef)(function(e,t){var n,r=e.isCloseup,i=e.isEmojiTrayOpen,l=e.onClick,s=function(e){if(Array.isArray(e))return e}(n=(0,o.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(n,2)||function(e,t){if(e){if("string"==typeof e)return _(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,2):void 0}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=s[0],d=s[1],f=(0,a.JZ)(),p=(0,y.ZP)(),h=(0,o.useRef)(null);(0,o.useEffect)(function(){t&&(t.current=h.current)},[t]);var m=function(){null==l||l()},b=p._('Select an emoji', 'emojitray.button.accessibilityLabel', 'Accessibility label for emoji tray button');return(0,c.jsx)(a.xu,{color:i?"secondary":"transparent","data-test-id":"emoji-selector",display:"flex",justifyContent:"center",rounding:"circle",children:void 0!==r&&r?(0,c.jsx)(a.xu,{ref:h,children:(0,c.jsx)(a.hU,{accessibilityLabel:b,icon:"face-smiley",iconColor:"darkGray",onClick:m,size:"lg"})}):(0,c.jsx)(a.iP,{ref:h,accessibilityLabel:b,fullWidth:!1,onMouseEnter:function(){d(!0)},onMouseLeave:function(){d(!1)},onTap:m,rounding:"circle",children:(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(g.Z,{unsafeCSS:"@keyframes wiggle {\n        0% {transform: rotate(0deg);}\n        25% {transform: rotate(15deg);}\n        50% {transform: rotate(-15deg);}\n        75% {transform: rotate(15deg);}\n        100% {transform: rotate(0deg);}\n      }"}),(0,c.jsx)(a.xu,{ref:t,alignItems:"center",dangerouslySetInlineStyle:{__style:u&&!f?{fontSize:"24px",animationName:"wiggle",animationDuration:"0.9s"}:{fontSize:"24px"}},display:"flex",height:40,justifyContent:"center",width:40,children:"\uD83D\uDE03"})]})})})}),v=n(980787),x=n(788272),j=n(821342),P=n(542092),w=n(218119),O=n(733526);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(D=function(){return!!e})()}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var R={isTextChanged:!1,showConfirmDiscardModal:!1,submissionInProgress:!1,textValue:"",userMentionOverLimitError:!1},L=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&T(o,e);var t,n,r=(t=D(),function(){var e,n=z(o);return e=t?Reflect.construct(n,arguments,z(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==C(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return k(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return E(k(e=r.call.apply(r,[this].concat(n))),"state",I(I({},R),{},{tags:e.props.tags||[],textValue:e.props.text||"",isEmojiTrayOpen:!1})),E(k(e),"handleFocus",function(){e.props.onEnter()}),E(k(e),"handleChange",function(t){var n=t.text,r=t.mentions;r.length<e.state.tags.length&&e.props.logContextEvent({event_type:8906,aux_data:{tag_type:1}});var o=e.props.text||"";e.setState({isTextChanged:o!==n,textValue:n,tags:r,userMentionOverLimitError:r.length>5})}),E(k(e),"handleOnClickEdit",function(){var t=e.props.onEditItem,n=e.state,r={contentMarkdown:n.textValue,imageSignatures:"",objectIds:[],tags:JSON.stringify(n.tags)};t&&t(r),e.setState({submissionInProgress:!1})}),E(k(e),"handleOnClickPost",function(){e.state.userMentionOverLimitError||(e.setState({submissionInProgress:!0,isEmojiTrayOpen:!1}),e.handleOnClickPostFinal())}),E(k(e),"handleOnClickPostFinal",function(){var t=e.props.onAddItem,n=e.state,r={contentMarkdown:n.textValue,imageSignatures:"",objectIds:[],tags:JSON.stringify(n.tags)};t&&t(r),e.setState(R)}),E(k(e),"handleOnFinalDiscardItem",function(){var t=e.props.onCancelItem;e.setState(R),t()}),E(k(e),"isSubmitEditDisabled",function(){return!e.state.isTextChanged}),E(k(e),"toggleShowConfirmDiscardModal",function(){var t=e.state.showConfirmDiscardModal;e.setState({showConfirmDiscardModal:!t,isEmojiTrayOpen:!1})}),E(k(e),"renderConfirmDiscardModal",function(){var t,n;return"textInFlightNested"===e.props.statusType?(t=e.props.i18n._('Your changes will be discarded', 'Confirmation dialog before discarding changes', 'Confirmation dialog before discarding changes'),n=e.props.i18n._('Discard changes', 'Clear edits', 'Clear edits')):(t=e.props.i18n._('Once you delete a draft, you can\u2019t undo it', 'Confirmation before discarding changes', 'Confirmation before discarding changes'),n=e.props.i18n._('Delete', 'delete draft of a post or comment', 'delete draft of a post or comment')),(0,c.jsx)(m,{accessibilityModalLabel:e.props.i18n._('Confirm discard composer', 'Confirm discarding a post or comment', 'Confirm discarding a post or comment'),cancelButtonText:e.props.i18n._('Cancel', 'Cancel discarding a post or comment', 'Cancel discarding a post or comment'),confirmButtonText:n,detail:t,heading:e.props.i18n._('Are you sure?', 'Confirm discarding a post or comment', 'Confirm discarding a post or comment'),onConfirm:e.handleOnFinalDiscardItem,onDismiss:e.toggleShowConfirmDiscardModal})}),E(k(e),"getReplyToEntity",function(e){return[e?"@".concat(e.user.username," "):"",e?[{offset:0,object_id:e.user.id,length:e.user.username.length+1,tag_type:1}]:[]]}),e}return n=[{key:"isAggregatedComment",get:function(){var e=this.props.objectType;return e===P.o.pin||e===P.o.didIt||e===P.o.aggregatedComment}},{key:"render",value:function(){var e,t,n,r=this,o=this.props,i=o.avatarSize,l=o.replyToObject,s=o.privatePin,u=o.statusType,d=o.viewingUser,f=this.state,h=f.isTextChanged,m=f.isEmojiTrayOpen,y=f.showConfirmDiscardModal,g=f.submissionInProgress,_=f.tags,v=f.textValue,x=f.userMentionOverLimitError,j=function(e){if(Array.isArray(e))return e}(e=this.getReplyToEntity(l))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return S(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,2):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),P=j[0],C=j[1],A=(0,c.jsx)(a.xu,{children:(0,c.jsx)(a.xv,{align:"end",color:"error",size:"100",children:(0,O.bl)(!1,this.props.i18n)})});return(t=this.isAggregatedComment&&s?this.props.i18n._('Add a public comment', 'Add a comment', 'Add a comment'):this.isAggregatedComment?this.props.i18n._('Add a comment', 'Prompt to add a comment', 'Prompt to add a comment'):this.props.i18n._('Reply', 'Adding text to a community comment', 'Adding text to a community comment'),n=this.isAggregatedComment?this.props.i18n._('Done', 'Post a top level comment on a pin or tried it', 'Post a top level comment on a pin or tried it'):this.props.i18n._('Reply', 'Posting a reply to a post or comment', 'Posting a reply to a post or comment'),"textInflightCreation"===u)?(0,c.jsxs)(a.xu,{column:12,display:"flex",justifyContent:"center",children:[(0,c.jsxs)(a.xu,{width:"100%",children:[(0,c.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,c.jsx)(a.xu,{marginEnd:2,children:(0,c.jsx)(p.Z,{size:i,userKey:{type:"Legacy",data:d}})}),(0,c.jsx)(a.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,c.jsx)(w.Z,{focusOnMount:!0,initialMentions:C,initialText:P,onAddMention:function(){r.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:function(){r.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:function(){r.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:t})})]}),x&&A,(0,c.jsxs)(a.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,c.jsx)(a.xu,{"data-test-id":"activity-item-create-cancel",children:(0,c.jsx)(a.zx,{color:"gray",onClick:h?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n._('Cancel', 'Cancel making post or comment', 'Cancel making post or comment')})}),(0,c.jsx)(a.xu,{marginStart:2,children:(0,c.jsx)(a.xu,{"data-test-id":"activity-item-create-submit",children:(0,c.jsx)(a.zx,{color:"red",disabled:!h||g||!v.length,onClick:this.handleOnClickPost,text:n})})})]})]}),y&&this.renderConfirmDiscardModal()]}):"textInFlightNested"===u?(0,c.jsxs)(a.xu,{column:12,"data-test-id":"activity-item-create",display:"flex",justifyContent:"center",children:[(0,c.jsxs)(a.xu,{width:"100%",children:[(0,c.jsx)(a.kC,{alignItems:"stretch",justifyContent:"start",children:(0,c.jsx)(a.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,c.jsx)(w.Z,{focusOnMount:!0,initialMentions:_,initialText:v,onAddMention:function(){r.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:function(){r.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:function(){r.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:t})})}),x&&A,(0,c.jsxs)(a.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,c.jsx)(a.zx,{color:"gray",onClick:h?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n._('Cancel', 'Cancel making post or comment', 'Cancel making post or comment')}),(0,c.jsx)(a.xu,{marginStart:2,children:(0,c.jsx)(a.zx,{color:"red",disabled:this.isSubmitEditDisabled()||g,onClick:this.handleOnClickEdit,text:this.props.i18n._('Save', 'comment save button', 'comment save button')})})]})]}),y&&this.renderConfirmDiscardModal()]}):(0,c.jsx)(a.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"text"}},display:"flex",justifyContent:"between",rounding:2,children:(0,c.jsx)(a.iP,{"aria-label":this.props.i18n._('Add comment field', 'ActivityItemCreate.textbox.accessibilityLabel', 'Textbox for comment field.'),mouseCursor:"default",onKeyDown:this.handleFocus,onTap:this.handleFocus,tabIndex:0,children:(0,c.jsxs)(a.xu,{column:12,display:"flex",children:[(0,c.jsx)(a.xu,{width:48,children:(0,c.jsx)(p.Z,{size:i,userKey:{type:"Legacy",data:d}})}),(0,c.jsxs)(a.xu,{alignItems:"center",borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderRadius:"26px"}},display:"flex",height:48,marginStart:4,padding:4,width:"100%",children:[(0,c.jsx)("textarea",{"data-gestalt-valid-html":"TextArea","data-test-id":"communityItemTextBox",maxLength:2e3,name:"communityItemTextBox",onFocus:this.handleFocus,placeholder:t,rows:1,style:{background:"transparent",border:"0",display:h?"inline-block":"block",minHeight:"textStaticDisplay"===u?"":"50px",fontSize:"16px",outline:"0",overflowX:"hidden",resize:"none",whiteSpace:"pre-wrap",width:"100%"}}),(0,c.jsx)(b,{isEmojiTrayOpen:m,onClick:function(){r.setState({isEmojiTrayOpen:!m})}})]})]})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.Component);E(L,"defaultProps",{imageSignature:"",onEnter:function(){},text:"",widthAuto:!1});var U=(0,x.Z)(function(e){var t=(0,v.u)().logContextEvent,n=(0,y.ZP)(),r=(0,j.Z)(),o=r.isAuth?{image_medium_url:r.imageMediumUrl,type:"user",username:r.username,full_name:r.fullName,first_name:"",id:""}:{id:"",type:"user",username:""};return(0,c.jsx)(L,I(I({},e),{},{i18n:n,logContextEvent:t,viewingUser:o}))}),Z=n(234295),H=n(442672),B=n(197141);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){return(N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function V(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(W=function(){return!!e})()}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e,t,n){return(t=K(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=F(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:t+""}var Y=(0,n(78762).Z)(function(){return n.e("15564").then(n.bind(n,125734))},void 0,function(e){return 125734},"app-common-react-components-Activities-Utils-Linkify",function(e){return ["15564"]}),q=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&N(o,e);var t,n,r=(t=W(),function(){var e,n=G(o);return e=t?Reflect.construct(n,arguments,G(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==F(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return V(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return X(V(e=r.call.apply(r,[this].concat(n))),"parseText",function(){var t=e.props,n=t.tags,r=t.taggedUsers,o=t.text,i=t.size;if(!n.length||!r||n.length!==r.length)return e.renderRegularText(o,"1");var l=0,s=[];return n.forEach(function(t,n){var r=o.substring(l,t.offset);l=t.offset+t.length;var i=o.substring(t.offset,l);s=s.concat(e.renderRegularText(r,"".concat(n,"a"))).concat(e.renderTaggedText(i,n,"".concat(n,"b")))}),s=s.concat(e.renderRegularText(o.substring(l),"2")),(0,c.jsx)(a.xv,{inline:!0,overflow:"normal",size:i,children:s})}),X(V(e),"renderRegularText",function(t,n){return(0,c.jsx)(a.xv,{inline:!0,overflow:"normal",size:e.props.size,children:e.props.allowLink?(0,c.jsx)(Y,{children:t}):t},n)}),X(V(e),"renderTaggedText",function(t,n,r){return(0,c.jsx)(a.xv,{color:"shopping",inline:!0,overflow:"normal",size:e.props.size,weight:"bold",children:(0,c.jsx)(a.rU,{display:"inlineBlock",href:"/".concat(e.props.taggedUsers[n].username),underline:"hover",children:t})},r)}),e}return n=[{key:"render",value:function(){return(0,c.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},children:this.parseText()})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.PureComponent);X(q,"defaultProps",{allowLink:!0,size:"200"});var J=n(128677),$=n(93035),Q=n(670622);function ee(e){var t=e.createdAt,n=e.user,r=e.isHighlighted,o=(0,y.ZP)(),i=(0,Q.Z)(),l=(0,c.jsx)(a.xv,{color:"subtle",size:"200",children:(0,$.A7)(t,o,i)}),s=(0,c.jsxs)(a.xv,{color:"subtle",size:"200",children:["\xb7 ",o._('Highlighted', 'pin.comments.highlight', 'Identifier for highlighted comments')]});return(0,c.jsxs)(a.xu,{alignItems:"start",display:"flex",marginEnd:-1,marginStart:-1,children:[(0,c.jsx)(a.xu,{paddingX:1,children:(0,c.jsx)(a.xv,{size:"200",weight:"bold",children:(0,c.jsx)(a.rU,{href:"/".concat(n.username,"/"),children:(0,$.YD)(n)})})}),(0,c.jsx)(a.xu,{paddingX:1,children:l}),r&&(0,c.jsx)(a.xu,{paddingX:1,children:s})]})}var et=n(67484),en=n(886981),er=n(821806),eo=n(268557),ei=n(845421),el=n(838013);function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function es(e){var t,n=e.avatarSize,r=e.commentCount,i=e.contentImageSignature,l=e.contentText,s=e.flyout,u=e.handleOnEditCancel,d=e.handleOnEdited,f=e.handleHelpfulClick,h=e.handleLikeClick,m=e.handleReplyClick,g=e.handleReplyCountClick,_=e.helpfulCount,b=e.hideAddObjects,v=e.hideReplyCount,x=e.inEditMode,j=e.isHighlighted,P=e.isLikedByMe,w=e.isMarkedHelpfulByMe,O=e.isPlainComment,C=e.parentObject,S=e.reactionCounts,A=e.responsePinId,I=e.slotIndex,T=e.taggedUsers,k=e.tags,D=e.truncateText,z=e.commentId,E=e.createdAt,M=e.commentAuthor,R=e.type,L=e.isORBACProfileManager,Z=(0,et.K)(),H=(0,y.ZP)(),F=function(e){if(Array.isArray(e))return e}(t=(0,o.useState)(z===Z))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ea(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ea(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),N=F[0],V=F[1],W=(0,en.Z)(A?{name:"PinResource",options:{id:A,field_set_key:"detailed"}}:null),G=W.isLoaded,X=W.data;(0,o.useEffect)(function(){z===Z&&B.Z.setTimeout(function(){V(!1)},1500)},[]);var K=G&&!!A;return(0,c.jsx)(a.xu,{"data-test-id":"canonical-comment",children:(0,c.jsxs)(a.xu,{display:"flex",marginBottom:4*!!O,children:[(0,c.jsx)(a.xu,{marginEnd:2,children:(0,c.jsx)(p.Z,{size:void 0===n?"sm":n,userKey:{type:"Legacy",data:M}})}),(0,c.jsxs)(a.xu,{flex:"grow",marginStart:2,children:[(0,c.jsx)(a.xu,{borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderColor:x?"transparent":void 0,transition:"".concat(1e3,"ms"),backgroundColor:N?"lightGray":void 0}},padding:3*!x,rounding:4,children:x?(0,c.jsx)(U,{hideAddObjects:b,imageSignature:i,objectType:R,onAddItem:function(){},onCancelItem:u,onEditItem:d,onEnter:function(){},parentObjectId:C.id,statusType:"textInFlightNested",tags:k,text:l,widthAuto:!0}):(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(ee,{createdAt:E,isHighlighted:j,user:M}),D?(0,c.jsx)(J.Z,{allowReveal:!0,size:"100",taggedUsers:T,tags:k,text:l}):(0,c.jsx)(q,{size:"100",taggedUsers:T,tags:k,text:l}),A&&K&&X&&(0,c.jsx)(er.Z,{fallback:(0,c.jsx)(eo.Z,{accessibilityLabel:H._('Loading comment reply Pin preview', 'Loading pin previews for comment reply comments component', 'Loading pin previews for comment reply comments component')}),children:(0,c.jsx)(a.xu,{marginTop:1,maxWidth:"21%",children:(0,c.jsx)(ei.r,{pinKey:{type:"Legacy",data:X},slotIndex:I,surface:"CommentReply"})})})]})}),!L&&!K&&!x&&!O&&(0,c.jsx)(a.xu,{padding:1,children:(0,c.jsx)(el.Z,{commentCount:r,flyout:x?null:s,helpfulCount:_,hideReplyCount:v,isLikedByMe:P,isMarkedHelpfulByMe:w,onHelpfulClick:f,onLikeClick:h,onReplyClick:m,onReplyCountClick:g,reactionCounts:S,small:!0})})]})]})})}var ec=n(111923),eu=n(58915),ed=n(37739),ef=n(296691),ep=n(475498),eh=n(351607),em=n(536652),ey=n(473728),eg=n(87853),e_=n(105433),eb=n(636921),ev=n(502066),ex=n(357966),ej=n(401450),eP=n(169053),ew=n(666811);function eO(e,t,n,r,o,i,l){try{var a=e[i](l),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function eC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eS(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eS(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eA=function(e){var t,n,r=e.aggregatedCommentId,l=e.apdId,s=e.creatorId,u=e.depth,d=e.didItOwnerId,f=e.isManagedView,p=e.objectType,g=e.onUpdate,_=e.parentObjectId,b=e.pinDomainOwnerId,x=e.pinId,j=e.slotIndex,w=e.viewerId,O=e.showHighlightEducator,C=e.numHighlights,S=e.canSetHighlight,A=e.isORBACProfileManager,I=(0,v.u)().logContextEvent,T=(0,eb.Z)(),k=(0,y.ZP)(),D=(0,en.Z)({name:"PinResource",options:{id:x,field_set_key:"detailed"}}).isLoaded,z=(0,eg.dI)().showToast,E=(0,ew.Z)().reportComment,M=(0,e_.lV)(),R=(0,e_.nf)(),L=R.aggregatedCommentsHiddenForUser,Z=R.deleteCommentMention,B=R.toggleAggregatedCommentHelpful,F=R.toggleAggregatedCommentHighlight,N=R.toggleAggregatedCommentLike,V=R.updateAggregatedComment,W=(0,ec.Z)(),G=(0,eu.Z)(),X=M[r],K=(0,ev.G)().nativeEngagementsHiddenForUser,Y=eC((0,o.useState)(!1),2),q=Y[0],J=Y[1],$=eC((0,o.useState)(!1),2),Q=$[0],ee=$[1],et=eC((0,o.useState)(!1),2),er=et[0],eo=et[1],ei=eC((0,o.useState)(!1),2),el=ei[0],ea=ei[1],eS=eC((0,o.useState)(!1),2),eA=eS[0],eI=eS[1],eT=eC((0,o.useState)(!1),2),ek=eT[0],eD=eT[1],ez=(0,i.I0)();(0,o.useEffect)(function(){ez((0,em.U)("AggregatedCommentResource",{options:{commentId:r}}))},[ez,r]),(0,o.useEffect)(function(){g&&g()},[g]);var eE=(0,eP.S6)()(x),eM="pin";if(eE){var eR,eL=!!(null!=(eR=eE.videos)&&eR.video_list);eE.story_pin_data_id?eM="story":eL&&(eM="video")}if(!X||!X.user)return null;var eU=X.comment_response_pin,eZ=X.comment_count,eB=X.created_at,eF=X.helpful_count,eN=X.marked_helpful_by_me,eW=X.reaction_by_me,eG=X.reaction_counts,eX=X.tagged_users,eK=X.tags,eY=X.text,eq=X.user,eJ=eq.id,e$=eq.username,eQ=X.highlighted_by_pin_owner,e0=u===eH,e1=eG[1],e2=function(){N({aggregatedCommentId:r,isLikedByMe:!!eW})},e8=function(){B({aggregatedCommentId:r,isMarkedHelpfulByMe:!!eN})},e6=function(){if(C&&C>=3)return void z(function(e){var t=e.hideToast;return(0,c.jsx)(ep.Z,{onHide:t,text:k._('Only 3 comments can be highlighted', 'closeup.pinActionDropDown.commentHighlightMaxNumberToast', 'Toast that tells user that at most 3 comments can be highlighted.')})});F({aggregatedCommentId:r,pinId:x,isHighlighted:!1}),z(function(e){var t=e.hideToast;return(0,c.jsx)(ep.Z,{onHide:t,primaryAction:{accessibilityLabel:k._('Undo comment highlight or comment highlight removal', 'closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton', 'Accessibility label for toast to undo comment highlight or comment highlight removal'),label:k._('Undo', 'closeup.pinActionDropDown.commentHighlightToast.UndoButton', 'Undo comment highlight or comment highlight removal'),size:"lg",onClick:function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!0})}},text:k._('Comment highlighted', 'closeup.pinActionDropDown.commentHighlightToast', 'Toast that tells user that they have successfully highlighted a comment.')})})},e3=function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!0}),z(function(e){var t=e.hideToast;return(0,c.jsx)(ep.Z,{onHide:t,primaryAction:{accessibilityLabel:k._('Undo comment highlight or comment highlight removal', 'closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton', 'Accessibility label for toast to undo comment highlight or comment highlight removal'),label:k._('Undo', 'closeup.pinActionDropDown.commentHighlightToast.UndoButton', 'Undo comment highlight or comment highlight removal'),size:"lg",onClick:function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!1})}},text:k._('Highlight removed', 'closeup.pinActionDropDown.commentHighlightRemovalToast', 'Toast that tells user that they have successfully removed a comment highlight.')})})},e5=function(){eo(!er)},e9=(t=regeneratorRuntime.mark(function e(t){var n,o,i,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.contentMarkdown,o=t.tags,l=r,e5(),ee(!0),e0&&(l=_,i=r),e.next=7,ez(W({objectType:P.o.aggregatedComment,objectId:l,tags:o,text:n,replyToCommentId:i}));case 7:ee(!1);case 8:case"end":return e.stop()}},e)}),n=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function l(e){eO(i,r,o,l,a,"next",e)}function a(e){eO(i,r,o,l,a,"throw",e)}l(void 0)})},function(e){return n.apply(this,arguments)}),e4=function(){J(!0)},e7=function(){J(!1)},te=function(e){V({commentId:r,force:!0,tags:e.tags,text:e.contentMarkdown}),J(!1)},tt=function(){Z(r),I({event_type:8909,component:13464,view_type:3,view_parameter:140,aux_data:{tag_id:w,tag_type:1}}),z(function(e){var t=e.hideToast;return(0,c.jsx)(ep.Z,{onHide:t,text:k._('@mention removed!', 'closeup.pinActionDropDown.mentionRemovalToast', 'Toast that tells user that they have successfully removed the @mention of them in another user\'s Pin description')})})},tn=function(){ea(!0)},tr=function(){eD(!0)},to=function(){ea(!1),eI(!1),eD(!1)},ti=function(){E(r,_,p===P.o.aggregatedComment?"aggregatedcomment":"userdiditdata")},tl=function(){var e=[eJ,s,d,b].includes(w),t=w===eJ,n=w!==eJ,r=w!==eJ,o=eX.filter(function(e){return e.id===w}).length>0;return(0,c.jsx)(H.Z,{handleBlockUser:r?tr:null,handleClickReport:n?ti:null,handleDelete:e?tn:null,handleHighlight:S&&!eQ?e6:null,handleOnEdit:t?e4:null,handleRemoveHighlight:S&&eQ?e3:null,handleRemoveMention:o?tt:null,showHighlightEducator:O,small:!0})};return(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(eh.Fw,{componentType:p===P.o.pin?13696:13697,contextLogData:{objectId:X.id},impressionAuxFields:{commentId:X.id,pinId:x,pinType:eM,parentId:_,parentType:p,commentType:P.o.aggregatedComment},impressionType:"Comment",isPaused:!D,loggingId:X.id,slotIndex:j,viewType:3,children:function(e){var t=e.impressionTrackerRef;return(0,c.jsx)(a.xu,{ref:t,"data-test-id":"aggregatedCommentContainer-comment",children:(0,c.jsx)(es,{avatarSize:e0?"sm":"md",commentAuthor:X.user,commentCount:eZ,commentId:r,contentText:eY,createdAt:eB,flyout:tl(),handleHelpfulClick:e8,handleLikeClick:e2,handleOnEditCancel:e7,handleOnEdited:te,handleReplyClick:e5,helpfulCount:eF,hideAddObjects:!0,hideReplyCount:!0,inEditMode:q,isHighlighted:eQ,isLikedByMe:!!eW,isMarkedHelpfulByMe:eN,isORBACProfileManager:A,parentObject:{id:_},reactionCounts:eG,responsePinId:null==eU?void 0:eU.id,slotIndex:j,taggedUsers:eX,tags:eK,truncateText:!0,type:P.o.aggregatedComment})})}}),er&&(0,c.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:48*!e0}},"data-test-id":"aggregatedCommentContainer-replyComposer",children:(0,c.jsx)(a.xu,{display:"flex",marginTop:2,children:(0,c.jsx)(a.xu,{flex:"grow",children:(0,c.jsx)(U,{avatarSize:"sm",hideAddObjects:!0,objectType:P.o.aggregatedComment,onAddItem:e9,onCancelItem:e5,onEnter:function(){},parentObjectId:_,replyToObject:e0?X:null,statusType:"textInflightCreation"})})})}),eZ>0&&(0,c.jsxs)(a.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:48}},"data-test-id":"aggregatedCommentContainer-replyList",children:[(0,c.jsx)(eV,{baseIndex:j+1,commentCount:eZ,creatorId:s,depth:u,didItOwnerId:d,isManagedView:f,isORBACProfileManager:A,objectId:r,objectType:P.o.aggregatedComment,onUpdate:g,parentObjectId:_,pinDomainOwnerId:b,pinKey:null!=eE?{type:"Legacy",data:eE}:null,variant:"legacy"}),(0,c.jsx)(a.xH,{accessibilityLabel:k._('Comments loading', ' - ', ' -- '),show:Q})]}),el&&(0,c.jsx)(m,{accessibilityModalLabel:k._('Deleting a comment', 'closeup.deleteCommentModal.label', 'Label for deleting a comment'),cancelButtonText:k._('Cancel', 'closeup.deleteCommentModal.cancelButton', 'Cancel deleting comment'),confirmButtonText:k._('Delete', 'closeup.deleteCommentModal.confirmButton', 'Delete comment'),detail:k._('This comment will be deleted', 'closeup.deleteCommentModal.detailText', 'confirmation before deleting comment'),heading:k._('Are you sure?', 'closeup.deleteCommentModal.heading', 'Are you sure to remove post or comment'),onConfirm:function(){ez(G({aggregatedCommentId:r,aggregatedPinId:l,feedType:"aggregatedComments",type:e0?ef.Rv.REPLY_TO_AGGREGATED:ef.Rv.TOP,parentId:_,updateParentCommentCount:!0,pinId:x}))},onDismiss:to}),eA&&(0,c.jsx)(h.ZP,{accessibilityModalLabel:k._('Users who have liked this.', 'closeup.comment.showLikeListModal.label', 'Label for a modal showing a list of users who have liked a Tried Item Comment'),heading:(0,ey.Z)(k.ngettext('{{count}} Like', '{{count}} Likes', e1, 'closeup.comment.showLikeListModal.heading', 'Number of likes a comment has'),{count:e1.toString()}),onDismiss:to,size:"md",children:(0,c.jsx)(ed.Xd,{id:r})}),ek&&(0,c.jsx)(ex.default,{firstName:e$,onBlockUser:function(){ez((0,ej.Ge)({id:eJ,blockSource:"comment",blockContext:r,logContextEvent:I})),L(eJ),K(eJ),to(),T()},onClearModal:to})]})},eI=n(28427),eT=n(302148),ek=n(378888),eD=n(341742),ez=n(696323);function eE(e){return(eE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eM(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=eE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eE(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eE(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eM(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eL(e,t,n,r,o,i,l){try{var a=e[i](l),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function eU(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eZ(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eZ(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eH=2,eB=(void 0!==r||(r=n(297209)).hash&&"ba6cb3d83648d5a9f07e044db4a9cf58"!==r.hash&&console.error("The definition of 'AggregatedCommentListUnified_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),eF=function(e){var t,n,r,i,l=e.baseIndex,s=void 0===l?0:l,u=e.commentCount,d=e.creatorId,p=e.depth,h=void 0===p?0:p,m=e.didItOwnerId,g=e.feedItems,_=e.feedResourceName,b=e.initialLoadCount,x=e.isManagedView,w=e.objectId,O=e.objectType,C=e.onUpdate,S=e.parentObjectId,A=e.pinDomainOwnerId,I=e.pinKey,T=e.privatePin,k=e.shouldFeatureComment,D=void 0!==k&&k,z=e.variant,E=e.isORBACProfileManager,M=(0,v.u)().logContextEvent,R=(0,y.ZP)(),L=eU((0,o.useState)(!1),2),H=L[0],B=L[1],F=eU((0,o.useState)(!1),2),N=F[0],V=F[1],W=(0,j.Z)(),G=(0,et.K)(),X=(0,f.TH)(),K=(0,ek.mB)(X.search).comment_is_hidden,Y=1===parseInt(void 0===K?"0":K,10),q=(0,eg.dI)().showOneToast,J=(0,ec.Z)(),$=(0,eI.Z)(eB,I);(0,eD.Z)(function(){if(G&&Y&&D){var e=R._('Sorry, the comment has been hidden', 'AggregatedCommentList.featuredComment.isHidden', 'Error message for featured comment is unavailable');q(function(t){var n=t.hideToast;return(0,c.jsx)(ep.Z,{onHide:n,text:e})})}});var Q=(0,en.Z)({name:_,options:{objectId:w,page_size:b||2,redux_normalize_feed:!0,featured_ids:D&&G&&!Y?[G]:null}}),ee=Q.fetchMore,er=Q.isAtEnd,eo=Q.isLoaded,ei=null==$?void 0:$.entityId,el=$&&$.pinner?$.pinner.entityId:"",ea=!!$&&$.storyPinDataId,es=null!=(r=null==$||null==(i=$.aggregatedPinData)?void 0:i.entityId)?r:"";(0,o.useEffect)(function(){eo&&C&&C()},[eo,C]);var eu=function(){B(!H)},ed=(t=regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.contentMarkdown,r=t.tags,eu(),V(!0);try{J({objectType:O,objectId:w,pinId:ei,tags:r,text:n}),O===P.o.pin&&M({event_type:7,object_id_str:ei,aux_data:eR({num_user_mention_tags:(r?JSON.parse(r):[]).length},ea?{creator_id:d,story_pin_data_id:ea}:{})})}catch(e){}V(!1);case 5:case"end":return e.stop()}},e)}),n=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function l(e){eL(i,r,o,l,a,"next",e)}function a(e){eL(i,r,o,l,a,"throw",e)}l(void 0)})},function(e){return n.apply(this,arguments)}),ef=!!g&&eo&&u>g.length&&!er,eh=g?u-g.length:0,em=(0,eT.nk)(R.ngettext('{{commentCount}} comment', '{{commentCount}} comments', eh, 'Show comments link with count', 'Show comments link with count'),{commentCount:String(eh)}).join(""),ey=O===P.o.aggregatedComment,e_=O===P.o.pin&&(g&&0===g.length||0===u)&&eo&&!N,eb="default"===z,ev=0===h,ex=ev&&$&&$.highlightedAggregatedComments?$.highlightedAggregatedComments:[],ej=ev&&W.isAuth&&W.id===el,eP=ej;return(0,c.jsxs)(a.xu,{"data-test-id":"aggregated-comment-list",marginTop:ey&&!eb?2:0,paddingY:ey||eb?0:2,children:[!!ei&&ex.map(function(e,t){return(0,c.jsx)(a.xu,{marginBottom:2,children:(0,c.jsx)(eA,{aggregatedCommentId:e,apdId:es,canSetHighlight:ej,creatorId:d,depth:h+1,didItOwnerId:m,isManagedView:x,isORBACProfileManager:E,objectType:O,onUpdate:C,parentObjectId:O===P.o.pin?ei:w,pinDomainOwnerId:A,pinId:ei,slotIndex:s+t,viewerId:W.isAuth?W.id:""})},e)}),!!ei&&(null==g?void 0:g.filter(function(e){return!ex.includes(e.id)}).map(function(e,t){var n=e.id,r=eP;return eP=!1,(0,c.jsx)(a.xu,{marginBottom:2,children:(0,c.jsx)(eA,{aggregatedCommentId:n,apdId:es,canSetHighlight:ej,creatorId:d,depth:h+1,didItOwnerId:m,isManagedView:x,isORBACProfileManager:E,numHighlights:ex.length,objectType:O,onUpdate:C,parentObjectId:O===P.o.pin?ei:w,pinDomainOwnerId:A,pinId:ei,showHighlightEducator:r,slotIndex:s+ex.length+t,viewerId:W.isAuth?W.id:""})},n)})),(0,c.jsx)(a.xH,{accessibilityLabel:R._('Comments loading', ' - ', ' -- '),show:!eo||N}),ef&&(0,c.jsx)(a.xu,{marginTop:3,children:(0,c.jsx)(Z.Z,{handleClick:ee,text:em})}),e_&&(0,c.jsx)(a.xu,{paddingY:2*!eb,children:(0,c.jsx)(a.xv,{size:eb?"100":"200",children:R._('Share feedback, ask a question or give a high five', ' - ', ' -- ')})}),!E&&O!==P.o.aggregatedComment&&!x&&(0,c.jsx)(a.xu,{display:"flex",marginTop:6,children:(0,c.jsx)(a.xu,{"data-test-id":"add-comment",flex:"grow",children:(0,c.jsx)(U,{hideAddObjects:!0,objectType:O,onAddItem:ed,onCancelItem:eu,onEnter:eu,parentObjectId:S||"",privatePin:T,replyToObject:null,statusType:H?"textInflightCreation":"textStaticDisplay"})})})]})},eN=function(e){return(0,i.v9)(function(t){return t.feeds["".concat(ez.Z.AGGREGATED_COMMENTS,":").concat(e)]})},eV=function(e){var t;return(0,c.jsx)(eF,eR(eR({},e),{},{feedItems:null!=(t=eN(e.objectId))?t:[],feedResourceName:"AggregatedCommentReplyFeedResource"}))},eW=function(e){var t;return(0,c.jsx)(eF,eR(eR({},e),{},{feedItems:null!=(t=eN(e.objectId))?t:[],feedResourceName:"DidItCommentsResource"}))};function eG(e){var t=e.item.images,n=e.item.pin&&e.item.pin.title||"",r=t.length>0,o=t[0]?t[0]["750x"]:null;if(!r||!o)return null;var i=o.url;return(0,c.jsx)(a.zd,{rounding:2,wash:!0,children:(0,c.jsx)(a.Ee,{alt:n,color:"#efefef",naturalHeight:o.height,naturalWidth:o.width,src:i},i)})}var eX=n(389239),eK=n(599599);function eY(e){return(eY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eJ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eq(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=eY(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eY(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eY(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function e$(e){var t=(0,y.ZP)();return(0,c.jsx)(eK.Z,eJ(eJ({thriftComponentType:193},e),{},{children:function(e){var n=e.onTriedItButtonClick;return(0,c.jsx)(a.iP,{onTap:function(e){return n(e.event)},children:(0,c.jsx)(a.xu,{paddingX:2,paddingY:1,children:(0,c.jsx)(a.xv,{weight:"bold",children:t._('Save', 'comment save button', 'comment save button')})})})}}))}var eQ=n(197980),e0=n(166379),e1=n(679422),e2=n(686319),e8=n(611134),e6=n(896273),e3=n(777834);function e5(e){return(e5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e9(Object(n),!0).forEach(function(t){tr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e9(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function e7(e,t){return(e7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function te(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(tt=function(){return!!e})()}function tn(e){return(tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e,t,n){return(t=to(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function to(e){var t=function(e,t){if("object"!=e5(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=e5(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==e5(t)?t:t+""}var ti=function(e){var t=e.isLikedByMe,n=e.onClick,r=(0,y.ZP)(),o=(0,e1.Z)();return(0,c.jsx)(a.hU,{accessibilityLabel:r._('Like', ' - ', ' -- '),icon:"heart",iconColor:t?"red":"gray",onClick:function(){o?o():n()},size:"md"})},tl=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&e7(o,e);var t,n,r=(t=tt(),function(){var e,n=tn(o);return e=t?Reflect.construct(n,arguments,tn(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==e5(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return te(e)}(this,e)});function o(){if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var e,t,n=arguments.length,i=Array(n),l=0;l<n;l++)i[l]=arguments[l];return tr(te(t=r.call.apply(r,[this].concat(i))),"state",{isLikedByMe:null!=(e=t.props.item.liked_by_me)&&e,likeCount:t.props.item.like_count,showDeleteModal:!1,showEditModal:!1,showFlyout:!1,showLikesListModal:!1,showShareFlyout:!1,isDeleteHover:!1,isReportHover:!1}),tr(te(t),"handleClickthrough",function(){var e=t.props,n=e.handlePinClickLogging,r=e.logContextEvent,o=e.item.id;n&&n(),r({event_type:101,component:172,element:1263,object_id_str:o})}),tr(te(t),"handleClickHashTag",function(){var e=t.props;(0,e.logContextEvent)({event_type:101,component:172,element:10194,object_id_str:e.item.id})}),tr(te(t),"handleToggleLikesListModal",function(){return t.setState(function(e){return{showLikesListModal:!e.showLikesListModal}})}),tr(te(t),"handleClickLike",function(){var e=t.props,n=e.item.id,r=e.viewType,o=e.logContextEvent,i=t.state,l=i.isLikedByMe,a=i.likeCount;o({event_type:101,component:172,element:1353,object_id_str:n,view_type:r}),t.setState({isLikedByMe:!l,likeCount:l?a-1:a+1}),(0,e2.Z)({url:"/v3/did_it/".concat(n,"/like/"),method:l?"DELETE":"POST"})}),tr(te(t),"handleToggleFlyout",function(){return t.setState(function(e){return{showFlyout:!e.showFlyout,showShareFlyout:!1}})}),tr(te(t),"handleShowShareFlyout",function(){return t.setState({showShareFlyout:!0})}),tr(te(t),"handleDismissFlyout",function(){t.state.showEditModal||t.setState({showFlyout:!1,showShareFlyout:!1})}),tr(te(t),"handleShowReportModal",function(){var e,n=t.props,r=n.item,o=r.id,i=r.pin.aggregated_pin_data,l=n.removeReportedActivity;(0,n.reportComment)(o,null!=(e=null==i?void 0:i.id)?e:"","userdiditdata"),l&&l(o)}),tr(te(t),"handleShowDeleteModal",function(){return t.setState({showDeleteModal:!0})}),tr(te(t),"handleDeleteConfirmation",function(e){var n=t.props,r=n.item,o=r.id,i=r.pin,l=i.aggregated_pin_data,a=void 0===l?{}:l,s=i.id,c=r.user,u=n.deleteUserDidItData,d=n.logContextEvent;if(t.setState({showDeleteModal:!1}),e&&c){var f=c.username;d({event_type:101,view_type:101,component:192,element:1264,object_id_str:s}),u({aggregatedPinDataId:null==a?void 0:a.id,id:o,isOwnedByMe:t.isOwnedByCurrentUser,pinId:s,username:f})}}),tr(te(t),"handleToggleEditModal",function(e){return t.setState({showEditModal:e,showFlyout:e})}),tr(te(t),"handleClickHelpful",function(){var e=t.props,n=e.didItDataId,r=e.item.marked_helpful_by_me;(0,e.toggleHelpful)({didItDataId:n,isMarkedHelpfulByMe:!!r})}),tr(te(t),"handleDeleteMouseEnter",function(){return t.setState({isDeleteHover:!0})}),tr(te(t),"handleDeleteMouseLeave",function(){return t.setState({isDeleteHover:!1})}),tr(te(t),"handleReportMouseEnter",function(){return t.setState({isReportHover:!0})}),tr(te(t),"handleReportMouseLeave",function(){return t.setState({isReportHover:!1})}),tr(te(t),"renderFlyout",function(){var e,n,r,o=t.props,i=o.creatorId,l=o.item,s=l.details,u=l.id,d=l.images,f=l.pin,p=l.privacy,h=l.user,m=o.viewer,y=f||{},g=y.aggregated_pin_data,_=void 0===g?{}:g,b=y.id,v=y.images,x=y.link_domain,j=y.rich_metadata,P=y.title,w=t.state,O=w.showFlyout,C=w.showShareFlyout,S=((void 0===x?{}:x)||{}).official_user||{},A=((void 0===j?{}:j)||{}).title,I={description:s,id:u,imageUrl:d.length>0?null==d||null==(e=d[0])||null==(n=e["550x"])?void 0:n.url:null==(r=(void 0===v?{}:v)["136x136"])?void 0:r.url,name:A||t.props.i18n._('this idea', ' - ', ' -- '),type:e3.d.DID_IT,url:"/pin/".concat(b,"/activity/tried/").concat(u)},T=t.isOwnedByCurrentUser||m.isAuth&&m.id===S.id||m.isAuth&&m.id===i;return(0,c.jsxs)(a.xu,{children:[(0,c.jsx)(a.xu,{ref:function(e){t.flyoutAnchor=e},children:(0,c.jsx)(a.hU,{accessibilityExpanded:O,accessibilityHaspopup:!0,accessibilityLabel:t.props.i18n._('more options', 'accessible label for button to see more options on report content', 'accessible label for button to see more options on report content'),icon:"ellipsis",iconColor:"gray",onClick:t.handleToggleFlyout,size:"sm"})}),O&&(0,c.jsx)(a.mh,{children:(0,c.jsx)(a.xu,{alignSelf:"end",children:(0,c.jsx)(a.J2,{anchor:t.flyoutAnchor,idealDirection:"down",onDismiss:t.handleDismissFlyout,size:C?"lg":"xs",children:C?(0,c.jsx)(e6.Z,{component:56,onHide:t.handleToggleFlyout,sendType:"did_it",sharedObject:I,viewType:3}):(0,c.jsx)(a.xu,{alignSelf:"start",color:"default",column:12,display:"flex",position:"relative",rounding:2,children:(0,c.jsxs)(a.sg,{span:12,children:["public"===p&&(0,c.jsx)(a.xu,{children:(0,c.jsx)(a.iP,{onTap:t.handleShowShareFlyout,children:(0,c.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(a.xv,{weight:"bold",children:t.props.i18n._('Share', ' - ', ' -- ')})})})}),(0,c.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(a.rU,{href:t.pinURL,onClick:t.handleClickthrough,children:(0,c.jsx)(a.xv,{weight:"bold",children:t.props.i18n._('Go to Pin', ' - ', ' -- ')})},t.pinURL)}),h&&(t.isOwnedByCurrentUser||T)?(0,c.jsxs)(a.xu,{children:[t.isOwnedByCurrentUser&&(0,c.jsx)(a.kC,{alignItems:"stretch",justifyContent:"start",children:(0,c.jsx)(e$,{aggregatedPinDataId:null==_?void 0:_.id,isDoneByMe:t.isOwnedByCurrentUser,loggedInUser:h,onToggleModal:t.handleToggleEditModal,pinId:b,pinTitle:P,userDidItDataId:u})}),T&&(0,c.jsx)(a.iP,{onTap:t.handleShowDeleteModal,children:(0,c.jsx)(a.xu,{"data-test-id":"flyout-delete-button",display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(a.xv,{weight:"bold",children:t.props.i18n._('Delete', ' - ', ' -- ')})})})]}):(0,c.jsx)(a.iP,{onTap:t.handleShowReportModal,children:(0,c.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(a.xv,{weight:"bold",children:t.props.i18n._('Report this content', ' - ', ' -- ')})})})]})})})})})]})}),tr(te(t),"renderStatsBar",function(){var e=t.props,n=e.item,r=n.comment_count,o=n.done_at,i=n.marked_helpful_by_me,l=n.helpful_count,s=e.isManagedView,u=e.viewer,d=t.props.item.pin&&t.props.item.pin.link_domain||{},f=t.state,p=f.isLikedByMe,h=f.likeCount,m=f.isDeleteHover,y=f.isReportHover,g=(0,ey.Z)(t.props.i18n.ngettext('{{likeCount}} like', '{{likeCount}} likes', h, ' - ', ' -- '),{likeCount:h}),_=(0,ey.Z)(t.props.i18n.ngettext('{{commentCount}} comment', '{{commentCount}} comments', r, ' - ', ' -- '),{commentCount:r}),b=d.official_user||{},v=t.isOwnedByCurrentUser||u.isAuth&&u.id===b.id,x=t.props.getHumanizedTimeSince(o,!0);return(0,c.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",children:[(0,c.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,c.jsx)(a.xv,{size:"200",children:s?x:(0,c.jsx)(e0.Z,{dateFormatType:e0.k.LONG,useUTC:!1,value:new Date(o)})}),r>0&&(0,c.jsx)(a.xu,{marginStart:6,children:(0,c.jsx)(a.xv,{size:"200",weight:"bold",children:_})}),h>0&&(0,c.jsx)(a.xu,{"data-test-id":"did_it_show_likes_tap_area",marginStart:6,children:(0,c.jsx)(a.iP,{onTap:t.handleToggleLikesListModal,children:(0,c.jsx)(a.xv,{size:"200",weight:"bold",children:g})})})]}),(0,c.jsxs)(a.kC,{alignItems:"stretch",flex:"grow",justifyContent:"end",children:[(0,c.jsx)(a.xu,{display:"flex",justifyContent:h>0?"between":"end",marginBottom:1,marginTop:1,children:u.isAuth&&(0,c.jsx)(ti,{isLikedByMe:p,onClick:t.handleClickLike})}),(0,c.jsx)(a.xu,{display:"flex",paddingY:3,children:(0,c.jsx)(el.N,{helpfulCount:l,isMarkedHelpfulByMe:i,onHelpfulClick:t.handleClickHelpful})})]}),s&&(0,c.jsx)(a.kC,{alignItems:"stretch",flex:"none",children:(0,c.jsx)(a.iP,{onMouseEnter:t.handleReportMouseEnter,onMouseLeave:t.handleReportMouseLeave,onTap:t.handleShowReportModal,rounding:"pill",children:(0,c.jsx)(a.xu,{padding:2,children:(0,c.jsx)(a.xv,{color:y?"default":"subtle",size:"200",weight:"bold",children:t.props.i18n._('Report', ' - ', ' -- ')})})})}),s&&v&&(0,c.jsx)(a.kC,{alignItems:"stretch",flex:"none",children:(0,c.jsx)(a.iP,{onMouseEnter:t.handleDeleteMouseEnter,onMouseLeave:t.handleDeleteMouseLeave,onTap:t.handleShowDeleteModal,rounding:"pill",children:(0,c.jsx)(a.xu,{padding:2,children:(0,c.jsx)(a.xv,{color:m?"default":"subtle",size:"200",weight:"bold",children:t.props.i18n._('Delete', ' - ', ' -- ')})})})})]})}),tr(te(t),"renderPinInfoBar",function(){var e,n,r=t.props,o=r.item,i=o.images,l=o.pin,s=o.user,u=r.isManagedView,d=(s||{}).full_name,f=l.dominant_color,p=l.images,h=void 0===p?{}:p,m=l.rich_metadata,y=l.title,g=((void 0===m?{}:m)||{}).title;return n=t.isOwnedByCurrentUser&&g?(0,eT.nk)(t.props.i18n._('You tried {{pinTitleForTriedByText}}', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'),{pinTitleForTriedByText:g}):g?(0,eT.nk)(t.props.i18n._('{{fullName}} tried {{pinTitleForTriedByText}}', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'),{fullName:d,pinTitleForTriedByText:g}):t.isOwnedByCurrentUser?t.props.i18n._('See the Pin you tried', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'):t.props.i18n._('See the Pin that inspired it', 'call to action - navigating to a Pin from a try', 'call to action - navigating to a Pin from a try'),(0,c.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:i.length?{backgroundImage:"linear-gradient(to bottom, rgba(118, 118, 118, 0), rgba(0, 0, 0, 0.2) 33%, rgba(0, 0, 0, 0.5) 66%, rgba(0, 0, 0, 0.7))"}:{}},rounding:2*!!i.length,children:(0,c.jsx)(a.Tg,{href:t.pinURL,onTap:t.handleClickthrough,children:(0,c.jsxs)(a.xu,{alignItems:"center",display:"flex",paddingX:3*!!i.length,paddingY:3,children:[(0,c.jsxs)(a.xu,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"start",marginEnd:2,children:[(0,c.jsx)(a.xu,{marginEnd:3,width:60,children:(0,c.jsx)(a.zd,{rounding:2,wash:!0,children:(null==(e=h["136x136"])?void 0:e.url)&&(0,c.jsx)(a.Ee,{alt:null!=y?y:"",color:null!=f?f:"transparent",naturalHeight:60,naturalWidth:60,src:h["136x136"].url})})}),(0,c.jsxs)(a.xv,{color:i.length?"inverse":"default",size:u?"100":"300",weight:"bold",children:[" ",n," "]})]}),(0,c.jsx)(a.JO,{accessibilityLabel:t.props.i18n._('See pin', ' - ', ' -- '),color:i.length?"inverse":"default",icon:"arrow-forward",size:32})]})},t.pinURL)})}),t}return n=[{key:"isOwnedByCurrentUser",get:function(){var e=this.props,t=e.viewer,n=e.item;return!!(t.isAuth&&n.user&&t.id===n.user.id)}},{key:"pinURL",get:function(){return"/pin/".concat(this.props.item.pin.id,"/")}},{key:"render",value:function(){var e,t,n,r=this.props,o=r.creatorId,i=r.isManagedView,l=r.item,s=r.viewType,u=this.state,f=u.likeCount,p=u.showDeleteModal,m=u.showLikesListModal,y=l.comment_count,g=l.details,_=l.id,b=l.images,v=l.pin,x=l.user,j=l.videos,w=x||{},O=w.full_name,C=w.id,S=w.image_medium_url,A=w.username,I="/".concat(A,"/");(0,ey.Z)(this.props.i18n.ngettext('{{likeCount}} like', '{{likeCount}} likes', f, ' - ', ' -- '),{likeCount:f}),(0,ey.Z)(this.props.i18n.ngettext('{{commentCount}} comment', '{{commentCount}} comments', y, ' - ', ' -- '),{commentCount:y});var T=!!(null!=j&&null!=(e=j[0])&&null!=(t=e.video_list)&&t.V_HLSV4),k=!!(null!=(n=b[0])&&n["750x"]),D=k||T,z=82!==s,E=k&&z;return(0,c.jsxs)(a.xu,{alignItems:"stretch",direction:"column",display:"flex",justifyContent:"between",paddingY:7,children:[(0,c.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",children:[(0,c.jsx)(a.kC,{alignItems:"center",children:(0,c.jsx)(a.xu,{marginEnd:3,width:i?36:42,children:(0,c.jsx)(a.Tg,{href:I,onTap:this.handleClickthrough,rounding:"circle",children:(0,c.jsx)(a.zd,{rounding:"circle",wash:!0,children:S&&(0,c.jsx)(a.Ee,{alt:null!=A?A:"",color:"#efefef",naturalHeight:42,naturalWidth:42,src:S},S)})},I)})}),(0,c.jsx)(a.xu,{column:1,display:"flex",mdDisplay:"none"}),(0,c.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",justifyContent:"between",children:[(0,c.jsx)(a.xv,{size:i?"200":"300",children:(0,c.jsx)(a.rU,{href:I,onClick:this.handleClickthrough,children:O||""},I)}),!i&&this.renderFlyout()]})]}),(0,c.jsx)(a.xu,{marginBottom:+!i,marginTop:2,children:D&&(0,c.jsxs)(a.xu,{column:12,position:"relative",children:[T?(0,c.jsx)(eX.Z,{item:l,viewType:s}):(0,c.jsx)(eG,{item:l}),E&&(0,c.jsx)(a.xu,{bottom:!0,column:12,position:"absolute",children:this.renderPinInfoBar()})]})}),(0,c.jsxs)(a.xu,{marginStart:1,children:[k&&this.renderStatsBar(),g&&(0,c.jsx)(a.xu,{column:10,dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-line"}},marginBottom:2,children:(0,c.jsx)(a.xv,{size:i?"100":"300",children:(0,c.jsx)(d,{html:g,onClick:this.handleClickHashTag})})}),!k&&(0,c.jsxs)(a.xu,{children:[z&&this.renderPinInfoBar(),this.renderStatsBar()]}),(0,c.jsx)(a.xu,{column:12,children:(0,c.jsx)(eW,{commentCount:y,creatorId:o,didItOwnerId:C,objectId:_,objectType:P.o.didIt,pinKey:{type:"Legacy",data:v},variant:"legacy"})})]}),p&&(0,c.jsx)(eQ.Z,{didItData:{id:_},onDeleteConfirmation:this.handleDeleteConfirmation}),m&&(0,c.jsx)(h.ZP,{accessibilityModalLabel:this.props.i18n._('Users who have liked this.', 'Label for a modal showing a list of users who have liked a Tried Item', 'Label for a modal showing a list of users who have liked a Tried Item'),allowScroll:!0,heading:(0,ey.Z)(this.props.i18n.ngettext('{{count}} Like', '{{count}} Likes', f, ' - ', ' -- '),{count:f.toString()}),onDismiss:this.handleToggleLikesListModal,size:"md",children:(0,c.jsx)(ed.Jo,{id:_})})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,to(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.PureComponent);function ta(e){var t=(0,v.u)().logContextEvent,n=(0,y.ZP)(),r=(0,Q.Z)(),o=(0,i.I0)(),a=(0,ew.Z)().reportComment,s=(0,j.Z)(),u={deleteUserDidItData:(0,l.bindActionCreators)(e8.lg,o),toggleHelpful:(0,l.bindActionCreators)(e8.YH,o),updateUserDidItDataCommentCount:(0,l.bindActionCreators)(e8.L8,o)},d=(0,i.v9)(function(t){return t.didItData[e.didItDataId]}),f=d&&"comment_count"in d?d:void 0;return f&&(0,c.jsx)(tl,e4(e4(e4({},e),u),{},{getHumanizedTimeSince:r,i18n:n,item:f,logContextEvent:t,reportComment:a,viewer:s}))}},37739:function(e,t,n){n.d(t,{Jo:function(){return w},Xd:function(){return P}});var r=n(586659),o=n(20256),i=n(821342),l=n(19585),a=n(886981),s=n(2929),c=n(159527),u=n(689676),d=n(793698),f=n(382718);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_=function(){return!!e})()}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=p(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:t+""}var j=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&y(i,e);var t,n,r=(t=_(),function(){var e,n=b(i);return e=t?Reflect.construct(n,arguments,b(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return g(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return v(g(e=r.call.apply(r,[this].concat(n))),"setRef",function(t){t&&!e.list&&(e.list=t.parentElement,e.list&&e.list.addEventListener("scroll",e.handleScroll))}),v(g(e),"fetchMore",function(){var t=e.props.feedResource;t.isFetching||(t.isAtEnd?window.removeEventListener("scroll",e.handleScroll):t.fetchMore())}),v(g(e),"handleScroll",(0,c.Z)(function(){var t=e.props.feedResource;if(!t.isFetching&&!t.isAtEnd){var n=(0,s.Uy)(e.list);(0,s.aZ)(e.list)-(0,s.MX)(e.list)-50<n&&e.fetchMore()}},10)),e}return n=[{key:"componentWillUnmount",value:function(){var e;null==(e=this.list)||e.removeEventListener("scroll",this.handleScroll)}},{key:"render",value:function(){var e=this.props,t=e.feedResource,n=t.data,r=t.isLoaded,i=e.users,l=e.viewer;if(!r)return(0,f.jsx)(o.xH,{accessibilityLabel:this.props.i18n._('Loading spinner for like list', 'Accessibility label for loading spinner for like list', 'Accessibility label for loading spinner for like list'),show:!0});var a=n&&n.map(function(e){return e.id?m(m({},e),i[e.id]):e});return(0,f.jsx)(o.xu,{ref:this.setRef,"data-test-id":"liked-by-list",maxHeight:400,children:a&&a.map(function(e){return(0,f.jsx)(o.xu,{paddingX:4,paddingY:3,children:(0,f.jsx)(u.Z,{isSelf:!!(l.isAuth&&l.id&&e.id===l.id),user:e})},e.id)})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.Component);function P(e){var t=(0,l.ZP)(),n=(0,i.Z)(),r=(0,d.dM)(),o=(0,a.Z)({name:"AggregatedCommentLikedByResource",options:{aggregatedCommentId:e.id},noCache:!0});return(0,f.jsx)(j,m(m({},e),{},{feedResource:o,i18n:t,users:r,viewer:n}))}function w(e){var t=(0,l.ZP)(),n=(0,i.Z)(),r=(0,d.dM)(),o=(0,a.Z)({name:"DidItLikedByResource",options:{didItDataId:e.id},noCache:!0});return(0,f.jsx)(j,m(m({},e),{},{feedResource:o,i18n:t,users:r,viewer:n}))}},389239:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(586659),o=n(20256),i=n(293565),l=n(19585),a=n(15667),s=n(720445),c=n(382718);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var b=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&p(l,e);var t,n,r=(t=m(),function(){var e,n=y(l);return e=t?Reflect.construct(n,arguments,y(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return g(h(e=r.call.apply(r,[this].concat(n))),"state",{isFullscreen:!1,isPlaying:!1,showControls:!0,volumeLevel:0}),g(h(e),"handleTouch",function(t){t.event.stopPropagation(),e.setState(function(e){return{isPlaying:!e.isPlaying}})}),g(h(e),"handleShowControls",function(){return e.setState({showControls:!0})}),g(h(e),"handleHideControls",function(){return e.setState({showControls:!1})}),g(h(e),"handleEnded",function(t){t.event.stopPropagation(),e.setState({isPlaying:!1})}),g(h(e),"handlePause",function(t){t.event.stopPropagation(),e.setState({isPlaying:!1})}),g(h(e),"handlePlay",function(t){t.event.stopPropagation(),e.setState({isPlaying:!0})}),g(h(e),"handleToggleFullscreen",function(t){var n=t.event,r=t.fullscreen;n.stopPropagation(),e.setState({isFullscreen:r})}),g(h(e),"handleVolumeChange",function(t){var n=t.event,r=t.volume;n.stopPropagation(),e.setState({volumeLevel:r})}),e}return n=[{key:"render",value:function(){var e=this.props,t=e.item,n=e.requestContext,r=e.viewType,l=t.videos,a=null==l?void 0:l[0];if(!a)return null;var u=this.state,d=u.showControls,f=u.isFullscreen,p=u.isPlaying,h=u.volumeLevel,m=a.video_list.V_HLSV4;if(!m)return null;var y=m||{},g=y.height,_=y.width,b=y.thumbnail,v=y.url;return(0,c.jsx)(o.iP,{dataTestId:"tried-it-video",onMouseEnter:this.handleShowControls,onMouseLeave:this.handleHideControls,onTap:this.handleTouch,rounding:2,children:(0,c.jsx)(o.zd,{rounding:2,wash:!0,willChangeTransform:!((0,i.G6)(n.userAgent.browserName)&&f),children:(0,c.jsx)(s.ZP,{aspectRatio:Math.max((null!=_?_:1)/(null!=g?g:1),1),backgroundColor:"transparent",captions:"",contextLogData:{view:r,viewParameter:3071,component:172,objectId:t.id,video_id:a.id},controls:d,isAutoPlay:!1,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleToggleFullscreen,onPlay:function(){},onPlayError:function(){},onVolumeChange:this.handleVolumeChange,pinKey:null,playbackRate:1,playing:p,poster:b,preload:"auto",src:[{type:"video/m3u8",src:null!=v?v:""}],volume:h})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component);function v(e){var t=(0,l.ZP)(),n=(0,a.B)();return(0,c.jsx)(b,f(f({},e),{},{i18n:t,requestContext:n}))}},166379:function(e,t,n){n.d(t,{k:function(){return r.kH}});var r=n(654937),o=n(15667);t.Z=function(e){var t=e.dateFormatType,n=e.useUTC,i=e.value,l=(0,o.B)();return(0,r.ZP)(l.locale,i,t,void 0===n||n)}},460584:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t=!1;return{promise:new Promise(function(n,r){e.then(function(e){return t?r({isCanceled:!0}):n(e)},function(e){return t?r({isCanceled:!0}):r(e)})}),cancel:function(){t=!0}}}},526435:function(e,t,n){n.d(t,{$4:function(){return T},A7:function(){return M},AQ:function(){return G},Bj:function(){return _},DB:function(){return X},FM:function(){return Q},G9:function(){return L},GX:function(){return y},Hy:function(){return eu},JO:function(){return D},Ke:function(){return k},LM:function(){return o},Lc:function(){return ef},Lr:function(){return ec},MN:function(){return v},Mn:function(){return ee},N8:function(){return g},NB:function(){return en},P0:function(){return er},P9:function(){return ea},Pn:function(){return x},S:function(){return z},TK:function(){return P},TZ:function(){return S},UU:function(){return d},Uw:function(){return J},W_:function(){return es},XB:function(){return s},Xy:function(){return A},YM:function(){return w},aD:function(){return ep},aj:function(){return F},bA:function(){return R},bo:function(){return c},cH:function(){return eg},dS:function(){return C},eZ:function(){return h},fk:function(){return ei},g1:function(){return ed},gU:function(){return u},hH:function(){return H},i2:function(){return f},iR:function(){return U},jh:function(){return eh},km:function(){return p},lx:function(){return E},mr:function(){return K},mt:function(){return W},n_:function(){return B},np:function(){return V},of:function(){return r},q:function(){return ey},qY:function(){return O},qm:function(){return el},rc:function(){return $},ro:function(){return em},sD:function(){return l},sG:function(){return m},u1:function(){return q},uR:function(){return a},v5:function(){return i},v9:function(){return Y},vk:function(){return et},wj:function(){return j},x1:function(){return Z},yC:function(){return b},yI:function(){return I},yb:function(){return N},zr:function(){return eo}});var r=880,o=340,i=380,l=510,a=40,s=20,c=4,u=474,d=134,f=96,p=800,h=186,m=40,y=10,g=48,_=88,b=183,v=130,x=24,j=400,P=50,w=8,O=8,C=5,S=29,A=5,I=20,T=400,k=100,D=800,z=800,E=500,M=3e3,R=40,L=100,U=5,Z=["attempted","publishing","succeeded","uploading"],H={carousel:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],single:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],story:[{w:9,h:16}],storyFARPortrait:[{w:1,h:2},{w:9,h:16},{w:2,h:3},{w:3,h:4},{w:4,h:5},{w:1,h:1}],storyFARLandscape:[{w:2,h:1},{w:16,h:9},{w:3,h:2},{w:4,h:3},{w:5,h:4},{w:1,h:1}]},B=["tl","tc","tr","bl","bc","br"],F=["left","center"],N=["top","center","bottom"],V=["none","uppercase"],W=["sm","md","lg"],G=[1,.75],X=198,K=132,Y=1,q=56,J=240,$="cubic-bezier(0.66, 0.025, 0.33, 0.975)",Q=1e3,ee=1500,et=2,en=3,er=20,eo=20,ei=2,el=["creating","processing","publishing","saving"],ea=300.5,es=4,ec=0xc800000,eu=2500,ed=3,ef="pin-builder-default-education-id",ep="pin-builder-default-tour-id",eh="pin-builder-editing-tour-id",em="save_from_url",ey=["processing","edited","creating","saving","saved"],eg=2048},538688:function(e,t,n){var r=n(586659);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=null,l=!1,a=0,s=function(){i&&clearTimeout(i),l=!0,i=setTimeout(function(){l=!1},100)},c=function(){0===a&&window.addEventListener("scroll",s),a+=1},u=function(){(a-=1)||window.removeEventListener("scroll",s)};t.Z=function(){var e,t=function(e){if(Array.isArray(e))return e}(e=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,2):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=t[0],i=t[1],a=(0,r.useRef)(null);(0,r.useEffect)(function(){return c(),function(){a.current&&clearTimeout(a.current),u()}},[]);var s=function e(t){a.current&&clearTimeout(a.current),a.current=t&&l?setTimeout(function(){return e(!0)},100):setTimeout(function(){i(t)},32)};return{isHovering:n,hoverHandlers:(0,r.useRef)({onMouseOver:function(){return s(!0)},onMouseLeave:function(){return s(!1)}}).current}}},796765:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(586659),o=n(460584);function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(){var e=(0,r.useRef)([]),t=(0,r.useRef)({});return(0,r.useEffect)(function(){return function(){[].concat(i(Object.keys(t.current).map(function(e){return t.current[e]})),i(e.current)).forEach(function(e){return e()})}},[]),function(n,r){if(r){var l=t.current[r];l&&(l(),delete t.current[r])}var a=(0,o.Z)(n),s=a.cancel,c=a.promise;return r?t.current[r]=s:e.current=[].concat(i(e.current),[s]),c}}},218119:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(20256),o=n(19585),i=n(382718);function l(){var e=(0,o.ZP)();return(0,i.jsx)(r.kC,{alignItems:"center",justifyContent:"center",children:(0,i.jsx)(r.xH,{accessibilityLabel:e._('Loading editor', 'EditorWithMentionsFallback.loading', 'Message shown while waiting for the editor to load'),show:!0})})}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u=(0,n(78762).Z)(function(){return Promise.all([n.e("52949"),n.e("96310")]).then(n.bind(n,493123))},void 0,function(e){return 493123},"app-www-EditorWithMentions-EditorWithMentionsInternal",function(e){return ["52949","96310"]});function d(e){return(0,i.jsx)(u,c(c({},e),{},{fallback:(0,i.jsx)(l,{})}))}},838013:function(e,t,n){n.d(t,{N:function(){return s},Z:function(){return u}});var r=n(20256),o=n(19585),i=n(302148),l=n(473728),a=n(382718);function s(e){var t=(0,o.ZP)(),n=e.helpfulCount,l=e.isMarkedHelpfulByMe,s=e.onHelpfulClick,c=t._('Helpful', 'Comments marked helpful text.', 'Comments marked helpful text.'),u=(0,i.nk)(t._('Helpful {{helpfulCount}}', 'Comments marked helpful count text.', 'Comments marked helpful count text.'),{helpfulCount:n||0});return(0,a.jsx)(r.kC,{alignItems:"center",dataTestId:"helpful-button",justifyContent:"center",children:(0,a.jsx)(r.iP,{onTap:s,rounding:2,children:(0,a.jsxs)(r.kC,{alignItems:"center",justifyContent:"start",children:[(0,a.jsx)(r.JO,{accessibilityLabel:"helpful icon",color:l?"brandPrimary":"subtle",icon:"thumbs-up",size:16}),(0,a.jsx)(r.xu,{paddingX:1,children:(0,a.jsx)(r.xv,{color:"subtle",size:"100",weight:"bold",children:void 0!==n&&n>0?u:c})})]})})})}function c(e){var t=e.likeCount,n=e.isLikedByMe,o=e.onLikeClick;return(0,a.jsx)(r.kC,{alignItems:"center",justifyContent:"center",children:(0,a.jsx)(r.iP,{onTap:o,rounding:2,children:(0,a.jsxs)(r.xu,{"data-test-id":"reactions-likeWithCountButton",display:"flex",children:[(0,a.jsx)(r.JO,{accessibilityLabel:"like icon",color:n?"brandPrimary":"subtle",icon:"heart",size:16}),t>0&&(0,a.jsx)(r.xu,{"data-test-id":"reactions-likeCount",paddingX:1,children:(0,a.jsx)(r.xv,{color:"subtle",size:"100",weight:"bold",children:t})})]})})})}function u(e){var t=(0,o.ZP)(),n=e.commentCount,i=void 0===n?0:n,u=e.reactionCounts,d=e.hideReplyCount,f=e.isLikedByMe,p=e.onLikeClick,h=e.onReplyClick,m=e.onReplyCountClick,y=e.isMarkedHelpfulByMe,g=e.onHelpfulClick,_=e.helpfulCount,b=e.flyout,v=e.small,x=(void 0===u?{}:u)[1]||0,j=!!i&&(0,l.Z)(t.ngettext('{{commentCount}} reply', '{{commentCount}} replies', i, ' - ', ' -- '),{commentCount:i}),P=v?1:2;return(0,a.jsxs)(r.kC,{alignItems:"center",children:[(0,a.jsxs)(r.xu,{display:"flex",marginEnd:-P,marginStart:-P,children:[(0,a.jsx)(c,{isLikedByMe:void 0!==f&&f,likeCount:x,onLikeClick:p}),(0,a.jsx)(r.xu,{paddingX:P,children:(0,a.jsx)(r.xu,{"data-test-id":"reactions-reply",children:(0,a.jsx)(r.hU,{accessibilityLabel:"Reply",bgColor:"transparent",icon:"speech",iconColor:"gray",onClick:h,size:v?"sm":"md"})})}),!!b&&(0,a.jsx)(r.xu,{paddingX:P,children:b})]}),(0,a.jsxs)(r.xu,{display:"flex",flex:"grow",justifyContent:"end",marginEnd:-3,marginStart:-3,children:[!!j&&!d&&(0,a.jsx)(r.xu,{"data-test-id":"reactions-reply-count",children:(0,a.jsx)(r.xu,{paddingX:3,children:m?(0,a.jsx)(r.iP,{dataTestId:"reactions-reply-count-tap",onTap:m,rounding:2,children:(0,a.jsx)(r.xv,{color:"subtle",size:"200",weight:"bold",children:j})}):(0,a.jsx)(r.xv,{color:"subtle",size:"200",weight:"bold",children:j})})}),(0,a.jsx)(s,{helpfulCount:_,isMarkedHelpfulByMe:y,onHelpfulClick:g})]})]})}},689676:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(586659),o=n(581722),i=n(20256),l=n(744862),a=n(19585),s=n(302148),c=n(38817),u=n(683532),d=n(676244),f=n(149728),p=n(382718);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=e.isSelf,n=e.showVerified,m=e.user,y=void 0===m?{}:m,g=e.onFollowChange,_=h((0,r.useState)(y.explicitly_followed_by_me||!1),2),b=_[0],v=_[1],x=h((0,r.useState)(!1),2),j=x[0],P=x[1],w=(0,o.I0)(),O=(0,a.ZP)(),C=function(){P(!1),w((0,d.fv)(y.id)),v(!1),g&&g(y,!1)},S=y.verified_identity,A=y.full_name,I=y.is_verified_merchant,T=y.is_private_profile,k=y.explicitly_followed_by_me,D=y.username,z=null==S?void 0:S.verified,E=y.image_medium_url||y.image_small_url;return(0,p.jsxs)(i.xu,{alignItems:"center","aria-label":O._('User card', 'FollowersModal.User.card', 'Card for display user follower'),direction:"row",display:"flex",marginEnd:-1,marginStart:-1,paddingY:1,role:"group",children:[j&&(0,p.jsx)(u.Z,{firstName:null!=A?A:"",handleUnfollowUser:C,onDismiss:function(){P(!1)}}),(0,p.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{wordBreak:"break-word"}},flex:"grow",paddingX:1,children:(0,p.jsx)(i.Tg,{href:"/".concat(D,"/"),children:(0,p.jsxs)(i.kC,{alignItems:"center",gap:{row:2,column:0},justifyContent:"start",children:[(0,p.jsx)(i.xu,{width:50,children:(0,p.jsx)(l.qE,{accessibilityLabel:O._('User profile picture', 'FollowersModal.User.profilePicture', 'accessibility label for avatar main profile picture'),color:null==y?void 0:y.avatar_color_index,name:(0,s.nk)(O._('Avatar for {{ fullName }}', 'avatar.name', 'avatar for user'),{fullName:A}).join(" "),size:"fit",src:null!=E?E:""})}),(0,p.jsx)(i.X6,{accessibilityLevel:3,size:"300",children:(0,p.jsx)(i.xv,{inline:!0,lineClamp:3,size:"300",weight:"bold",children:void 0!==n&&n&&(I||z)?(0,p.jsx)(f.Z,{badgeSize:"sm",badgeSpacing:2,fullName:null!=A?A:"",isVerifiedIdentity:z,isVerifiedMerchant:I}):A})}),T&&(0,p.jsx)(i.xu,{children:(0,p.jsx)(i.JO,{accessibilityLabel:O._('private icon', 'privateProfileHeaderAuthDesktop.privateIcon', 'private icon'),icon:"lock",inline:!0})})]})})}),(0,p.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"nowrap"}},paddingX:1,children:(!T||k)&&(0,p.jsx)(c.Z,{followEventType:45,id:y.id,isFollowed:b,isUserMe:!!t,onFollow:function(e){w((0,d.ZN)(e)),v(!0),g&&g(y,!0)},onUnfollow:function(){T?P(!0):C()},pinKey:null,textType:"FollowUnfollow",unfollowEventType:46,viewType:4})})]})}},683532:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(20256),o=n(982166),i=n(19585),l=n(302148),a=n(647709),s=n(382718);function c(e){var t=e.onDismiss,n=e.firstName,c=e.handleUnfollowUser,u=(0,i.ZP)(),d=(0,a.HG)(),f=(0,l.nk)(u._('Unfollow {{ firstName }}?', 'unfollowUser.modal.header', 'header text asking if we should unfollow the user. firstName: name of the user to unfollow'),{firstName:n}).join(""),p=u._('You will no longer be able to view their profile, Pins, boards, followers or following lists. They will not be notified.', 'unFollowUser.modal.description', 'explanation of what removing another user means'),h=u._('Cancel', 'unfollowUser.modal.cancel', 'Cancel unfollowing a user'),m=u._('Unfollow', 'unfollowUser.modal.button.unfollow', 'Button to confirm removing a user');return d?(0,s.jsx)(o.ZP,{accessibilityModalLabel:f,footer:(0,s.jsxs)(r.xu,{alignItems:"center",display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,s.jsx)(r.xu,{padding:1,children:(0,s.jsx)(r.zx,{fullWidth:!0,onClick:t,size:"lg",text:h})}),(0,s.jsx)(r.xu,{padding:1,children:(0,s.jsx)(r.zx,{color:"red",fullWidth:!0,onClick:c,size:"lg",text:m})})]}),heading:f,onDismiss:t,role:"alertdialog",size:"md",children:(0,s.jsx)(r.xu,{"data-test-id":"unfollow-text",marginEnd:6,marginStart:6,children:(0,s.jsx)(r.xv,{children:p})})}):(0,s.jsxs)(o.ZP,{accessibilityModalLabel:f,mobileHideCloseIcon:!0,onDismiss:t,type:"unFollow_button",children:[(0,s.jsx)(r.xu,{alignItems:"center",display:"flex",paddingX:3,paddingY:5,children:(0,s.jsx)(r.X6,{accessibilityLevel:1,size:"600",children:f})}),(0,s.jsx)(r.xu,{marginBottom:4,marginEnd:4,marginStart:4,children:(0,s.jsx)(r.xv,{children:p})}),(0,s.jsxs)(r.xu,{alignItems:"center",display:"flex",justifyContent:"center",marginBottom:8,children:[(0,s.jsx)(r.xu,{padding:1,children:(0,s.jsx)(r.zx,{fullWidth:!0,onClick:t,size:"md",text:h})}),(0,s.jsx)(r.xu,{padding:1,children:(0,s.jsx)(r.zx,{color:"red",fullWidth:!0,onClick:c,size:"md",text:m})})]})]})}},733526:function(e,t,n){n.d(t,{MM:function(){return l},Y8:function(){return i},bl:function(){return a},qj:function(){return s}});var r=n(302148),o=n(526435);function i(e,t){return e?t._('Title too long. Make sure all cards\' titles have less than 100 characters', 'Title entered is too long while editing a carousel pin and/or one of its pins', 'Title entered is too long while editing a carousel pin and/or one of its pins'):t._('Title too long. Make sure title has less than 100 characters', 'Title entered is too long while editing a pin', 'Title entered is too long while editing a pin')}function l(e,t){return e?t._('Description too long. Make sure all cards\' descriptions have less than 500 characters', 'Description entered is too long while editing a carousel pin and/or one of its pins', 'Description entered is too long while editing a carousel pin and/or one of its pins'):(0,r.nk)(t._('Description too long. Make sure description has less than {{ limit }} characters', 'editPinModal.errorMessages.descriptionError', 'Description entered is too long while editing a pin. limit: the maximum number of characters allowed'),{limit:o.JO}).join("")}function a(e,t){return t._('Too many mentions. Make sure you have at most 5.', 'editPinModal.errorMessages.userMentionOverLimit', 'Too many mentions used in the description')}function s(e,t){return e?t._('Need to provide a valid URL. Make sure all cards\' links are valid', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins'):t._('Need to provide a valid URL. Make sure the link is valid', 'Invalid URL/link provided while editing a pin', 'Invalid URL/link provided while editing a pin')}},867215:function(e,t,n){n.d(t,{Z:function(){return j}});var r=n(586659),o=n(20256),i=n(686319),l=n(19585),a=n(709311),s=n(302148),c=n(765533),u=n(796765),d=n(382718);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){b(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var x=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&m(l,e);var t,n,r=(t=g(),function(){var e,n=_(l);return e=t?Reflect.construct(n,arguments,_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return y(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return b(y(e=r.call.apply(r,[this].concat(n))),"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),b(y(e),"onDismiss",function(){}),b(y(e),"mounted",!1),b(y(e),"addHashtag",function(t){e.props.addHashtag(t),e.setState({recommendations:[]})}),b(y(e),"handleKeyDown",function(t){t.keyCode===c.Z.UP?e.handlePrevHashtag(t):t.keyCode===c.Z.DOWN?e.handleNextHashtag(t):t.keyCode===c.Z.ESCAPE?e.handleClose(t):t.keyCode===c.Z.ENTER&&e.handleSubmit(t)}),b(y(e),"handlePrevHashtag",function(t){t.preventDefault(),e.state.selectedIndex>0&&e.setState(function(e){return{selectedIndex:e.selectedIndex-1}})}),b(y(e),"handleNextHashtag",function(t){t.preventDefault(),e.state.selectedIndex<e.state.recommendations.length-1&&e.setState(function(e){return{selectedIndex:e.selectedIndex+1}})}),b(y(e),"handleClose",function(t){t.preventDefault(),e.setState({recommendations:[]})}),b(y(e),"handleSubmit",function(t){t.preventDefault(),e.addHashtag(e.state.recommendations[e.state.selectedIndex].query)}),b(y(e),"callResource",function(t){(0,e.props.makeCancelablePromise)((0,i.Z)({url:"/v3/search/autocomplete/",data:{q:t,show_pin_count:!0}}),"typeahead").then(function(t){if(e.mounted){var n=t.resource_response.data;e.setState({recommendations:n.slice(0,5),resourceLoaded:!0})}}).catch(function(t){t.isCanceled||e.setState({resourceLoaded:!1})})}),e}return n=[{key:"componentDidMount",value:function(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e){this.props.query!==e.query&&""!==this.props.query&&this.callResource(this.props.query)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.recommendations,r=t.resourceLoaded,i=t.selectedIndex,l=this.props,c=l.anchor,u=l.idealDirection,f=n.filter(function(e){return e.query}),p="flyout_"+f.length;return r&&f.length>0?(0,d.jsx)(o.J2,{anchor:c,idealDirection:u||"down",onDismiss:this.onDismiss,size:"sm",children:(0,d.jsx)(o.xu,{width:"100%",zIndex:new o.Ry(3),children:f.length>0?f.map(function(t,n){return(0,d.jsx)(o.iP,{fullWidth:!1,onTap:function(){return e.addHashtag(t.query)},children:(0,d.jsxs)(o.xu,{alignItems:"center",color:n===i?"secondary":"transparent",display:"flex",justifyContent:"between",padding:1,children:[(0,d.jsx)(o.xu,{flex:"grow",children:(0,d.jsx)(o.xv,{inline:!0,size:"200",weight:"bold",children:t.query})}),(0,d.jsx)(o.xu,{flex:"none",children:(0,d.jsx)(o.xv,{inline:!0,size:"100",children:(0,s.nk)(e.props.i18n.ngettext('{{ count }} pin', '{{ count }} pins', Number(t.pin_count), 'label for n pins in hashtag flyout', 'label for n pins in hashtag flyout'),{count:(0,d.jsx)(a.Z,{value:Number(t.pin_count)},"pinCount")})})})]})},t.query)}):null})},p):null}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component);function j(e){var t=(0,l.ZP)(),n=(0,u.Z)();return(0,d.jsx)(x,h(h({},e),{},{i18n:t,makeCancelablePromise:n}))}},777834:function(e,t,n){n.d(t,{d:function(){return r}});var r={BOARD:"board",PIN:"pin",DID_IT:"did_it",PINNER:"pinner",USER:"user",TODAY_ARTICLE:"today_article",FOLLOW_INVITE:"follow_invite"}},73048:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(581722),o=n(20256),i=n(19585),l=n(302148),a=n(169053),s=n(793698),c=n(382718);function u(e){var t,n,u,d,f,p,h,m,y,g,_,b=e.triedItId,v=(0,i.ZP)(),x=(0,r.v9)(function(e){return e.triedits[b]}),j=(0,s.mN)()(null!=(t=x.user)?t:""),P=(0,a.S6)()(null!=(n=x.pin)?n:"");return P&&j?(0,c.jsxs)(o.xu,{children:[(0,c.jsxs)(o.xu,{alignItems:"center",column:12,display:"flex",children:[(0,c.jsx)(o.sg,{span:2,children:(0,c.jsx)(o.xu,{marginEnd:1,children:(0,c.jsx)(o.HE,{accessibilityLabel:v._('User`s avatar', 'User`s avatar', 'User`s avatar'),collaborators:[{name:null!=(u=j.full_name)?u:"",src:j.image_medium_url||j.image_large_url||void 0,color:j.avatar_color_index||void 0}],href:"/".concat(encodeURIComponent(j.username),"/"),role:"link"})})}),(0,c.jsx)(o.sg,{span:2,children:(0,c.jsx)(o.xu,{marginEnd:2,children:(0,c.jsx)(o.Tg,{href:"/pin/".concat(P.id,"/"),rounding:2,tapStyle:"none",children:(0,c.jsx)(o.zd,{rounding:2,wash:!0,children:(null==(d=P.images)||null==(f=d["136x136"])?void 0:f.url)&&(0,c.jsx)(o.Ee,{alt:P.description||"",color:"#767676",naturalHeight:136,naturalWidth:136,src:null==(p=P.images)?void 0:p["136x136"].url})})})})}),(0,c.jsx)(o.sg,{span:8,children:(0,c.jsx)(o.xv,{size:"200",weight:"bold",children:(0,c.jsx)(o.rU,{href:"/pin/".concat(P.id,"/"),tapStyle:"none",children:(0,l.nk)(v._('{{ name }} tried this Pin', ' - ', ' -- '),{name:j.full_name})})})})]}),(null==x||null==(h=x.images)||null==(m=h[0])?void 0:m["550x"])&&(0,c.jsx)(o.xu,{marginTop:2,children:(0,c.jsx)(o.zd,{rounding:2,children:(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{paddingBottom:"100%"}},position:"relative",children:(0,c.jsx)(o.xu,{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:x.images[0]["550x"].url&&(0,c.jsx)(o.Ee,{alt:null!=(y=x.details)?y:"",color:"#767676",fit:"cover",naturalHeight:1,naturalWidth:1,src:x.images[0]["550x"].url})})})})}),(0,c.jsxs)(o.xu,{column:10,marginTop:2,children:[!!(null!=x&&x.like_count)&&x.like_count>0&&(0,c.jsx)(o.xu,{paddingY:1,children:(0,c.jsx)(o.xv,{color:"subtle",inline:!0,size:"100",children:(0,c.jsx)(o.rU,{display:"inlineBlock",href:"/tried_it/".concat(encodeURIComponent(null!=(g=x.id)?g:""),"/likes/"),rounding:2,underline:"hover",children:(0,l.nk)(v.ngettext('1 person likes this', '{{ count }} people like this', null != (_ = x.like_count) ? _ : 0, 'person or people liking a given tried it', 'person or people liking a given tried it'),{count:x.like_count})})})}),(0,c.jsx)(o.xv,{children:null==x?void 0:x.details})]})]}):null}},666811:function(e,t,n){n.d(t,{X:function(){return f},Z:function(){return d}});var r=n(586659),o=n(729434),i=n(453179);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REPORT_CONTENT_SHOW":return{id:t.payload.id,auxData:t.payload.auxData,isProduct:t.payload.isProduct,isPromoted:t.payload.isPromoted,parentId:t.payload.parentId,videoDuration:t.payload.videoDuration,viewParameter:t.payload.viewParameter,viewType:t.payload.viewType,type:t.payload.type,isThirdPartyAd:t.payload.isThirdPartyAd,nodeId:t.payload.nodeId};case"REPORT_CONTENT_DISMISS":return null;default:return e}}var a=n(382718);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=(0,o.Z)("ReportData"),u=c.Provider,d=c.get;function f(e){var t,n=e.children,o=function(e){if(Array.isArray(e))return e}(t=(0,r.useReducer)(l,null))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return s(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),c=o[0],d=o[1],f=(0,r.useCallback)(function(){return d({type:"REPORT_CONTENT_DISMISS"})},[]),p=(0,r.useCallback)(function(e,t,n){return d({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,parentId:t,videoDuration:null,viewParameter:null,viewType:null,type:n,nodeId:null}})},[]),h=(0,r.useCallback)(function(e,t,n){return d({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:n,type:"conversation",nodeId:null}})},[]),m=(0,r.useCallback)(function(e){return d({type:"REPORT_CONTENT_SHOW",payload:{id:e.id,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:e.viewParameter,viewType:e.viewType,type:"pin",nodeId:e.nodeId}})},[]),y=(0,r.useCallback)(function(e){var t=e.pinId,n=e.isDownstreamPromotion,r=e.hasPromoter,o=e.firstVideoDuration,l=e.isProduct,a=e.viewParameter,s=e.viewType,c=e.isThirdPartyAd,u=e.nodeId;d({type:"REPORT_CONTENT_SHOW",payload:{id:t,auxData:e.auxData,isProduct:l,isPromoted:(0,i.jL)(n,r),videoDuration:o,viewParameter:a,viewType:s,type:"pin",isThirdPartyAd:c,nodeId:u}})},[]),g=(0,r.useMemo)(function(){return{reportData:c,dismiss:f,reportComment:p,reportConversation:h,reportImage:m,reportPin:y}},[c,f,p,h,m,y]);return(0,a.jsx)(u,{value:g,children:n})}}}]);
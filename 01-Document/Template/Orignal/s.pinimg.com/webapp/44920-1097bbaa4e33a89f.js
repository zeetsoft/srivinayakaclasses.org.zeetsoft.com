"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["44920"],{198700:function(e,t,n){n.d(t,{Z:function(){return U}});var r=n(586659),o=n(808045),i=n(733985),a=n(387088),u=n(654262),s=n(20256),l=n(382718),c=function(e){var t=e.children,n=e.description,o=e.error,i=e.id,a=e.label,u=e.required,c=e.onLabelTouch;return(0,l.jsxs)(r.Fragment,{children:[(a||u)&&(0,l.jsx)(s.__,{htmlFor:i,children:(0,l.jsx)(s.xu,{marginBottom:1,children:(0,l.jsxs)(s.xv,{color:o?"error":"default",children:[a,u&&(0,l.jsx)(s.xv,{color:"error",inline:!0,weight:"bold",children:(0,l.jsx)("span",{"aria-hidden":"true",children:"*"})})]})})}),t,(!!o||!!n)&&(0,l.jsx)(s.__,{htmlFor:i,children:(0,l.jsx)(s.xu,{marginTop:1,children:c?(0,l.jsx)(s.iP,{onTap:c,children:(0,l.jsx)(s.xv,{color:o?"error":"default",size:"200",children:o||n})}):(0,l.jsx)(s.xv,{color:o?"error":"default",size:"200",children:o||n})})})]})};function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){b(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}var P=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&h(o,e);var t,n,r=(t=y(),function(){var e,n=g(o);return e=t?Reflect.construct(n,arguments,g(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return m(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return b(m(e=r.call.apply(r,[this].concat(n))),"setTextFieldInputRef",function(t){(0,e.props.forwardedRef)(t||null)}),b(m(e),"handleBlur",function(t){var n=t.event,r=e.props.onBlur;r&&r(n)}),b(m(e),"handleChange",function(t){var n=t.event,r=e.props.onChange;r&&r(n)}),b(m(e),"handleFocus",function(t){var n=t.event,r=e.props.onFocus;r&&r(n)}),b(m(e),"handleKeyDown",function(t){var n=t.event,r=e.props.onKeyDown;r&&r(n)}),e}return n=[{key:"render",value:function(){var e=this.props,t=e.accessibilityLabelIcon,n=e.disabled,r=e.icon,o=e.id,i=e.isRTL,a=void 0!==i&&i,u=e.onClick,c=e.placeholder,d=e.value;return(0,l.jsx)(s.iP,{dataTestId:"text-field-wrapper",onTap:u,children:(0,l.jsxs)(s.xu,{alignItems:"center",column:12,display:"flex",flex:"grow",position:"relative",children:[(0,l.jsx)(s.xu,{width:"100%",children:(0,l.jsx)(s.nv,{ref:this.setTextFieldInputRef,dataTestId:"text-field",disabled:n,id:o,onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,placeholder:c,size:"lg",value:d})}),(0,l.jsx)(s.xu,{left:a,position:"absolute",right:!a,children:(0,l.jsx)(s.xu,{marginEnd:4,position:"relative",children:(0,l.jsx)(s.JO,{accessibilityLabel:t,color:"default",icon:"clock"===r||"arrow-down"===r?r:"calendar",inline:!0})})})]})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(r.Component),O=(0,r.forwardRef)(function(e,t){return(0,l.jsx)(P,f(f({},e),{},{forwardedRef:t}))}),S=n(19585),w=n(15667);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function D(e,t){return(D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(C=function(){return!!e})()}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t,n){return(t=R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=I(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}var T=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&D(a,e);var t,n,r=(t=C(),function(){var e,n=E(a);return e=t?Reflect.construct(n,arguments,E(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==I(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return x(e)}(this,e)});function a(){var e;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return M(x(e=r.call.apply(r,[this].concat(n))),"state",{showFlyout:!1}),M(x(e),"setTimeFieldRef",function(t){e.timeFieldRef=t}),M(x(e),"handleChange",function(t,n){var r=e.props.onChange;e.handleHideFlyout(),r({event:t,value:n})}),M(x(e),"handleShowFlyout",function(){e.setState({showFlyout:!0})}),M(x(e),"handleHideFlyout",function(){e.setState({showFlyout:!1})}),e}return n=[{key:"render",value:function(){for(var e=this,t=this.props,n=t.error,r=t.id,a=t.idealDirection,u=t.interval,d=t.minTime,p=t.maxTime,f=t.placeholder,h=t.value,m=t.disabled,y=t.maxHeight,g=t.requestContext,b=this.state.showFlyout,v=[],P=(0,i.Z)(p,d)/u,S=0;S<P;S+=1){var w=(0,o.Z)(d,S*u);v.push(w)}return(0,l.jsx)(c,{error:n,id:r,children:(0,l.jsxs)(s.xu,{position:"relative",children:[(0,l.jsx)(O,{ref:this.setTimeFieldRef,accessibilityLabelIcon:this.props.i18n._('Select a time', 'timeField.TextFieldWrapper.accessibilityLabel.clockIcon', 'Accessibility label for a clock icon showing on the time picker field'),disabled:void 0!==m&&m,icon:"clock",id:r,isRTL:g.isRTL,onFocus:this.handleShowFlyout,placeholder:f,value:h?h.toLocaleTimeString(["en-US"],{hour:"2-digit",minute:"2-digit"}):""}),b&&(0,l.jsx)(s.Lt,{anchor:this.timeFieldRef,disableMobileUI:!0,id:"time-field-dropdown",idealDirection:a,isWithinFixedContainer:!0,maxHeight:y,onDismiss:this.handleHideFlyout,zIndex:new s.Ry(1e3),children:v.map(function(t){var n=t.toLocaleTimeString(["en-US"],{hour:"2-digit",minute:"2-digit"});return(0,l.jsx)(s.Lt.Item,{dataTestId:"time-field-option",onSelect:function(n){var r=n.event;return e.handleChange(r,t)},option:{label:n,value:n},children:(0,l.jsx)(s.xv,{color:"default",size:"200",weight:"bold",children:n})},t.getTime())})})]})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.Component);function U(e){var t=(0,S.ZP)();return(0,l.jsx)(T,j(j({},e),{},{i18n:t,requestContext:(0,w.B)()}))}M(T,"defaultProps",{interval:30,minTime:(0,u.Z)(new Date),maxTime:(0,a.Z)(new Date)})},899678:function(e,t,n){n.d(t,{N:function(){return a},Z:function(){return i}});var r=n(20256),o=n(382718);function i(e){var t=e.children,n=e.fullWidth,i=e.overrideDataTestId;return(0,o.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",width:n?"100%":void 0}},"data-test-id":i||"pointer-events-wrapper",children:t})}function a(e){var t=e.children;return e.enabled?(0,o.jsx)(i,{children:t}):t}},166379:function(e,t,n){n.d(t,{k:function(){return r.kH}});var r=n(654937),o=n(15667);t.Z=function(e){var t=e.dateFormatType,n=e.useUTC,i=e.value,a=(0,o.B)();return(0,r.ZP)(a.locale,i,t,void 0===n||n)}},945467:function(e,t,n){n.d(t,{C0:function(){return y},Nn:function(){return r.Z},Mt:function(){return p}});var r=n(199158),o=n(586659),i=n(968254),a=n(111375),u=n(15667),s=n(382718);function l(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d=(0,o.forwardRef)(function(e,t){var n,r=e.disabled,d=e.disableMobileUI,p=e.errorMessage,f=e.errorMessageDisplay,h=e.excludeDates,m=e.helperText,y=e.id,g=e.idealDirection,b=e.includeDates,v=e.label,P=e.maxDate,O=e.minDate,S=e.mobileZIndex,w=e.mobileOnAnimationEnd,I=e.name,_=e.nextRef,j=e.onChange,D=e.onFocus,x=e.onBlur,C=e.placeholder,E=e.rangeEndDate,M=e.rangeSelector,R=e.rangeStartDate,T=e.readOnly,U=e.selectLists,k=e.size,F=e.value,A=e._overrideRangeDateFix,L=(0,u.B)().locale,N=function(e){if(Array.isArray(e))return e}(n=(0,o.useState)(void 0))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,l=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(u.push(r.value),2!==u.length);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(n,2)||function(e,t){if(e){if("string"==typeof e)return c(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,2):void 0}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),B=N[0],Z=N[1];return(0,o.useEffect)(function(){var e,t;(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.Z)(L);case 2:Z(e.sent);case 4:case"end":return e.stop()}},e)}),t=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,u,"next",e)}function u(e){l(i,r,o,a,u,"throw",e)}a(void 0)})},function(){return t.apply(this,arguments)})()},[L,Z]),(0,s.jsx)(i.Mt,{ref:t,_overrideRangeDateFix:A,disabled:r,disableMobileUI:d,errorMessage:p,errorMessageDisplay:f,excludeDates:h,helperText:m,id:y,idealDirection:g,includeDates:b,label:v,localeData:B,maxDate:P,minDate:O,mobileOnAnimationEnd:w,mobileZIndex:S,name:I,nextRef:_,onBlur:x,onChange:j,onFocus:D,placeholder:C,rangeEndDate:E,rangeSelector:M,rangeStartDate:R,readOnly:T,selectLists:U,size:k,value:F})});d.displayName="DatePicker";var p=d;function f(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t,n=e.maxDate,r=e.minDate,l=e.onCancel,c=e.onDateChange,d=e.onDateError,p=e.onDateFocus,m=e.onDateBlur,y=e.onSubmit,g=e.radioGroup,b=e.readOnly,v=e.dateValue,P=e.dateErrorMessage,O=e.secondaryDateValue,S=e.secondaryDateErrorMessage,w=e.onSecondaryDateBlur,I=e.onSecondaryDateChange,_=e.onSecondaryDateError,j=e.onSecondaryDateFocus,D=(0,u.B)().locale,x=function(e){if(Array.isArray(e))return e}(t=(0,o.useState)())||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,l=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(u.push(r.value),2!==u.length);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,2)||function(e,t){if(e){if("string"==typeof e)return h(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),C=x[0],E=x[1];return(0,o.useEffect)(function(){var e,t;(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.Z)(D);case 2:E(e.sent);case 4:case"end":return e.stop()}},e)}),t=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,u,"next",e)}function u(e){f(i,r,o,a,u,"throw",e)}a(void 0)})},function(){return t.apply(this,arguments)})()},[D,E]),(0,s.jsx)(i.C0,{dateErrorMessage:P,dateValue:v,localeData:C,maxDate:n,minDate:r,onCancel:l,onDateBlur:m,onDateChange:c,onDateError:d,onDateFocus:p,onSecondaryDateBlur:w,onSecondaryDateChange:I,onSecondaryDateError:_,onSecondaryDateFocus:j,onSubmit:y,radioGroup:g,readOnly:b,secondaryDateErrorMessage:S,secondaryDateValue:O})};m.displayName="DateRange";var y=m},194737:function(e,t){t.Z=function(e){var t=e.url;return""===t||/^(https?:\/\/)?[a-z0-9_\-]+\..+/i.test(t)}},931302:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(586659),o=n(20256),i=n(461951),a=n(382718);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(p=function(){return!!e})()}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var y={default:{backgroundColor:i.zsO,boxShadow:"none"},drag:{backgroundColor:i.Wmm,boxShadow:"".concat(i.lwx," ").concat(i.lwx," ").concat(i.lwx," ").concat(i.FCL," ").concat(i.Gh8)},error:{backgroundColor:i.$wd,boxShadow:"".concat(i.lwx," ").concat(i.lwx," ").concat(i.lwx," ").concat(i.FCL," ").concat(i.jKP)}},g=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&c(i,e);var t,n,r=(t=p(),function(){var e,n=f(i);return e=t?Reflect.construct(n,arguments,f(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return d(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return h(d(e=r.call.apply(r,[this].concat(n))),"state",{isDraggingOver:!1,isHoveringOver:!1,containedHeight:null}),h(d(e),"handleOnDragEnter",function(t){var n=e.props.onDragEnter;t.preventDefault(),t.stopPropagation(),e.setState({isDraggingOver:!0}),n&&n(t)}),h(d(e),"handleOnDragLeave",function(t){var n=e.props.onDragLeave;t.preventDefault(),t.stopPropagation(),e.setState({isDraggingOver:!1}),n&&n(t)}),h(d(e),"handleOnDragOver",function(t){var n=e.props.onDragOver;t.preventDefault(),t.stopPropagation(),n&&n(t)}),h(d(e),"handleOnDrop",function(t){var n=e.props.onDrop;t.preventDefault(),t.stopPropagation(),e.setState({isDraggingOver:!1}),n&&n(t)}),h(d(e),"handleMouseEnter",function(){var t=e.props.onMouseEnter;t&&t(),e.setState({isHoveringOver:!0})}),h(d(e),"handleMouseLeave",function(){var t=e.props.onMouseLeave;t&&t(),e.setState({isHoveringOver:!1})}),h(d(e),"setContainedHeight",function(t){e.setState({containedHeight:t})}),e}return n=[{key:"getDragContainerStyles",value:function(e,t){return t&&"default"===e?l(l({},y[e]),{},{backgroundColor:t}):y[e]}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.color,r=e.dropRounding,i=e.hasError,u=e.height,s=e.position,c=e.width,d=this.state,p=d.isDraggingOver,f=d.isHoveringOver,h=d.containedHeight;return(0,a.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:l(l({},this.getDragContainerStyles(p?"drag":i?"error":"default",n)),r?{borderRadius:r}:{})},"data-test-id":"drag-behavior-container",height:u||h||"100%",onDragEnter:this.handleOnDragEnter,onDragLeave:this.handleOnDragLeave,onDragOver:this.handleOnDragOver,onDrop:this.handleOnDrop,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,position:s,rounding:2,width:c||"100%",children:t(p,f,this.setContainedHeight,h)})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.Component)},767209:function(e,t,n){var r=n(586659),o=n(20256),i=n(461951),a=n(931302),u=n(382718);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d={cursor:"pointer",height:"100%",opacity:0,position:"absolute",width:"100%",left:0,top:0,fontSize:0};t.Z=function(e){var t,n=function(e){if(Array.isArray(e))return e}(t=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,l=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(u.push(r.value),2!==u.length);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,2)||function(e,t){if(e){if("string"==typeof e)return c(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p=n[0],f=n[1],h=function(t){var n=e.onChange;t.preventDefault(),t.stopPropagation(),n&&n(t),t.target.value=""},m=function(t){var n=e.onClick;n&&n(t)},y=e.accept,g=e.accessibilityLabel,b=e.accessibilityDescription,v=e.allowMultipleFiles,P=e.children,O=e.color,S=e.dropRounding,w=e.hasError,I=e.height,_=e.id,j=e.onDrop,D=e.position,x=e.rounding,C=void 0===x?2:x,E=e.width,M=e.isAriaHidden,R=void 0===M?void 0:M,T=e.isRequired,U=void 0===T?void 0:T,k=e.experimentsClient;return(0,u.jsx)(a.Z,{color:O,dropRounding:S,experimentsClient:k,hasError:w,height:I,onDrop:j,position:D,width:E,children:function(e){return(0,u.jsxs)(o.xu,{dangerouslySetInlineStyle:{__style:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},p?{border:"2px solid ".concat(i.nTo)}:{})},height:"100%",onBlur:function(){return f(!1)},onFocus:function(){return f(!0)},position:"relative",rounding:C,children:[P(e),(0,u.jsx)("input",{accept:y,"aria-describedby":"upload-button-explanation","aria-hidden":R,"aria-invalid":w?"true":void 0,"aria-label":g,"data-test-id":_,id:_,multiple:v,onChange:h,onClick:m,required:U,style:d,tabIndex:R?-1:0,type:"file"}),b&&(0,u.jsx)(o.xu,{display:"none",id:"upload-button-explanation",children:(0,u.jsx)(o.xv,{children:b})})]})}})}},218119:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(20256),o=n(19585),i=n(382718);function a(){var e=(0,o.ZP)();return(0,i.jsx)(r.kC,{alignItems:"center",justifyContent:"center",children:(0,i.jsx)(r.xH,{accessibilityLabel:e._('Loading editor', 'EditorWithMentionsFallback.loading', 'Message shown while waiting for the editor to load'),show:!0})})}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c=(0,n(78762).Z)(function(){return Promise.all([n.e("52949"),n.e("96310")]).then(n.bind(n,493123))},void 0,function(e){return 493123},"app-www-EditorWithMentions-EditorWithMentionsInternal",function(e){return ["52949","96310"]});function d(e){return(0,i.jsx)(c,l(l({},e),{},{fallback:(0,i.jsx)(a,{})}))}},97245:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(20256),o=n(382718);function i(e){var t=e.htmlFor,n=e.errorMessage,i=e.errorMessageColor,a=e.icon;return(0,o.jsx)(r.__,{htmlFor:t,children:(0,o.jsx)(r.xu,{marginTop:1,children:(0,o.jsxs)(r.kC,{direction:"row",gap:2,children:[a,(0,o.jsx)(r.xv,{color:void 0===i?"error":i,size:"200",children:n})]})})})}},694103:function(e,t,n){n.d(t,{E:function(){return o}});var r=(0,n(729434).Z)("VerticalNav",{width:0,sideBarWidth:0,selectedNav:void 0,isPanelOpen:function(){return!1},sideBarOpen:!1,updatePanelState:function(){},togglePanelState:function(){}}),o=r.Provider;t.Z=r.get},74459:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(694103);function o(){return(0,r.Z)().width}},601686:function(e,t,n){n.d(t,{bq:function(){return d},x4:function(){return p}});var r=n(586659),o=n(611499),i=n(382718);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l={showCloseupContentRight:!0,showProductDetailPage:!1,viewportSize:"lg",paneWidth:o.Gg,maxWidth:o.u6,descriptionPaneWidth:o.u6-o.Gg,isCommentAttachmentSelectorOpen:!1,isCommentComposerFocused:!1,isCommentPopoverInteractionActive:!1,isCommentThreadExpanded:!1,isCloseupMediaViewerOpen:!1,isMediaViewerOpen:!1,isShoppingModuleExpanded:!1,closeupWithinMasonryEnabled:!1,peekCloseupEnabled:!1,calculatedImageHeight:0,setAbortNoActionPlacementTimeout:function(){},setIsCloseupMediaViewerOpen:function(){},setIsCommentAttachmentSelectorOpen:function(){},setIsCommentComposerFocused:function(){},setIsCommentPopoverInteractionActive:function(){},setIsMediaViewerOpen:function(){},setIsShoppingModuleExpanded:function(){},setCalculatedImageHeight:function(){},setViewportSize:function(){}},c=(0,r.createContext)(l);function d(e){var t=e.children,n=e.value,o=(0,r.useMemo)(function(){return s(s({},l),n)},[n]);return(0,i.jsx)(c,{value:o,children:t})}function p(){var e=(0,r.useContext)(c);if(!e)throw Error("useCloseupContext must be used within CloseupContextProvider");return e}},611499:function(e,t,n){n.d(t,{$T:function(){return m},CI:function(){return a},Ch:function(){return s},E$:function(){return w},ER:function(){return h},Gb:function(){return l},Gg:function(){return o},Hf:function(){return b},Id:function(){return O},Ie:function(){return d},KP:function(){return p},Kn:function(){return u},O5:function(){return y},d2:function(){return c},dm:function(){return S},fF:function(){return P},g9:function(){return f},iB:function(){return v},rv:function(){return g},u6:function(){return i}});var r=n(20256),o=508,i=1016,a=488,u=992,s=672,l=1176,c=40,d=72,p=740,f=32,h=16,m=24,y=2,g=1,b=new r.Ry(5),v={ARTICLE:"https://schema.org/Article",BRAND:"https://schema.org/Brand",PRODUCT:"https://schema.org/Product",RECIPE:"https://schema.org/Recipe",OFFER:"https://schema.org/Offer",OUT_OF_STOCK:"https://schema.org/OutOfStock",PERSON:"https://schema.org/Person"},P={boxShadow:"0 2px 5px rgba(0, 0, 0, 0.06)",transition:"box-shadow 200ms ease-in-out"},O="calc(90vh - 80px)",S="calc(55vh + 80px)",w="calc(75vh - 80px)"},957010:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(672410),o=n(721903),i=n(349361),a=n(613505),u=n(506001);function s(e){var t=e.i18n,n=e.isAppend,s=e.isEmployee,l=e.pinDraft,c=e.pinDraftId,d=e.storyPinPublishStopwatch;return function(e){if(!l||!l.pinItemIds){var p=(0,r.Z)();e((l&&"story"===l.type?a.Z:i.Z)(c,p))}(null==l?void 0:l.type)==="story"&&e((0,u.Z)({i18n:t,isEmployee:s,pinDraftId:c,storyPinPublishStopwatch:d})),e((0,o.Z)(c,l,{isAppend:n}))}}},758260:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){return{type:"PIN_BUILDER_DELETE_PIN_DRAFT",payload:{pinDraftId:e}}}},316095:function(e,t,n){n.r(t),n.d(t,{_isPristine:function(){return D},addPinBuilderAsset:function(){return j},addPinBuilderPinDraftItemUpload:function(){return E},clearCreatedPinIds:function(){return U},clearPinBuilderPinDrafts:function(){return g},clearSelectedPinBuilderPinDrafts:function(){return O},deselectAllPinBuilderPinDrafts:function(){return I},deselectPinBuilderPinDraft:function(){return P},duplicatePinDraft:function(){return b},removeCreatedPinId:function(){return T},selectAllPinBuilderPinDrafts:function(){return S},selectAllPinBuilderStoryPinDrafts:function(){return w},selectPinBuilderPinDraft:function(){return v},setCloseupImageSignature:function(){return k},setPinBuilderBatchEditMode:function(){return x},setPinBuilderEntryPoint:function(){return F},setPinBuilderPinItemUploadStatus:function(){return M},setPinBuilderPinItemUploadXhr:function(){return R},setPinBuilderSharedData:function(){return _},setPinEditorPinDraft:function(){return C},setShowDisabledPinCreationBanner:function(){return L},setShowFeedbackModal:function(){return A}});var r=n(672410),o=n(526435),i=n(721903),a=n(349361),u=n(669019),s=n(792849),l=n(613505),c=n(506001),d=n(263255),p=n(400704),f=["publishOption","scheduledDate","scheduledTime","selectedItem"];function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(){return{type:"PIN_BUILDER_CLEAR_PIN_DRAFTS"}}function b(e,t,n){return function(o,u){var p=u().pinbuilder,f=p.pinDrafts,h=p.pinItems,m=p.pinDraftIdUploadStatusMap,g=p.storyPinItems,b=p.storyPinItemBlocks,v=f[e],P=m&&m[e]?m[e]:null,O=(0,r.Z)();P&&o((0,s.g)(O,P.status));var S=v.pinItemIds.map(function(i){var u=(0,r.Z)();if(h[i])o((0,a.Z)(O,u,h[i]));else if(g[i]){var s=g[i],p=s.blockIds.map(function(e){return b[e]});o((0,c.Z)({i18n:t,isEmployee:n,pinDraftId:e,storyPinPublishStopwatch:void 0})),o((0,l.Z)(O,u,y(y({},s),{},{blockIds:[]}))),p.forEach(function(t){o((0,d.Uo)(e,u,(0,r.Z)(),y({},t)))})}return P&&P.items[i]&&o(E(O,u,{status:P.items[i].status,xhr:null})),u});return o((0,i.Z)(O,y(y({},v),{},{pinItemIds:S,storyPinDraftId:null}),{insertBefore:e})),O}}function v(e){return{type:"PIN_BUILDER_SELECT_PIN_DRAFT",payload:{pinDraftId:e}}}function P(e){return{type:"PIN_BUILDER_DESELECT_PIN_DRAFT",payload:{pinDraftId:e}}}function O(){return{type:"PIN_BUILDER_CLEAR_SELECTED_PIN_DRAFTS"}}function S(){return function(e,t){var n=t().pinbuilder,r=n.selectedPinDraftIds,i=n.pinDrafts;n.pinDraftIds.forEach(function(t){var n=i[t].status;r.includes(t)||o.x1.includes(n)||e(v(t))})}}function w(){return function(e,t){var n=t(),r=n.pinbuilder.selectedPinDraftIds,i=(0,p.Wp)(n);Object.keys(i).forEach(function(t){var n=i[t],a=n.status;n.storyPinDraftId&&t&&!r.includes(t)&&!o.x1.includes(a)&&e(v(t))})}}function I(){return function(e,t){t().pinbuilder.selectedPinDraftIds.forEach(function(t){e(P(t))})}}function _(e){return function(t,n){var o=n().pinbuilder.selectedPinDraftIds,i=e.publishOption,a=e.scheduledDate,s=e.scheduledTime,l=e.selectedItem,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,f);o.forEach(function(e){t((0,u.NA)(e,y(y(y(y({},null!=i?{publishOption:i}:Object.freeze({})),void 0!==l?{selectedItem:l}:Object.freeze({})),void 0!==a?{scheduledDate:a}:Object.freeze({})),void 0!==s?{scheduledTime:s}:{}))),c.editorInstanceId=(0,r.Z)(),t((0,u.to)(e,c))})}}function j(e){return{type:"PIN_BUILDER_ADD_ASSET",payload:{asset:e}}}function D(e,t){var n=e.pinbuilder,r=n.pinDrafts,o=n.pinItems,i=r[t],a=i.selectedItem,u=i.pinItemIds,s=i.publishOption;return!a&&"publish-immediately"===s&&u.every(function(e){var t=o[e],n=t.description,r=t.link,i=t.media,a=t.title;return!n&&!r&&!a&&!i})}function x(e){return{type:"PIN_BUILDER_SET_BATCH_EDIT_MODE",payload:{isBatchEditMode:e}}}function C(e){return{type:"PIN_EDITOR_SET_PIN_DRAFT",payload:{editedPinDraftId:e}}}function E(e,t,n){return{type:"PIN_BUILDER_ADD_PIN_DRAFT_ITEM_UPLOAD",payload:{pinDraftId:e,pinItemId:t,upload:n}}}function M(e,t,n){return{type:"PIN_BUILDER_SET_PIN_ITEM_UPLOAD_STATUS",payload:{pinDraftId:e,pinItemId:t,status:n}}}function R(e,t,n){return{type:"PIN_BUILDER_SET_PIN_ITEM_UPLOAD_XHR",payload:{pinDraftId:e,pinItemId:t,xhr:n}}}function T(e){return{type:"PIN_BUILDER_REMOVE_CREATED_PIN_ID",payload:{pinId:e}}}function U(){return{type:"PIN_BUILDER_CLEAR_CREATED_PIN_IDS"}}function k(e){return{type:"PIN_BUILDER_SET_CLOSEUP_IMAGE_SIGNATURE",payload:{closeupImageSignature:e}}}function F(e){return{type:"PIN_BUILDER_ENTRY_POINT",payload:{entryPoint:e}}}function A(e){return{type:"PIN_BUILDER_SHOW_FEEDBACK_MODAL",payload:{showFeedbackModal:e}}}function L(e){return{type:"PIN_BUILDER_SHOW_DISABLE_PIN_CREATION_BANNER",payload:{showDisabledPinCreationBanner:e}}}},613505:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e,t,n,r){return{type:"PIN_DRAFT_ADD_STORY_PIN_ITEM",payload:{pinDraftId:e,pinItemId:t,pinItem:n,options:r}}}},295345:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){return function(t,n){t&&console.log("".concat(e," - ").concat(n))}}},506001:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(47676),o=n(672410),i=n(657043),a=n(686319),u=n(302148),s=n(295345),l=n(984993);function c(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}var d=[200,201,204];function p(){var e;return e=regeneratorRuntime.mark(function e(t,n,r,o,i,a,s){var l,c,p,f,h,m,y,g,b,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=(null==i?void 0:i.upload_id)||"",c=(null==i?void 0:i.upload_url)||"",p=(null==i?void 0:i.upload_parameters)||{},f=o.onFailure,h=o.onFinishUpload,m=o.onStartUpload,y=o.onUploadProgress,m&&m(l),g=new Date,b=new XMLHttpRequest,"image"===n?b.open("POST",c.replace("pinterest-media-upload.s3.amazonaws","u.pinimg"),!0):b.open("POST",c,!0),b.onload=function(){if(d.includes(b.status)){if(h){var e=(Date.now()-g.getTime())/1e3,t=b.getResponseHeader("x-amz-request-id");h(l,{amzId2:b.getResponseHeader("x-amz-id-2"),amzRequestId:t,uploadTimeSec:e,statusCode:b.status})}}else{var r="image"===n?1:8;f({uploadId:l,errorMsg:(0,u.nk)(s._('Failed to upload the {{ mediaType }} with XHR status code: {{ xhrStatus }}', 'uploadMedia.xhrOnLoad.failure', 'Error message when media does not upload'),{mediaType:n,xhrStatus:b.status}).join(),mediaUploadFailureReason:r,retry:!0})}},b.onerror=function(){var e="image"===n?1:8;f({uploadId:l,errorMsg:(0,u.nk)(s._('Failed to upload the {{ mediaType }}', 'uploadMedia.xhrOnError.failure', 'Error message when media does not upload'),{mediaType:n}).join(),mediaUploadFailureReason:e,retry:!0})},y&&(b.upload.onprogress=function(e){y(Math.round(100*(e.loaded/e.total)))}),v=new FormData,Object.keys(p).forEach(function(e){e&&p[e]&&v.append(e,p[e])}),v.append("file",t),b.send(v),e.abrupt("return",{uploadId:l,xhr:b});case 16:case"end":return e.stop()}},e)}),(p=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)})}).apply(this,arguments)}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=b();return function(){var n,r=v(e);return n=t?Reflect.construct(r,arguments,v(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return g(e)}(this,n)}}function g(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function O(e,t,n){return t&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function w(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var _=["webImage","webVideo"],j=O(function e(t){var n=this;S(this,e),w(this,"upload",function(){}),w(this,"onFailure",function(e){var t=e.errorMsg,r=e.mediaUploadFailureReason,o=e.retry,i=e.uploadId;o&&n.numAttempts<n.maxUploadAttempts?n.upload():(n.status="failed",n.callbackHandlers.onFailure({errorMsg:t,mediaUploadFailureReason:r,uploadId:i,storyPinPublishStopwatch:n.storyPinPublishStopwatch}))}),w(this,"onFinishProcessing",function(e,t){n.signature=t.signature,n.callbackHandlers.onFinishProcessing&&n.callbackHandlers.onFinishProcessing(e,t,n.storyPinPublishStopwatch)}),w(this,"onFinishUpload",function(e,t){n.status="uploaded",n.callbackHandlers.onFinishUpload&&n.callbackHandlers.onFinishUpload(e,t,n.storyPinPublishStopwatch)}),w(this,"onStartProcessing",function(e,t){n.signature=t.signature,n.callbackHandlers.onStartProcessing&&n.callbackHandlers.onStartProcessing(e,t,n.storyPinPublishStopwatch)}),w(this,"cancel",function(){n.xhr&&(n.xhr.abort(),n.callbackHandlers.onCancel&&n.callbackHandlers.onCancel(n.uploadId||"",n.storyPinPublishStopwatch))}),this.i18n=t.i18n,this.maxUploadAttempts=t.maxUploadAttempts||1,this.media=t.media,this.numAttempts=0,this.storyPinPublishStopwatch=t.storyPinPublishStopwatch,this.vipRegistration=t.vipRegistration,this.vipType=t.vipType,this.callbackHandlers=t.callbackHandlers}),D=function(e){h(n,e);var t=y(n);function n(e){var r;return S(this,n),w(g(r=t.call(this,e)),"getClassName",function(){return"ImageUpload"}),w(g(r),"onProcessingFailed",function(e){if(r.uploadId){var t=(0,u.nk)(r.i18n._('Failed to process image with uploadId {{ uploadId }} and failureCode {{ failureCode }}', 'MediaUpload.ImageUpload.onProcessingFailed', 'Error message for when image processing fails'),{failureCode:e,uploadId:r.uploadId}).join("");r.onFailure({uploadId:r.uploadId,errorMsg:t,mediaUploadFailureReason:3,mediaStatusFailureReason:e})}}),w(g(r),"onProcessingTimeout",function(){if(r.uploadId){var e=(0,u.nk)(r.i18n._('Timed out on processing image with uploadId {{ uploadId }}', 'MediaUpload.ImageUpload.onProcessingTimeout', 'Error message for when image processing times out'),{uploadId:r.uploadId}).join("");r.onFailure({uploadId:r.uploadId,errorMsg:e,mediaUploadFailureReason:4})}}),w(g(r),"upload",function(){"localImage"===r.media.type&&(r.numAttempts+=1,(function(e,t,n,r,o,i,a){return p.apply(this,arguments)})(r.media.fileSrc?r.media.fileSrc:(0,l.Mi)(r.media.src),"image",r.vipType,{onFailure:function(e){return r.onFailure(e)},onFinishUpload:r.onFinishUpload,onStartUpload:r.callbackHandlers.onStartUpload,onUploadProgress:r.callbackHandlers.onUploadProgress},r.vipRegistration,r.storyPinPublishStopwatch,r.i18n).then(function(e){r.uploadId=e.uploadId,r.xhr=e.xhr,r.status="uploading"}))}),r.signature=_.includes(e.media.type)?e.media.signature:null,r.status=_.includes(e.media.type)?"uploaded":"pending",r}return O(n)}(j),x=function(e){h(n,e);var t=y(n);function n(e){var r;return S(this,n),w(g(r=t.call(this,e)),"getClassName",function(){return"VideoUpload"}),w(g(r),"onProcessingFailed",function(e){if(r.uploadId){var t=(0,u.nk)(r.i18n._('Failed to process video with uploadId {{ uploadId }} and failureCode {{ failureCode }}', 'MediaUpload.VideoUpload.onProcessingFailed', 'Error message when video processing fails'),{uploadId:r.uploadId,failureCode:e}).join("");r.onFailure({uploadId:r.uploadId,errorMsg:t,mediaUploadFailureReason:10,mediaStatusFailureReason:e,storyPinPublishStopwatch:r.storyPinPublishStopwatch})}}),w(g(r),"onProcessingTimeout",function(){if(r.uploadId){var e=(0,u.nk)(r.i18n._('Timed out on processing video with uploadId {{ uploadId }}', 'MediaUpload.VideoUpload.onProcessingTimeout', 'Error message when video processing times out'),{uploadId:r.uploadId}).join("");r.onFailure({uploadId:r.uploadId,errorMsg:e,mediaUploadFailureReason:11,storyPinPublishStopwatch:r.storyPinPublishStopwatch})}}),w(g(r),"upload",function(){"localVideo"===r.media.type&&(r.numAttempts+=1,(function(e,t,n,r,o,i,a){return p.apply(this,arguments)})(r.media.fileSrc,"video",r.vipType,{onFailure:function(e){return r.onFailure(e)},onFinishUpload:r.onFinishUpload,onStartUpload:r.callbackHandlers.onStartUpload,onUploadProgress:r.callbackHandlers.onUploadProgress},r.vipRegistration,r.storyPinPublishStopwatch,r.i18n).then(function(e){r.uploadId=e.uploadId,r.xhr=e.xhr,r.status="uploading"}))}),r.signature=_.includes(e.media.type)?e.media.signature:null,r.status=_.includes(e.media.type)?"uploaded":"pending",r}return O(n)}(j);function C(e){return"localImage"===e.type||"webImage"===e.type}var E=n(614699),M=n(603316);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function k(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){k(i,r,o,a,u,"next",e)}function u(e){k(i,r,o,a,u,"throw",e)}a(void 0)})}}function A(e,t,n){return(t=L(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=R(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==R(t)?t:t+""}var N=(0,s.Z)("[MEDIA UPLOAD MANAGER]"),B=function(){var e;function t(e){var n,r,s=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");A(this,"getMediaRegistrationsFromVIP",(n=F(regeneratorRuntime.mark(function e(t){var n,r,l,c,d,p,f,h,m,y,g,b,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.count,l=t.durationMs,c=t.mediaMetadata,d=t.mediaType,f=void 0!==(p=t.shouldSkipPool)&&p,m=void 0===(h=t.retryCount)?0:h,y=r||("image"===d?2:1),f||(s.vipRegistrationPool[d].fetchingData=!0),s.debugLog("Getting media registration urls for ".concat(d,"s")),g=[],b=0;b<y;b+=1)g.push(U(U({id:(0,o.Z)(),media_type:"image"===d?"image-story-pin":"video-story-pin"},l?{upload_aux_data:{clips:[{durationMs:l,isFromImage:"image"===d,startTimestampMs:-1}]}}:{}),c?{media_metadata:{image_hash:c.imageHash,metadata:c.metadata,error_message:c.errorMessage}}:{}));return v=s.vipRegistrationRequestCounts[d],s.vipRegistrationRequestCounts[d]+=1,null==(n=s.storyPinPublishStopwatch)||n.subspanStart({name:"".concat(d,"_registration_").concat(v),bypassIsTimingCheck:!0}),e.abrupt("return",(0,a.Z)({url:"/v3/media/uploads/register/batch/",method:"POST",data:{media_info_list:JSON.stringify(g)},callOptions:{showError:3===m}}).then(function(e){var t,n="object"===R(e.resource_response.data)?Object.values(e.resource_response.data):[];return f||(s.vipRegistrationPool[d].data=n,s.vipRegistrationPool[d].fetchedLast=performance.now(),s.vipRegistrationPool[d].fetchingData=!1),null==(t=s.storyPinPublishStopwatch)||t.subspanStop({name:"".concat(d,"_registration_").concat(v),bypassIsTimingCheck:!0}),n},function(e){var t,n;return(0,M.nP)("storypin.publish.registration.".concat(d,".failure"),{sampleRate:1,tags:{reason:(0,i.Z)(e,"message"),retryCount:m}}),m<3?(s.debugLog("".concat(d," registration failed. ").concat(3-m," retries remaining. ").concat(e)),n=s.getMediaRegistrationsFromVIP({durationMs:l,mediaMetadata:c,mediaType:d,shouldSkipPool:f,count:r,retryCount:m+1})):(s.debugLog("".concat(d," registration failed. ").concat(e)),s.onFailure((0,u.nk)(s.i18n._('Failed to register {{ mediaType }} upload with message: {{ error }}', 'MediaUploadManager.getMediaRegistrationsFromVIP.failure', 'Error message for media upload'),{error:e,mediaType:d}).join(""),"image"===d?13:7),n=Promise.resolve(null)),null==(t=s.storyPinPublishStopwatch)||t.subspanStop({name:"".concat(d,"_registration_").concat(v),bypassIsTimingCheck:!0}),n}));case 10:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})),A(this,"initVIPRegistrationPools",function(){s.getMediaRegistrationsFromVIP({mediaType:"image"}),s.getMediaRegistrationsFromVIP({mediaType:"video"})}),A(this,"checkAllUploadsProcessingOrCompleted",function(){for(var e=0,t=Object.keys(s.mediaUploadsMap),n=0;n<t.length;n++){var r=t[n],o=s.mediaUploadsMap[r];s.debugLog("Status of media upload ID ".concat(r," ").concat(o.mediaUpload.getClassName()," ").concat(o.status)),("completed"===o.status||"processing"===o.status&&"VideoUpload"===o.mediaUpload.getClassName())&&(e+=1)}return s.debugLog("Checking if all upload processes completed"),s.debugLog("Completed ".concat(e," out of ").concat(Object.keys(s.mediaUploadsMap).length)),e===Object.keys(s.mediaUploadsMap).length}),A(this,"checkUploadsFailed",function(){return!!Object.keys(s.mediaUploadsMap).find(function(e){return"failed"===s.mediaUploadsMap[e].status&&s.mediaUploadsMap[e].processingRetryCount>2})}),A(this,"updateUploadStatus",function(e,t){return s.mediaUploadsMap[e].status=t}),A(this,"updateVIPStatusMap",function(e){for(var t=new Date,n=function(e){var n=e.mediaId,r=e.mediaUpload,o=e.signature,i=e.uploadId,a=(t.getTime()-s.vipStatusMap[i].timeSet.getTime())/1e3;r.onFinishProcessing(i,{processingTimeSec:a,signature:o}),s.updateUploadStatus(n,"completed")},r=0,o=Object.keys(e);r<o.length;r++){var i=o[r],a=e[i],u=a.failureCode,l=a.signature,c=a.status;if(i in s.vipStatusMap){var d=s.vipStatusMap[i].mediaId,p=s.mediaUploadsMap[d];if(u&&s.mediaUploadsMap[d].processingRetryCount>2){p.mediaUpload.onProcessingFailed(u),s.updateUploadStatus(d,"failed");break}s.vipStatusMap[i].status!==c||"failed"===c?(s.vipStatusMap[i]=U(U({},s.vipStatusMap[i]),{},{status:c,timeSet:t}),"processing"===c?(p.mediaUpload.onStartProcessing(i,{signature:l}),s.debugLog("Skipping media completion"),n({mediaId:d,mediaUpload:p.mediaUpload,signature:l,uploadId:i})):"succeeded"===c?(s.debugLog("Waited for media completion"),n({mediaId:d,mediaUpload:p.mediaUpload,signature:l,uploadId:i})):"failed"===c&&(s.mediaUploadsMap[d].processingRetryCount+=1,s.debugLog("Media upload ".concat(i," failed, but will keep checking ").concat(3-s.mediaUploadsMap[d].processingRetryCount," times if a retry succeeds.")))):s.statusTimeoutMap[c]&&(t.getTime()-s.vipStatusMap[i].timeSet.getTime())/1e3>=s.statusTimeoutMap[c].timeoutSec&&(p.mediaUpload.onProcessingTimeout(),s.statusTimeoutMap[c].onTimeout(i,d,s.mediaUploadsMap[d].mediaUpload.getClassName()))}}}),A(this,"refreshImageRegistration",F(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.vipRegistrationPool.image={fetchedLast:0,data:[],fetchingData:!1},e.next=3,s.getMediaRegistrationsFromVIP({mediaType:"image"});case 3:case"end":return e.stop()}},e)}))),A(this,"getMediaRegistration",(r=F(regeneratorRuntime.mark(function e(t){var n,r,o,i,a,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=C(t)?"image":"video",o="localVideo"===t.type||"webVideo"===t.type?Math.round(1e3*(t.duration||0)):0,i="localImage"===t.type?t.mediaMetadata:void 0,!(o||i||!s.vipRegistrationPool[r])){e.next=8;break}return e.next=6,s.getMediaRegistrationsFromVIP({durationMs:o,mediaMetadata:i,mediaType:r,shouldSkipPool:!0,count:1});case 6:return u=e.sent,e.abrupt("return",null!=(a=null==u?void 0:u[0])?a:null);case 8:if(!s.vipRegistrationPool[r].fetchingData){e.next=11;break}return e.next=11,new Promise(function(e){var t=0,n=setInterval(function(){t+=1,s.vipRegistrationPool[r].fetchingData&&100!==t||(clearInterval(n),e(void 0))},100)});case 11:if(l=performance.now()-s.vipRegistrationPool[r].fetchedLast>=18e5,!(0===s.vipRegistrationPool[r].data.length||l)){e.next=15;break}return e.next=15,s.getMediaRegistrationsFromVIP({durationMs:o,mediaType:r});case 15:return e.abrupt("return",Promise.resolve(null!=(n=s.vipRegistrationPool[r].data.pop())?n:null));case 16:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})),A(this,"hasAnyVideoUploads",function(){for(var e=0,t=Object.keys(s.mediaUploadsMap);e<t.length;e++){var n=t[e];if("VideoUpload"===s.mediaUploadsMap[n].mediaUpload.getClassName())return!0}return!1}),A(this,"getVipMapStatusesToString",function(){for(var e="{",t=0,n=Object.keys(s.vipStatusMap);t<n.length;t++){var r,o=n[t];e+="[".concat(o,"]:").concat(null!=(r=s.vipStatusMap[o].status)?r:"null"," ")}return e+"}"}),A(this,"handleFailure",function(e,t){s.failed||(s.onFailure(e,t),s.failed=!0)}),A(this,"handleCheckUploadsCompleted",function(){var e=s.checkAllUploadsProcessingOrCompleted();return e&&!s.completed&&(s.debugLog("All submitted media processed, calling onCompleted if it exists"),s.completed=!0,s.onCompleted()),e}),A(this,"onFinishUpload",function(e,t){s.vipStatusMap[e]={mediaId:t,status:null,timeSet:new Date},s.updateUploadStatus(t,"uploaded"),s.debugLog("Finished uploading media ID ".concat(t)),s.statusCheckInProgress||(s.statusCheckInProgress=!0,s.waitThenCheckStatus())}),A(this,"onUploadFailed",function(e,t,n){s.updateUploadStatus(e,"failed"),s.handleFailure(t,n),s.debugLog("Failed uploading media ID ".concat(e))}),A(this,"removeMediaUpload",function(e){s.mediaUploadsMap[e]&&(s.mediaUploadsMap[e].mediaUpload.cancel(),delete s.mediaUploadsMap[e])}),A(this,"addMediaUpload",function(e){var t=e.media,n=e.mediaId,r=e.uploadHandlers;s.getMediaRegistration(t).then(function(e){var o=U(U({},r),{},{onFailure:function(e){var t=e.uploadId,o=e.errorMsg,i=e.mediaUploadFailureReason;s.onUploadFailed(n,o,i),r.onFailure({uploadId:t,errorMsg:o,mediaUploadFailureReason:i})},onFinishUpload:function(e,t){s.onFinishUpload(e,n),r.onFinishUpload&&r.onFinishUpload(e,t)}}),i=C(t)?new D({callbackHandlers:o,i18n:s.i18n,maxUploadAttempts:s.maxMediaUploadAttempts,media:t,storyPinPublishStopwatch:s.storyPinPublishStopwatch,vipRegistration:e,vipType:"image-story-pin"}):new x({callbackHandlers:o,i18n:s.i18n,maxUploadAttempts:s.maxMediaUploadAttempts,media:t,storyPinPublishStopwatch:s.storyPinPublishStopwatch,vipRegistration:e,vipType:"video-story-pin"});if(s.mediaUploadsMap[n]){s.debugLog("Cancelling existing upload media ID ".concat(n)),s.mediaUploadsMap[n].mediaUpload.cancel();var a=s.mediaUploadsMap[n].mediaUpload.uploadId;a&&a in s.vipStatusMap&&delete s.vipStatusMap[a]}s.debugLog("Added media ID to upload ".concat(n)),s.mediaUploadsMap[n]={mediaUpload:i,status:"pending",processingRetryCount:0},i.upload(),s.updateUploadStatus(n,"uploading")})}),A(this,"reset",function(){s.failed=!1,s.statusCheckFailureCount=0,s.completed=!1}),A(this,"cancelAll",function(){for(var e=0,t=Object.keys(s.mediaUploadsMap);e<t.length;e++){var n=t[e];"uploading"===s.mediaUploadsMap[n].status&&s.mediaUploadsMap[n].mediaUpload.cancel()}}),A(this,"checkStatus",F(regeneratorRuntime.mark(function e(){var t,n,r,o,a,l,c,d,p,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.checkUploadsFailed()){e.next=4;break}return s.statusCheckInProgress=!1,s.debugLog("There is a failure in check status ".concat(s.getVipMapStatusesToString())),e.abrupt("return");case 4:if(s.debugLog("Checking status ".concat(s.getVipMapStatusesToString())),s.statusCheckInProgress=!0,!((t=Object.keys(s.vipStatusMap)).length>0)){e.next=26;break}return e.prev=8,e.next=11,(0,E.Z)(t,s.statusCheckFailureCount);case 11:for(n=e.sent,s.updateVIPStatusMap(n),s.debugLog("Check status response received ".concat(s.getVipMapStatusesToString())),r=s.handleCheckUploadsCompleted(),o=Object.keys(s.vipStatusMap),a=0,l=o;a<l.length;a++)c=l[a],d=s.vipStatusMap[c].mediaId,s.mediaUploadsMap[d]?"completed"===s.mediaUploadsMap[d].status&&(p=s.mediaUploadsMap[d].mediaUpload.signature,s.mediaUploadsMap[d].mediaUpload.vipType.includes("video")&&p&&(null==(f=s.storyPinPublishStopwatch)||f.updateSubspanName({currentName:"video_page_upload-".concat(c),newName:"video_page_upload-".concat(p),bypassIsTimingCheck:!0}),null==(h=s.storyPinPublishStopwatch)||h.updateSubspanName({currentName:"video_page_publish-".concat(c),newName:"video_page_publish-".concat(p),bypassIsTimingCheck:!0})),delete s.vipStatusMap[c]):(0,M.nP)("storypin.publish.media_uploads_map.missing_upload_id",{sampleRate:1,tags:{retryCount:s.statusCheckFailureCount,mediaId:d,vipId:c,mediaType:void 0}});r?s.statusCheckInProgress=!1:s.waitThenCheckStatus(),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),s.statusCheckFailureCount+=1,s.statusCheckFailureCount>4?(s.debugLog("Failing upload because status check failed ".concat(s.statusCheckFailureCount," times")),s.handleFailure((0,u.nk)(s.i18n._('Could not check VIP status with error: {{ errorName }} {{ errorMessage }}', 'MediaUploadManager.checkStatus.error', 'Error message for media upload'),{errorName:(0,i.Z)(e.t0,"name"),errorMessage:(0,i.Z)(e.t0,"message")}).join(""),14),s.statusCheckInProgress=!1):(s.debugLog("Continuing upload because status check only failed ".concat(s.statusCheckFailureCount," times")),s.waitThenCheckStatus());case 24:e.next=27;break;case 26:s.handleCheckUploadsCompleted()||s.waitThenCheckStatus();case 27:case"end":return e.stop()}},e,null,[[8,20]])}))),A(this,"waitThenCheckStatus",function(){setTimeout(s.checkStatus,s.hasAnyVideoUploads()?3e3:1e3)}),this.onCancel=e.onCancel,this.onCompleted=e.onCompleted,this.onFailure=e.onFailure,this.statusTimeoutMap=e.statusTimeoutMap,this.maxMediaUploadAttempts=e.maxMediaUploadAttempts,this.inDebugMode=e.inDebugMode,this.storyPinPublishStopwatch=e.storyPinPublishStopwatch,this.i18n=e.i18n,this.statusCheckInProgress=!1,this.completed=!1,this.failed=!1,this.vipRegistrationPool={image:{fetchedLast:0,data:[],fetchingData:!1},video:{fetchedLast:0,data:[],fetchingData:!1}},this.vipRegistrationRequestCounts={image:0,video:0},this.statusCheckFailureCount=0,this.mediaUploadsMap={},this.vipStatusMap={}}return e=[{key:"debugLog",value:function(e){N(this.inDebugMode,e)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function Z(e){var t=this,n=e.i18n,o=e.isEmployee,i=e.pinDraftId,a=e.storyPinPublishStopwatch;return function(e){var u=new B({i18n:n,inDebugMode:o,maxMediaUploadAttempts:r.dD,onCancel:function(){},onCompleted:function(){},onFailure:function(){},statusTimeoutMap:{registered:{onTimeout:function(e,n,r){(0,M.nP)("storypin.publish.media_uploads_map.timeout.registered",{sampleRate:1,tags:{retryCount:t.statusCheckFailureCount,mediaId:n,uploadId:e,mediaType:r}})},timeoutSec:240},processing:{onTimeout:function(e,n,r){(0,M.nP)("storypin.publish.media_uploads_map.timeout.processing",{sampleRate:1,tags:{retryCount:t.statusCheckFailureCount,mediaId:n,uploadId:e,mediaType:r}})},timeoutSec:180}},storyPinPublishStopwatch:a});u.initVIPRegistrationPools(),e({type:"PIN_DRAFT_SET_STORY_PIN_UPLOAD_MANAGER",payload:{pinDraftId:i,uploadManager:u}})}}},614699:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(575108),o=n(603316);function i(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function a(e,t){return u.apply(this,arguments)}function u(){var e;return e=regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.Z.create("VIPResource",{upload_ids:t}).callGet();case 2:return i=e.sent.resource_response.data,e.abrupt("return",t.reduce(function(e,t){return i[t]?e[t]={failureCode:i[t].failure_code,signature:i[t].signature,status:i[t].status}:(0,o.nP)("storypin.publish.vip_status_check.missing_upload_id",{sampleRate:1,tags:{retryCount:n}}),e},{}));case 5:case"end":return e.stop()}},e)}),(u=function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){i(a,r,o,u,s,"next",e)}function s(e){i(a,r,o,u,s,"throw",e)}u(void 0)})}).apply(this,arguments)}},808045:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(537765),o=n(368321),i=n(947631);function a(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,o.Z)(e,6e4*n)}},387088:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(663158),o=n(947631);function i(e){(0,o.Z)(1,arguments);var t=(0,r.Z)(e);return t.setHours(23,59,59,999),t}}}]);